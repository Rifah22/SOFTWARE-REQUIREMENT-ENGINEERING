;try{window.performance.mark('com.atlassian.streams.streams-jira-plugin,com.atlassian.jira.gadgets,com.atlassian.jira.gadgets_batch_file_eval:start');} catch(e){};;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:date-default', location = 'js/datejs/globalization/en-US.js' */
Date.CultureInfo = {
    /* Culture Name */
    name: "en-US",
    englishName: "English (United States)",
    nativeName: "English (United States)",

    /* Day Name Strings */
    dayNames: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
    abbreviatedDayNames: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
    shortestDayNames: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
    firstLetterDayNames: ["S", "M", "T", "W", "T", "F", "S"],

    /* Month Name Strings */
    monthNames: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    abbreviatedMonthNames: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],

    /* AM/PM Designators */
    amDesignator: "AM",
    pmDesignator: "PM",

    firstDayOfWeek: 0,
    twoDigitYearMax: 2029,

    /**
     * The dateElementOrder is based on the order of the
     * format specifiers in the formatPatterns.DatePattern.
     *
     * Example:
     <pre>
     shortDatePattern    dateElementOrder
     ------------------  ----------------
     "M/d/yyyy"          "mdy"
     "dd/MM/yyyy"        "dmy"
     "yyyy-MM-dd"        "ymd"
     </pre>
     *
     * The correct dateElementOrder is required by the parser to
     * determine the expected order of the date elements in the
     * string being parsed.
     */
    dateElementOrder: "mdy",

    /* Standard date and time format patterns */
    formatPatterns: {
        shortDate: "M/d/yyyy",
        longDate: "dddd, MMMM dd, yyyy",
        shortTime: "h:mm tt",
        longTime: "h:mm:ss tt",
        fullDateTime: "dddd, MMMM dd, yyyy h:mm:ss tt",
        sortableDateTime: "yyyy-MM-ddTHH:mm:ss",
        universalSortableDateTime: "yyyy-MM-dd HH:mm:ssZ",
        rfc1123: "ddd, dd MMM yyyy HH:mm:ss GMT",
        monthDay: "MMMM dd",
        yearMonth: "MMMM, yyyy"
    },

    /**
     * NOTE: If a string format is not parsing correctly, but
     * you would expect it parse, the problem likely lies below.
     *
     * The following regex patterns control most of the string matching
     * within the parser.
     *
     * The Month name and Day name patterns were automatically generated
     * and in general should be (mostly) correct.
     *
     * Beyond the month and day name patterns are natural language strings.
     * Example: "next", "today", "months"
     *
     * These natural language string may NOT be correct for this culture.
     * If they are not correct, please translate and edit this file
     * providing the correct regular expression pattern.
     *
     * If you modify this file, please post your revised CultureInfo file
     * to the Datejs Forum located at http://www.datejs.com/forums/.
     *
     * Please mark the subject of the post with [CultureInfo]. Example:
     *    Subject: [CultureInfo] Translated "da-DK" Danish(Denmark)
     *
     * We will add the modified patterns to the master source files.
     *
     * As well, please review the list of "Future Strings" section below.
     */
    regexPatterns: {
        jan: /^jan(uary)?/i,
        feb: /^feb(ruary)?/i,
        mar: /^mar(ch)?/i,
        apr: /^apr(il)?/i,
        may: /^may/i,
        jun: /^jun(e)?/i,
        jul: /^jul(y)?/i,
        aug: /^aug(ust)?/i,
        sep: /^sep(t(ember)?)?/i,
        oct: /^oct(ober)?/i,
        nov: /^nov(ember)?/i,
        dec: /^dec(ember)?/i,

        sun: /^su(n(day)?)?/i,
        mon: /^mo(n(day)?)?/i,
        tue: /^tu(e(s(day)?)?)?/i,
        wed: /^we(d(nesday)?)?/i,
        thu: /^th(u(r(s(day)?)?)?)?/i,
        fri: /^fr(i(day)?)?/i,
        sat: /^sa(t(urday)?)?/i,

        future: /^next/i,
        past: /^last|past|prev(ious)?/i,
        add: /^(\+|aft(er)?|from|hence)/i,
        subtract: /^(\-|bef(ore)?|ago)/i,

        yesterday: /^yes(terday)?/i,
        today: /^t(od(ay)?)?/i,
        tomorrow: /^tom(orrow)?/i,
        now: /^n(ow)?/i,

        millisecond: /^ms|milli(second)?s?/i,
        second: /^sec(ond)?s?/i,
        minute: /^mn|min(ute)?s?/i,
        hour: /^h(our)?s?/i,
        week: /^w(eek)?s?/i,
        month: /^m(onth)?s?/i,
        day: /^d(ay)?s?/i,
        year: /^y(ear)?s?/i,

        shortMeridian: /^(a|p)/i,
        longMeridian: /^(a\.?m?\.?|p\.?m?\.?)/i,
        timezone: /^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,
        ordinalSuffix: /^\s*(st|nd|rd|th)/i,
        timeContext: /^\s*(\:|a(?!u|p)|p)/i
    },

    timezones: [{name: "UTC", offset: "-000"}, {name: "GMT", offset: "-000"}, {
        name: "EST",
        offset: "-0500"
    }, {name: "EDT", offset: "-0400"}, {name: "CST", offset: "-0600"}, {name: "CDT", offset: "-0500"}, {
        name: "MST",
        offset: "-0700"
    }, {name: "MDT", offset: "-0600"}, {name: "PST", offset: "-0800"}, {name: "PDT", offset: "-0700"}]
};

/********************
 ** Future Strings **
 ********************
 *
 * The following list of strings may not be currently being used, but
 * may be incorporated into the Datejs library later.
 *
 * We would appreciate any help translating the strings below.
 *
 * If you modify this file, please post your revised CultureInfo file
 * to the Datejs Forum located at http://www.datejs.com/forums/.
 *
 * Please mark the subject of the post with [CultureInfo]. Example:
 *    Subject: [CultureInfo] Translated "da-DK" Danish(Denmark)b
 *
 * English Name        Translated
 * ------------------  -----------------
 * about               about
 * ago                 ago
 * date                date
 * time                time
 * calendar            calendar
 * show                show
 * hourly              hourly
 * daily               daily
 * weekly              weekly
 * bi-weekly           bi-weekly
 * fortnight           fortnight
 * monthly             monthly
 * bi-monthly          bi-monthly
 * quarter             quarter
 * quarterly           quarterly
 * yearly              yearly
 * annual              annual
 * annually            annually
 * annum               annum
 * again               again
 * between             between
 * after               after
 * from now            from now
 * repeat              repeat
 * times               times
 * per                 per
 * min (abbrev minute) min
 * morning             morning
 * noon                noon
 * night               night
 * midnight            midnight
 * mid-night           mid-night
 * evening             evening
 * final               final
 * future              future
 * spring              spring
 * summer              summer
 * fall                fall
 * winter              winter
 * end of              end of
 * end                 end
 * long                long
 * short               short
 */;
;
/* module-key = 'com.atlassian.auiplugin:internal-jquery-ui-datepicker', location = 'auiplugin/node_modules/@atlassian/aui/src/js-vendor/jquery/jquery-ui/jquery.ui.datepicker.js' */
/*! THIS FILE HAS BEEN MODIFIED BY ATLASSIAN. Modified lines are marked below, search "ATLASSIAN" */
/** Patched all vulns prior to 23-feb-22 */
// node_modules/@atlassian/aui/src/js-vendor/jquery/jquery-ui/jquery.ui.datepicker.js
(typeof window === 'undefined' ? global : window).__601fc554d291439a8ef8bcac7fc51f19 = (function () {
  var module = {
    exports: {}
  };
  var exports = module.exports;
  
  /*!
   * jQuery UI Datepicker 1.8.24
   *
   * Copyright 2012, AUTHORS.txt (http://jqueryui.com/about)
   * Dual licensed under the MIT or GPL Version 2 licenses.
   * http://jquery.org/license
   *
   * http://docs.jquery.com/UI/Datepicker
   *
   * Depends:
   *	jquery.ui.core.js
   */
  (function( $, undefined ) {
  
  $.extend($.ui, { datepicker: { version: "1.8.24" } });
  
  var PROP_NAME = 'datepicker';
  var dpuuid = new Date().getTime();
  var instActive;
  
  /* Date picker manager.
     Use the singleton instance of this class, $.datepicker, to interact with the date picker.
     Settings for (groups of) date pickers are maintained in an instance object,
     allowing multiple different settings on the same page. */
  
  function Datepicker() {
  	this.debug = false; // Change this to true to start debugging
  	this._curInst = null; // The current instance in use
  	this._keyEvent = false; // If the last event was a key event
  	this._disabledInputs = []; // List of date picker inputs that have been disabled
  	this._datepickerShowing = false; // True if the popup picker is showing , false if not
  	this._inDialog = false; // True if showing within a "dialog", false if not
  	this._mainDivId = 'ui-datepicker-div'; // The ID of the main datepicker division
  	this._inlineClass = 'ui-datepicker-inline'; // The name of the inline marker class
  	this._appendClass = 'ui-datepicker-append'; // The name of the append marker class
  	this._triggerClass = 'ui-datepicker-trigger'; // The name of the trigger marker class
  	this._dialogClass = 'ui-datepicker-dialog'; // The name of the dialog marker class
  	this._disableClass = 'ui-datepicker-disabled'; // The name of the disabled covering marker class
  	this._unselectableClass = 'ui-datepicker-unselectable'; // The name of the unselectable cell marker class
  	this._currentClass = 'ui-datepicker-current-day'; // The name of the current day marker class
  	this._dayOverClass = 'ui-datepicker-days-cell-over'; // The name of the day hover marker class
  	this.regional = []; // Available regional settings, indexed by language code
  	this.regional[''] = { // Default regional settings
  		closeText: 'Done', // Display text for close link
  		prevText: 'Prev', // Display text for previous month link
  		nextText: 'Next', // Display text for next month link
  		currentText: 'Today', // Display text for current month link
  		monthNames: ['January','February','March','April','May','June',
  			'July','August','September','October','November','December'], // Names of months for drop-down and formatting
  		monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'], // For formatting
  		dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'], // For formatting
  		dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'], // For formatting
  		dayNamesMin: ['Su','Mo','Tu','We','Th','Fr','Sa'], // Column headings for days starting at Sunday
  		weekHeader: 'Wk', // Column header for week of the year
  		dateFormat: 'mm/dd/yy', // See format options on parseDate
  		firstDay: 0, // The first day of the week, Sun = 0, Mon = 1, ...
  		isRTL: false, // True if right-to-left language, false if left-to-right
  		showMonthAfterYear: false, // True if the year select precedes month, false for month then year
  		yearSuffix: '' // Additional text to append to the year in the month headers
  	};
  	this._defaults = { // Global defaults for all the date picker instances
  		showOn: 'focus', // 'focus' for popup on focus,
  			// 'button' for trigger button, or 'both' for either
  		showAnim: 'fadeIn', // Name of jQuery animation for popup
  		showOptions: {}, // Options for enhanced animations
  		defaultDate: null, // Used when field is blank: actual date,
  			// +/-number for offset from today, null for today
  		appendText: '', // Display text following the input box, e.g. showing the format
  		buttonText: '...', // Text for trigger button
  		buttonImage: '', // URL for trigger button image
  		buttonImageOnly: false, // True if the image appears alone, false if it appears on a button
  		hideIfNoPrevNext: false, // True to hide next/previous month links
  			// if not applicable, false to just disable them
  		navigationAsDateFormat: false, // True if date formatting applied to prev/today/next links
  		gotoCurrent: false, // True if today link goes back to current selection instead
  		changeMonth: false, // True if month can be selected directly, false if only prev/next
  		changeYear: false, // True if year can be selected directly, false if only prev/next
  		yearRange: 'c-10:c+10', // Range of years to display in drop-down,
  			// either relative to today's year (-nn:+nn), relative to currently displayed year
  			// (c-nn:c+nn), absolute (nnnn:nnnn), or a combination of the above (nnnn:-n)
  		showOtherMonths: false, // True to show dates in other months, false to leave blank
  		selectOtherMonths: false, // True to allow selection of dates in other months, false for unselectable
  		showWeek: false, // True to show week of the year, false to not show it
  		calculateWeek: this.iso8601Week, // How to calculate the week of the year,
  			// takes a Date and returns the number of the week for it
  		shortYearCutoff: '+10', // Short year values < this are in the current century,
  			// > this are in the previous century,
  			// string value starting with '+' for current year + value
  		minDate: null, // The earliest selectable date, or null for no limit
  		maxDate: null, // The latest selectable date, or null for no limit
  		duration: 'fast', // Duration of display/closure
  		beforeShowDay: null, // Function that takes a date and returns an array with
  			// [0] = true if selectable, false if not, [1] = custom CSS class name(s) or '',
  			// [2] = cell title (optional), e.g. $.datepicker.noWeekends
  		beforeShow: null, // Function that takes an input field and
  			// returns a set of custom settings for the date picker
  		onSelect: null, // Define a callback function when a date is selected
  		onChangeMonthYear: null, // Define a callback function when the month or year is changed
  		onClose: null, // Define a callback function when the datepicker is closed
  		numberOfMonths: 1, // Number of months to show at a time
  		showCurrentAtPos: 0, // The position in multipe months at which to show the current month (starting at 0)
  		stepMonths: 1, // Number of months to step back/forward
  		stepBigMonths: 12, // Number of months to step back/forward for the big links
  		altField: '', // Selector for an alternate field to store selected dates into
  		altFormat: '', // The date format to use for the alternate field
  		constrainInput: true, // The input is constrained by the current date format
  		showButtonPanel: false, // True to show button panel, false to not show it
  		autoSize: false, // True to size the input for the date format, false to leave as is
  		disabled: false // The initial disabled state
  	};
  	$.extend(this._defaults, this.regional['']);
  	this.dpDiv = bindHover($('<div id="' + this._mainDivId + '" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'));
  }
  
  $.extend(Datepicker.prototype, {
  	/* Class name added to elements to indicate already configured with a date picker. */
  	markerClassName: 'hasDatepicker',
  	
  	//Keep track of the maximum number of rows displayed (see #7043)
  	maxRows: 4,
  
  	/* Debug logging (if enabled). */
  	log: function () {
  		if (this.debug)
  			console.log.apply('', arguments);
  	},
  	
  	// TODO rename to "widget" when switching to widget factory
  	_widgetDatepicker: function() {
  		return this.dpDiv;
  	},
  
  	/* Override the default settings for all instances of the date picker.
  	   @param  settings  object - the new settings to use as defaults (anonymous object)
  	   @return the manager object */
  	setDefaults: function(settings) {
  		extendRemove(this._defaults, settings || {});
  		return this;
  	},
  
  	/* Attach the date picker to a jQuery selection.
  	   @param  target    element - the target input field or division or span
  	   @param  settings  object - the new settings to use for this date picker instance (anonymous) */
  	_attachDatepicker: function(target, settings) {
  		// check for settings on the control itself - in namespace 'date:'
  		var inlineSettings = null;
  		for (var attrName in this._defaults) {
  			var attrValue = target.getAttribute('date:' + attrName);
  			if (attrValue) {
  				inlineSettings = inlineSettings || {};
  				try {
  					inlineSettings[attrName] = eval(attrValue);
  				} catch (err) {
  					inlineSettings[attrName] = attrValue;
  				}
  			}
  		}
  		var nodeName = target.nodeName.toLowerCase();
  		var inline = (nodeName == 'div' || nodeName == 'span');
  		if (!target.id) {
  			this.uuid += 1;
  			target.id = 'dp' + this.uuid;
  		}
  		var inst = this._newInst($(target), inline);
  		inst.settings = $.extend({}, settings || {}, inlineSettings || {});
  		if (nodeName == 'input') {
  			this._connectDatepicker(target, inst);
  		} else if (inline) {
  			this._inlineDatepicker(target, inst);
  		}
  	},
  
  	/* Create a new instance object. */
  	_newInst: function(target, inline) {
  		var id = target[0].id.replace(/([^A-Za-z0-9_-])/g, '\\\\$1'); // escape jQuery meta chars
  		return {id: id, input: target, // associated target
  			selectedDay: 0, selectedMonth: 0, selectedYear: 0, // current selection
  			drawMonth: 0, drawYear: 0, // month being drawn
  			inline: inline, // is datepicker inline or not
  			dpDiv: (!inline ? this.dpDiv : // presentation div
  			bindHover($('<div class="' + this._inlineClass + ' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')))};
  	},
  
  	/* Attach the date picker to an input field. */
  	_connectDatepicker: function(target, inst) {
  		var input = $(target);
  		inst.append = $([]);
  		inst.trigger = $([]);
  		if (input.hasClass(this.markerClassName))
  			return;
  		this._attachments(input, inst);
  		input.addClass(this.markerClassName).keydown(this._doKeyDown).
  			keypress(this._doKeyPress).keyup(this._doKeyUp).
  			bind("setData.datepicker", function(event, key, value) {
  				inst.settings[key] = value;
  			}).bind("getData.datepicker", function(event, key) {
  				return this._get(inst, key);
  			});
  		this._autoSize(inst);
  		$.data(target, PROP_NAME, inst);
  		//If disabled option is true, disable the datepicker once it has been attached to the input (see ticket #5665)
  		if( inst.settings.disabled ) {
  			this._disableDatepicker( target );
  		}
  	},
  
  	/* Make attachments based on settings. */
  	_attachments: function(input, inst) {
  		var appendText = this._get(inst, 'appendText');
  		var isRTL = this._get(inst, 'isRTL');
  		if (inst.append)
  			inst.append.remove();
  		if (appendText) {
			/**
 			* FOLLOWING LINES MODIFIED BY ATLASSIAN  https://github.com/jquery/jquery-ui/pull/1953 https://security.snyk.io/vuln/SNYK-JS-JQUERYUI-1767767
			**/
			inst.append = $( "<span>" )
				.addClass( this._appendClass )
				.text( appendText );
			/** END ATLASSIAN */
  			input[isRTL ? 'before' : 'after'](inst.append);
  		}
  		input.unbind('focus', this._showDatepicker);
  		if (inst.trigger)
  			inst.trigger.remove();
  		var showOn = this._get(inst, 'showOn');
  		if (showOn == 'focus' || showOn == 'both') // pop-up date picker when in the marked field
  			input.focus(this._showDatepicker);
  		if (showOn == 'button' || showOn == 'both') { // pop-up date picker when button clicked
  			var buttonText = this._get(inst, 'buttonText');
  			var buttonImage = this._get(inst, 'buttonImage');

		/**
 		* FOLLOWING LINES MODIFIED BY ATLASSIAN  https://github.com/jquery/jquery-ui/pull/1953 https://security.snyk.io/vuln/SNYK-JS-JQUERYUI-1767767
		**/
  		if ( this._get( inst, "buttonImageOnly" ) ) {
				inst.trigger = $( "<img>" )
					.addClass( this._triggerClass )
					.attr( {
						src: buttonImage,
						alt: buttonText,
						title: buttonText
					} );
			} else {
				inst.trigger = $( "<button type='button'>" )
					.addClass( this._triggerClass );
				if ( buttonImage ) {
					inst.trigger.html(
						$( "<img>" )
							.attr( {
								src: buttonImage,
								alt: buttonText,
								title: buttonText
							} )
					);
				} else {
					inst.trigger.text( buttonText );
				}
			}
			/** END ATLASSIAN */
  			input[isRTL ? 'before' : 'after'](inst.trigger);
  			inst.trigger.click(function() {
  				if ($.datepicker._datepickerShowing && $.datepicker._lastInput == input[0])
  					$.datepicker._hideDatepicker();
  				else if ($.datepicker._datepickerShowing && $.datepicker._lastInput != input[0]) {
  					$.datepicker._hideDatepicker(); 
  					$.datepicker._showDatepicker(input[0]);
  				} else
  					$.datepicker._showDatepicker(input[0]);
  				return false;
  			});
  		}
  	},
  
  	/* Apply the maximum length for the date format. */
  	_autoSize: function(inst) {
  		if (this._get(inst, 'autoSize') && !inst.inline) {
  			var date = new Date(2009, 12 - 1, 20); // Ensure double digits
  			var dateFormat = this._get(inst, 'dateFormat');
  			if (dateFormat.match(/[DM]/)) {
  				var findMax = function(names) {
  					var max = 0;
  					var maxI = 0;
  					for (var i = 0; i < names.length; i++) {
  						if (names[i].length > max) {
  							max = names[i].length;
  							maxI = i;
  						}
  					}
  					return maxI;
  				};
  				date.setMonth(findMax(this._get(inst, (dateFormat.match(/MM/) ?
  					'monthNames' : 'monthNamesShort'))));
  				date.setDate(findMax(this._get(inst, (dateFormat.match(/DD/) ?
  					'dayNames' : 'dayNamesShort'))) + 20 - date.getDay());
  			}
  			inst.input.attr('size', this._formatDate(inst, date).length);
  		}
  	},
  
  	/* Attach an inline date picker to a div. */
  	_inlineDatepicker: function(target, inst) {
  		var divSpan = $(target);
  		if (divSpan.hasClass(this.markerClassName))
  			return;
  		divSpan.addClass(this.markerClassName).append(inst.dpDiv).
  			bind("setData.datepicker", function(event, key, value){
  				inst.settings[key] = value;
  			}).bind("getData.datepicker", function(event, key){
  				return this._get(inst, key);
  			});
  		$.data(target, PROP_NAME, inst);
  		this._setDate(inst, this._getDefaultDate(inst), true);
  		this._updateDatepicker(inst);
  		this._updateAlternate(inst);
  		//If disabled option is true, disable the datepicker before showing it (see ticket #5665)
  		if( inst.settings.disabled ) {
  			this._disableDatepicker( target );
  		}
  		// Set display:block in place of inst.dpDiv.show() which won't work on disconnected elements
  		// http://bugs.jqueryui.com/ticket/7552 - A Datepicker created on a detached div has zero height
  		inst.dpDiv.css( "display", "block" );
  	},
  
  	/* Pop-up the date picker in a "dialog" box.
  	   @param  input     element - ignored
  	   @param  date      string or Date - the initial date to display
  	   @param  onSelect  function - the function to call when a date is selected
  	   @param  settings  object - update the dialog date picker instance's settings (anonymous object)
  	   @param  pos       int[2] - coordinates for the dialog's position within the screen or
  	                     event - with x/y coordinates or
  	                     leave empty for default (screen centre)
  	   @return the manager object */
  	_dialogDatepicker: function(input, date, onSelect, settings, pos) {
  		var inst = this._dialogInst; // internal instance
  		if (!inst) {
  			this.uuid += 1;
  			var id = 'dp' + this.uuid;
  			this._dialogInput = $('<input type="text" id="' + id +
  				'" style="position: absolute; top: -100px; width: 0px;"/>');
  			this._dialogInput.keydown(this._doKeyDown);
  			$('body').append(this._dialogInput);
  			inst = this._dialogInst = this._newInst(this._dialogInput, false);
  			inst.settings = {};
  			$.data(this._dialogInput[0], PROP_NAME, inst);
  		}
  		extendRemove(inst.settings, settings || {});
  		date = (date && date.constructor == Date ? this._formatDate(inst, date) : date);
  		this._dialogInput.val(date);
  
  		this._pos = (pos ? (pos.length ? pos : [pos.pageX, pos.pageY]) : null);
  		if (!this._pos) {
  			var browserWidth = document.documentElement.clientWidth;
  			var browserHeight = document.documentElement.clientHeight;
  			var scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
  			var scrollY = document.documentElement.scrollTop || document.body.scrollTop;
  			this._pos = // should use actual width/height below
  				[(browserWidth / 2) - 100 + scrollX, (browserHeight / 2) - 150 + scrollY];
  		}
  
  		// move input on screen for focus, but hidden behind dialog
  		this._dialogInput.css('left', (this._pos[0] + 20) + 'px').css('top', this._pos[1] + 'px');
  		inst.settings.onSelect = onSelect;
  		this._inDialog = true;
  		this.dpDiv.addClass(this._dialogClass);
  		this._showDatepicker(this._dialogInput[0]);
  		if ($.blockUI)
  			$.blockUI(this.dpDiv);
  		$.data(this._dialogInput[0], PROP_NAME, inst);
  		return this;
  	},
  
  	/* Detach a datepicker from its control.
  	   @param  target    element - the target input field or division or span */
  	_destroyDatepicker: function(target) {
  		var $target = $(target);
  		var inst = $.data(target, PROP_NAME);
  		if (!$target.hasClass(this.markerClassName)) {
  			return;
  		}
  		var nodeName = target.nodeName.toLowerCase();
  		$.removeData(target, PROP_NAME);
  		if (nodeName == 'input') {
  			inst.append.remove();
  			inst.trigger.remove();
  			$target.removeClass(this.markerClassName).
  				unbind('focus', this._showDatepicker).
  				unbind('keydown', this._doKeyDown).
  				unbind('keypress', this._doKeyPress).
  				unbind('keyup', this._doKeyUp);
  		} else if (nodeName == 'div' || nodeName == 'span')
  			$target.removeClass(this.markerClassName).empty();
  	},
  
  	/* Enable the date picker to a jQuery selection.
  	   @param  target    element - the target input field or division or span */
  	_enableDatepicker: function(target) {
  		var $target = $(target);
  		var inst = $.data(target, PROP_NAME);
  		if (!$target.hasClass(this.markerClassName)) {
  			return;
  		}
  		var nodeName = target.nodeName.toLowerCase();
  		if (nodeName == 'input') {
  			target.disabled = false;
  			inst.trigger.filter('button').
  				each(function() { this.disabled = false; }).end().
  				filter('img').css({opacity: '1.0', cursor: ''});
  		}
  		else if (nodeName == 'div' || nodeName == 'span') {
  			var inline = $target.children('.' + this._inlineClass);
  			inline.children().removeClass('ui-state-disabled');
  			inline.find("select.ui-datepicker-month, select.ui-datepicker-year").
  				removeAttr("disabled");
  		}
  		this._disabledInputs = $.map(this._disabledInputs,
  			function(value) { return (value == target ? null : value); }); // delete entry
  	},
  
  	/* Disable the date picker to a jQuery selection.
  	   @param  target    element - the target input field or division or span */
  	_disableDatepicker: function(target) {
  		var $target = $(target);
  		var inst = $.data(target, PROP_NAME);
  		if (!$target.hasClass(this.markerClassName)) {
  			return;
  		}
  		var nodeName = target.nodeName.toLowerCase();
  		if (nodeName == 'input') {
  			target.disabled = true;
  			inst.trigger.filter('button').
  				each(function() { this.disabled = true; }).end().
  				filter('img').css({opacity: '0.5', cursor: 'default'});
  		}
  		else if (nodeName == 'div' || nodeName == 'span') {
  			var inline = $target.children('.' + this._inlineClass);
  			inline.children().addClass('ui-state-disabled');
  			inline.find("select.ui-datepicker-month, select.ui-datepicker-year").
  				attr("disabled", "disabled");
  		}
  		this._disabledInputs = $.map(this._disabledInputs,
  			function(value) { return (value == target ? null : value); }); // delete entry
  		this._disabledInputs[this._disabledInputs.length] = target;
  	},
  
  	/* Is the first field in a jQuery collection disabled as a datepicker?
  	   @param  target    element - the target input field or division or span
  	   @return boolean - true if disabled, false if enabled */
  	_isDisabledDatepicker: function(target) {
  		if (!target) {
  			return false;
  		}
  		for (var i = 0; i < this._disabledInputs.length; i++) {
  			if (this._disabledInputs[i] == target)
  				return true;
  		}
  		return false;
  	},
  
  	/* Retrieve the instance data for the target control.
  	   @param  target  element - the target input field or division or span
  	   @return  object - the associated instance data
  	   @throws  error if a jQuery problem getting data */
  	_getInst: function(target) {
  		try {
  			return $.data(target, PROP_NAME);
  		}
  		catch (err) {
  			throw 'Missing instance data for this datepicker';
  		}
  	},
  
  	/* Update or retrieve the settings for a date picker attached to an input field or division.
  	   @param  target  element - the target input field or division or span
  	   @param  name    object - the new settings to update or
  	                   string - the name of the setting to change or retrieve,
  	                   when retrieving also 'all' for all instance settings or
  	                   'defaults' for all global defaults
  	   @param  value   any - the new value for the setting
  	                   (omit if above is an object or to retrieve a value) */
  	_optionDatepicker: function(target, name, value) {
  		var inst = this._getInst(target);
  		if (arguments.length == 2 && typeof name == 'string') {
  			return (name == 'defaults' ? $.extend({}, $.datepicker._defaults) :
  				(inst ? (name == 'all' ? $.extend({}, inst.settings) :
  				this._get(inst, name)) : null));
  		}
  		var settings = name || {};
  		if (typeof name == 'string') {
  			settings = {};
  			settings[name] = value;
  		}
  		if (inst) {
  			if (this._curInst == inst) {
  				this._hideDatepicker();
  			}
  			var date = this._getDateDatepicker(target, true);
  			var minDate = this._getMinMaxDate(inst, 'min');
  			var maxDate = this._getMinMaxDate(inst, 'max');
  			extendRemove(inst.settings, settings);
  			// reformat the old minDate/maxDate values if dateFormat changes and a new minDate/maxDate isn't provided
  			if (minDate !== null && settings['dateFormat'] !== undefined && settings['minDate'] === undefined)
  				inst.settings.minDate = this._formatDate(inst, minDate);
  			if (maxDate !== null && settings['dateFormat'] !== undefined && settings['maxDate'] === undefined)
  				inst.settings.maxDate = this._formatDate(inst, maxDate);
  			this._attachments($(target), inst);
  			this._autoSize(inst);
  			this._setDate(inst, date);
  			this._updateAlternate(inst);
  			this._updateDatepicker(inst);
  		}
  	},
  
  	// change method deprecated
  	_changeDatepicker: function(target, name, value) {
  		this._optionDatepicker(target, name, value);
  	},
  
  	/* Redraw the date picker attached to an input field or division.
  	   @param  target  element - the target input field or division or span */
  	_refreshDatepicker: function(target) {
  		var inst = this._getInst(target);
  		if (inst) {
  			this._updateDatepicker(inst);
  		}
  	},
  
  	/* Set the dates for a jQuery selection.
  	   @param  target   element - the target input field or division or span
  	   @param  date     Date - the new date */
  	_setDateDatepicker: function(target, date) {
  		var inst = this._getInst(target);
  		if (inst) {
  			this._setDate(inst, date);
  			this._updateDatepicker(inst);
  			this._updateAlternate(inst);
  		}
  	},
  
  	/* Get the date(s) for the first entry in a jQuery selection.
  	   @param  target     element - the target input field or division or span
  	   @param  noDefault  boolean - true if no default date is to be used
  	   @return Date - the current date */
  	_getDateDatepicker: function(target, noDefault) {
  		var inst = this._getInst(target);
  		if (inst && !inst.inline)
  			this._setDateFromField(inst, noDefault);
  		return (inst ? this._getDate(inst) : null);
  	},
  
  	/* Handle keystrokes. */
  	_doKeyDown: function(event) {
  		var inst = $.datepicker._getInst(event.target);
  		var handled = true;
  		var isRTL = inst.dpDiv.is('.ui-datepicker-rtl');
  		inst._keyEvent = true;
  		if ($.datepicker._datepickerShowing)
  			switch (event.keyCode) {
  				case 9: $.datepicker._hideDatepicker();
  						handled = false;
  						break; // hide on tab out
  				case 13: var sel = $('td.' + $.datepicker._dayOverClass + ':not(.' + 
  									$.datepicker._currentClass + ')', inst.dpDiv);
  						if (sel[0])
  							$.datepicker._selectDay(event.target, inst.selectedMonth, inst.selectedYear, sel[0]);
  							var onSelect = $.datepicker._get(inst, 'onSelect');
  							if (onSelect) {
  								var dateStr = $.datepicker._formatDate(inst);
  
  								// trigger custom callback
  								onSelect.apply((inst.input ? inst.input[0] : null), [dateStr, inst]);
  							}
  						else
  							$.datepicker._hideDatepicker();
  						return false; // don't submit the form
  						break; // select the value on enter
  				case 27: $.datepicker._hideDatepicker();
  						break; // hide on escape
  				case 33: $.datepicker._adjustDate(event.target, (event.ctrlKey ?
  							-$.datepicker._get(inst, 'stepBigMonths') :
  							-$.datepicker._get(inst, 'stepMonths')), 'M');
  						break; // previous month/year on page up/+ ctrl
  				case 34: $.datepicker._adjustDate(event.target, (event.ctrlKey ?
  							+$.datepicker._get(inst, 'stepBigMonths') :
  							+$.datepicker._get(inst, 'stepMonths')), 'M');
  						break; // next month/year on page down/+ ctrl
  				case 35: if (event.ctrlKey || event.metaKey) $.datepicker._clearDate(event.target);
  						handled = event.ctrlKey || event.metaKey;
  						break; // clear on ctrl or command +end
  				case 36: if (event.ctrlKey || event.metaKey) $.datepicker._gotoToday(event.target);
  						handled = event.ctrlKey || event.metaKey;
  						break; // current on ctrl or command +home
  				case 37: if (event.ctrlKey || event.metaKey) $.datepicker._adjustDate(event.target, (isRTL ? +1 : -1), 'D');
  						handled = event.ctrlKey || event.metaKey;
  						// -1 day on ctrl or command +left
  						if (event.originalEvent.altKey) $.datepicker._adjustDate(event.target, (event.ctrlKey ?
  									-$.datepicker._get(inst, 'stepBigMonths') :
  									-$.datepicker._get(inst, 'stepMonths')), 'M');
  						// next month/year on alt +left on Mac
  						break;
  				case 38: if (event.ctrlKey || event.metaKey) $.datepicker._adjustDate(event.target, -7, 'D');
  						handled = event.ctrlKey || event.metaKey;
  						break; // -1 week on ctrl or command +up
  				case 39: if (event.ctrlKey || event.metaKey) $.datepicker._adjustDate(event.target, (isRTL ? -1 : +1), 'D');
  						handled = event.ctrlKey || event.metaKey;
  						// +1 day on ctrl or command +right
  						if (event.originalEvent.altKey) $.datepicker._adjustDate(event.target, (event.ctrlKey ?
  									+$.datepicker._get(inst, 'stepBigMonths') :
  									+$.datepicker._get(inst, 'stepMonths')), 'M');
  						// next month/year on alt +right
  						break;
  				case 40: if (event.ctrlKey || event.metaKey) $.datepicker._adjustDate(event.target, +7, 'D');
  						handled = event.ctrlKey || event.metaKey;
  						break; // +1 week on ctrl or command +down
  				default: handled = false;
  			}
  		else if (event.keyCode == 36 && event.ctrlKey) // display the date picker on ctrl+home
  			$.datepicker._showDatepicker(this);
  		else {
  			handled = false;
  		}
  		if (handled) {
  			event.preventDefault();
  			event.stopPropagation();
  		}
  	},
  
  	/* Filter entered characters - based on date format. */
  	_doKeyPress: function(event) {
  		var inst = $.datepicker._getInst(event.target);
  		if ($.datepicker._get(inst, 'constrainInput')) {
  			var chars = $.datepicker._possibleChars($.datepicker._get(inst, 'dateFormat'));
  			var chr = String.fromCharCode(event.charCode == undefined ? event.keyCode : event.charCode);
  			return event.ctrlKey || event.metaKey || (chr < ' ' || !chars || chars.indexOf(chr) > -1);
  		}
  	},
  
  	/* Synchronise manual entry and field/alternate field. */
  	_doKeyUp: function(event) {
  		var inst = $.datepicker._getInst(event.target);
  		if (inst.input.val() != inst.lastVal) {
  			try {
  				var date = $.datepicker.parseDate($.datepicker._get(inst, 'dateFormat'),
  					(inst.input ? inst.input.val() : null),
  					$.datepicker._getFormatConfig(inst));
  				if (date) { // only if valid
  					$.datepicker._setDateFromField(inst);
  					$.datepicker._updateAlternate(inst);
  					$.datepicker._updateDatepicker(inst);
  				}
  			}
  			catch (err) {
  				$.datepicker.log(err);
  			}
  		}
  		return true;
  	},
  
  	/* Pop-up the date picker for a given input field.
         If false returned from beforeShow event handler do not show. 
  	   @param  input  element - the input field attached to the date picker or
  	                  event - if triggered by focus */
  	_showDatepicker: function(input) {
  		input = input.target || input;
  		if (input.nodeName.toLowerCase() != 'input') // find from button/image trigger
  			input = $('input', input.parentNode)[0];
  		if ($.datepicker._isDisabledDatepicker(input) || $.datepicker._lastInput == input) // already here
  			return;
  		var inst = $.datepicker._getInst(input);
  		if ($.datepicker._curInst && $.datepicker._curInst != inst) {
  			$.datepicker._curInst.dpDiv.stop(true, true);
  			if ( inst && $.datepicker._datepickerShowing ) {
  				$.datepicker._hideDatepicker( $.datepicker._curInst.input[0] );
  			}
  		}
  		var beforeShow = $.datepicker._get(inst, 'beforeShow');
  		var beforeShowSettings = beforeShow ? beforeShow.apply(input, [input, inst]) : {};
  		if(beforeShowSettings === false){
              //false
  			return;
  		}
  		extendRemove(inst.settings, beforeShowSettings);
  		inst.lastVal = null;
  		$.datepicker._lastInput = input;
  		$.datepicker._setDateFromField(inst);
  		if ($.datepicker._inDialog) // hide cursor
  			input.value = '';
  		if (!$.datepicker._pos) { // position below input
  			$.datepicker._pos = $.datepicker._findPos(input);
  			$.datepicker._pos[1] += input.offsetHeight; // add the height
  		}
  		var isFixed = false;
  		$(input).parents().each(function() {
  			isFixed |= $(this).css('position') == 'fixed';
  			return !isFixed;
  		});
  		if (isFixed && $.browser.opera) { // correction for Opera when fixed and scrolled
  			$.datepicker._pos[0] -= document.documentElement.scrollLeft;
  			$.datepicker._pos[1] -= document.documentElement.scrollTop;
  		}
  		var offset = {left: $.datepicker._pos[0], top: $.datepicker._pos[1]};
  		$.datepicker._pos = null;
  		//to avoid flashes on Firefox
  		inst.dpDiv.empty();
  		// determine sizing offscreen
  		inst.dpDiv.css({position: 'absolute', display: 'block', top: '-1000px'});
  		$.datepicker._updateDatepicker(inst);
  		// fix width for dynamic number of date pickers
  		// and adjust position before showing
  		offset = $.datepicker._checkOffset(inst, offset, isFixed);
  		inst.dpDiv.css({position: ($.datepicker._inDialog && $.blockUI ?
  			'static' : (isFixed ? 'fixed' : 'absolute')), display: 'none',
  			left: offset.left + 'px', top: offset.top + 'px'});
  		if (!inst.inline) {
  			var showAnim = $.datepicker._get(inst, 'showAnim');
  			var duration = $.datepicker._get(inst, 'duration');
  			var postProcess = function() {
  				var cover = inst.dpDiv.find('iframe.ui-datepicker-cover'); // IE6- only
  				if( !! cover.length ){
  					var borders = $.datepicker._getBorders(inst.dpDiv);
  					cover.css({left: -borders[0], top: -borders[1],
  						width: inst.dpDiv.outerWidth(), height: inst.dpDiv.outerHeight()});
  				}
  			};
  			inst.dpDiv.zIndex($(input).zIndex()+1);
  			$.datepicker._datepickerShowing = true;
  			if ($.effects && $.effects[showAnim])
  				inst.dpDiv.show(showAnim, $.datepicker._get(inst, 'showOptions'), duration, postProcess);
  			else
  				inst.dpDiv[showAnim || 'show']((showAnim ? duration : null), postProcess);
  			if (!showAnim || !duration)
  				postProcess();
  			if (inst.input.is(':visible') && !inst.input.is(':disabled'))
  				inst.input.focus();
  			$.datepicker._curInst = inst;
  		}
  	},
  
  	/* Generate the date picker content. */
  	_updateDatepicker: function(inst) {
  		var self = this;
  		self.maxRows = 4; //Reset the max number of rows being displayed (see #7043)
  		var borders = $.datepicker._getBorders(inst.dpDiv);
  		instActive = inst; // for delegate hover events
  		inst.dpDiv.empty().append(this._generateHTML(inst));
  		this._attachHandlers(inst);
  		var cover = inst.dpDiv.find('iframe.ui-datepicker-cover'); // IE6- only
  		if( !!cover.length ){ //avoid call to outerXXXX() when not in IE6
  			cover.css({left: -borders[0], top: -borders[1], width: inst.dpDiv.outerWidth(), height: inst.dpDiv.outerHeight()})
  		}
  		inst.dpDiv.find('.' + this._dayOverClass + ' a').mouseover();
  		var numMonths = this._getNumberOfMonths(inst);
  		var cols = numMonths[1];
  		var width = 17;
  		inst.dpDiv.removeClass('ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4').width('');
  		if (cols > 1)
  			inst.dpDiv.addClass('ui-datepicker-multi-' + cols).css('width', (width * cols) + 'em');
  		inst.dpDiv[(numMonths[0] != 1 || numMonths[1] != 1 ? 'add' : 'remove') +
  			'Class']('ui-datepicker-multi');
  		inst.dpDiv[(this._get(inst, 'isRTL') ? 'add' : 'remove') +
  			'Class']('ui-datepicker-rtl');
  		if (inst == $.datepicker._curInst && $.datepicker._datepickerShowing && inst.input &&
  				// #6694 - don't focus the input if it's already focused
  				// this breaks the change event in IE
  				inst.input.is(':visible') && !inst.input.is(':disabled') && inst.input[0] != document.activeElement)
  			inst.input.focus();
  		// deffered render of the years select (to avoid flashes on Firefox) 
  		if( inst.yearshtml ){
  			var origyearshtml = inst.yearshtml;
  			setTimeout(function(){
  				//assure that inst.yearshtml didn't change.
  				if( origyearshtml === inst.yearshtml && inst.yearshtml ){
  					inst.dpDiv.find('select.ui-datepicker-year:first').replaceWith(inst.yearshtml);
  				}
  				origyearshtml = inst.yearshtml = null;
  			}, 0);
  		}
  	},
  
  	/* Retrieve the size of left and top borders for an element.
  	   @param  elem  (jQuery object) the element of interest
  	   @return  (number[2]) the left and top borders */
  	_getBorders: function(elem) {
  		var convert = function(value) {
  			return {thin: 1, medium: 2, thick: 3}[value] || value;
  		};
  		return [parseFloat(convert(elem.css('border-left-width'))),
  			parseFloat(convert(elem.css('border-top-width')))];
  	},
  
  	/* Check positioning to remain on screen. */
  	_checkOffset: function(inst, offset, isFixed) {
  		var dpWidth = inst.dpDiv.outerWidth();
  		var dpHeight = inst.dpDiv.outerHeight();
  		var inputWidth = inst.input ? inst.input.outerWidth() : 0;
  		var inputHeight = inst.input ? inst.input.outerHeight() : 0;
  		var viewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft());
  		var viewHeight = document.documentElement.clientHeight + (isFixed ? 0 : $(document).scrollTop());
  
  		offset.left -= (this._get(inst, 'isRTL') ? (dpWidth - inputWidth) : 0);
  		offset.left -= (isFixed && offset.left == inst.input.offset().left) ? $(document).scrollLeft() : 0;
  		offset.top -= (isFixed && offset.top == (inst.input.offset().top + inputHeight)) ? $(document).scrollTop() : 0;
  
  		// now check if datepicker is showing outside window viewport - move to a better place if so.
  		offset.left -= Math.min(offset.left, (offset.left + dpWidth > viewWidth && viewWidth > dpWidth) ?
  			Math.abs(offset.left + dpWidth - viewWidth) : 0);
  		offset.top -= Math.min(offset.top, (offset.top + dpHeight > viewHeight && viewHeight > dpHeight) ?
  			Math.abs(dpHeight + inputHeight) : 0);
  
  		return offset;
  	},
  
  	/* Find an object's position on the screen. */
  	_findPos: function(obj) {
  		var inst = this._getInst(obj);
  		var isRTL = this._get(inst, 'isRTL');
          while (obj && (obj.type == 'hidden' || obj.nodeType != 1 || $.expr.filters.hidden(obj))) {
              obj = obj[isRTL ? 'previousSibling' : 'nextSibling'];
          }
          var position = $(obj).offset();
  	    return [position.left, position.top];
  	},
  
  	/* Hide the date picker from view.
  	   @param  input  element - the input field attached to the date picker */
  	_hideDatepicker: function(input) {
  		var inst = this._curInst;
  		if (!inst || (input && inst != $.data(input, PROP_NAME)))
  			return;
  		if (this._datepickerShowing) {
  			var showAnim = this._get(inst, 'showAnim');
  			var duration = this._get(inst, 'duration');
  			var postProcess = function() {
  				$.datepicker._tidyDialog(inst);
  			};
  			if ($.effects && $.effects[showAnim])
  				inst.dpDiv.hide(showAnim, $.datepicker._get(inst, 'showOptions'), duration, postProcess);
  			else
  				inst.dpDiv[(showAnim == 'slideDown' ? 'slideUp' :
  					(showAnim == 'fadeIn' ? 'fadeOut' : 'hide'))]((showAnim ? duration : null), postProcess);
  			if (!showAnim)
  				postProcess();
  			this._datepickerShowing = false;
  			var onClose = this._get(inst, 'onClose');
  			if (onClose)
  				onClose.apply((inst.input ? inst.input[0] : null),
  					[(inst.input ? inst.input.val() : ''), inst]);
  			this._lastInput = null;
  			if (this._inDialog) {
  				this._dialogInput.css({ position: 'absolute', left: '0', top: '-100px' });
  				if ($.blockUI) {
  					$.unblockUI();
  					$('body').append(this.dpDiv);
  				}
  			}
  			this._inDialog = false;
  		}
  	},
  
  	/* Tidy up after a dialog display. */
  	_tidyDialog: function(inst) {
  		inst.dpDiv.removeClass(this._dialogClass).unbind('.ui-datepicker-calendar');
  	},
  
  	/* Close date picker if clicked elsewhere. */
  	_checkExternalClick: function(event) {
  		if (!$.datepicker._curInst)
  			return;
  
  		var $target = $(event.target),
  			inst = $.datepicker._getInst($target[0]);
  
  		if ( ( ( $target[0].id != $.datepicker._mainDivId &&
  				$target.parents('#' + $.datepicker._mainDivId).length == 0 &&
  				!$target.hasClass($.datepicker.markerClassName) &&
  				!$target.closest("." + $.datepicker._triggerClass).length &&
  				$.datepicker._datepickerShowing && !($.datepicker._inDialog && $.blockUI) ) ) ||
  			( $target.hasClass($.datepicker.markerClassName) && $.datepicker._curInst != inst ) )
  			$.datepicker._hideDatepicker();
  	},
  
  	/* Adjust one of the date sub-fields. */
  	_adjustDate: function(id, offset, period) {
  		var target = $(id);
  		var inst = this._getInst(target[0]);
  		if (this._isDisabledDatepicker(target[0])) {
  			return;
  		}
  		this._adjustInstDate(inst, offset +
  			(period == 'M' ? this._get(inst, 'showCurrentAtPos') : 0), // undo positioning
  			period);
  		this._updateDatepicker(inst);
  	},
  
  	/* Action for current link. */
  	_gotoToday: function(id) {
  		var target = $(id);
  		var inst = this._getInst(target[0]);
  		if (this._get(inst, 'gotoCurrent') && inst.currentDay) {
  			inst.selectedDay = inst.currentDay;
  			inst.drawMonth = inst.selectedMonth = inst.currentMonth;
  			inst.drawYear = inst.selectedYear = inst.currentYear;
  		}
  		else {
  			var date = new Date();
  			inst.selectedDay = date.getDate();
  			inst.drawMonth = inst.selectedMonth = date.getMonth();
  			inst.drawYear = inst.selectedYear = date.getFullYear();
  		}
  		this._notifyChange(inst);
  		this._adjustDate(target);
  	},
  
  	/* Action for selecting a new month/year. */
  	_selectMonthYear: function(id, select, period) {
  		var target = $(id);
  		var inst = this._getInst(target[0]);
  		inst['selected' + (period == 'M' ? 'Month' : 'Year')] =
  		inst['draw' + (period == 'M' ? 'Month' : 'Year')] =
  			parseInt(select.options[select.selectedIndex].value,10);
  		this._notifyChange(inst);
  		this._adjustDate(target);
  	},
  
  	/* Action for selecting a day. */
  	_selectDay: function(id, month, year, td) {
  		var target = $(id);
  		if ($(td).hasClass(this._unselectableClass) || this._isDisabledDatepicker(target[0])) {
  			return;
  		}
  		var inst = this._getInst(target[0]);
  		inst.selectedDay = inst.currentDay = $('a', td).html();
  		inst.selectedMonth = inst.currentMonth = month;
  		inst.selectedYear = inst.currentYear = year;
  		this._selectDate(id, this._formatDate(inst,
  			inst.currentDay, inst.currentMonth, inst.currentYear));
  	},
  
  	/* Erase the input field and hide the date picker. */
  	_clearDate: function(id) {
  		var target = $(id);
  		var inst = this._getInst(target[0]);
  		this._selectDate(target, '');
  	},
  
  	/* Update the input field with the selected date. */
  	_selectDate: function(id, dateStr) {
  		var target = $(id);
  		var inst = this._getInst(target[0]);
  		dateStr = (dateStr != null ? dateStr : this._formatDate(inst));
  		if (inst.input)
  			inst.input.val(dateStr);
  		this._updateAlternate(inst);
  		var onSelect = this._get(inst, 'onSelect');
  		if (onSelect)
  			onSelect.apply((inst.input ? inst.input[0] : null), [dateStr, inst]);  // trigger custom callback
  		else if (inst.input)
  			inst.input.trigger('change'); // fire the change event
  		if (inst.inline)
  			this._updateDatepicker(inst);
  		else {
  			this._hideDatepicker();
  			this._lastInput = inst.input[0];
  			if (typeof(inst.input[0]) != 'object')
  				inst.input.focus(); // restore focus
  			this._lastInput = null;
  		}
  	},
  
  	/* Update any alternate field to synchronise with the main field. */
  	_updateAlternate: function(inst) {
  		var altField = this._get(inst, 'altField');
  		if (altField) { // update alternate field too
  			var altFormat = this._get(inst, 'altFormat') || this._get(inst, 'dateFormat');
  			var date = this._getDate(inst);
  			var dateStr = this.formatDate(altFormat, date, this._getFormatConfig(inst));
			/**
 			* FOLLOWING LINES MODIFIED BY ATLASSIAN  https://github.com/jquery/jquery-ui/pull/1954 https://security.snyk.io/vuln/SNYK-JS-JQUERYUI-1767167
			**/
  			$( document ).find( altField ).val( dateStr );
			/** END ATLASSIAN */
  		}
  	},
  
  	/* Set as beforeShowDay function to prevent selection of weekends.
  	   @param  date  Date - the date to customise
  	   @return [boolean, string] - is this date selectable?, what is its CSS class? */
  	noWeekends: function(date) {
  		var day = date.getDay();
  		return [(day > 0 && day < 6), ''];
  	},
  
  	/* Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.
  	   @param  date  Date - the date to get the week for
  	   @return  number - the number of the week within the year that contains this date */
  	iso8601Week: function(date) {
  		var checkDate = new Date(date.getTime());
  		// Find Thursday of this week starting on Monday
  		checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));
  		var time = checkDate.getTime();
  		checkDate.setMonth(0); // Compare with Jan 1
  		checkDate.setDate(1);
  		return Math.floor(Math.round((time - checkDate) / 86400000) / 7) + 1;
  	},
  
  	/* Parse a string value into a date object.
  	   See formatDate below for the possible formats.
  
  	   @param  format    string - the expected format of the date
  	   @param  value     string - the date in the above format
  	   @param  settings  Object - attributes include:
  	                     shortYearCutoff  number - the cutoff year for determining the century (optional)
  	                     dayNamesShort    string[7] - abbreviated names of the days from Sunday (optional)
  	                     dayNames         string[7] - names of the days from Sunday (optional)
  	                     monthNamesShort  string[12] - abbreviated names of the months (optional)
  	                     monthNames       string[12] - names of the months (optional)
  	   @return  Date - the extracted date value or null if value is blank */
  	parseDate: function (format, value, settings) {
  		if (format == null || value == null)
  			throw 'Invalid arguments';
  		value = (typeof value == 'object' ? value.toString() : value + '');
  		if (value == '')
  			return null;
  		var shortYearCutoff = (settings ? settings.shortYearCutoff : null) || this._defaults.shortYearCutoff;
  		shortYearCutoff = (typeof shortYearCutoff != 'string' ? shortYearCutoff :
  				new Date().getFullYear() % 100 + parseInt(shortYearCutoff, 10));
  		var dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort;
  		var dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames;
  		var monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort;
  		var monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames;
  		var year = -1;
  		var month = -1;
  		var day = -1;
  		var doy = -1;
  		var literal = false;
  		// Check whether a format character is doubled
  		var lookAhead = function(match) {
  			var matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) == match);
  			if (matches)
  				iFormat++;
  			return matches;
  		};
  		// Extract a number from the string value
  		var getNumber = function(match) {
  			var isDoubled = lookAhead(match);
  			var size = (match == '@' ? 14 : (match == '!' ? 20 :
  				(match == 'y' && isDoubled ? 4 : (match == 'o' ? 3 : 2))));
  			var digits = new RegExp('^\\d{1,' + size + '}');
  			var num = value.substring(iValue).match(digits);
  			if (!num)
  				throw 'Missing number at position ' + iValue;
  			iValue += num[0].length;
  			return parseInt(num[0], 10);
  		};
  		// Extract a name from the string value and convert to an index
  		var getName = function(match, shortNames, longNames) {
  			var names = $.map(lookAhead(match) ? longNames : shortNames, function (v, k) {
  				return [ [k, v] ];
  			}).sort(function (a, b) {
  				return -(a[1].length - b[1].length);
  			});
  			var index = -1;
  			$.each(names, function (i, pair) {
  				var name = pair[1];
  				if (value.substr(iValue, name.length).toLowerCase() == name.toLowerCase()) {
  					index = pair[0];
  					iValue += name.length;
  					return false;
  				}
  			});
  			if (index != -1)
  				return index + 1;
  			else
  				throw 'Unknown name at position ' + iValue;
  		};
  		// Confirm that a literal character matches the string value
  		var checkLiteral = function() {
  			if (value.charAt(iValue) != format.charAt(iFormat))
  				throw 'Unexpected literal at position ' + iValue;
  			iValue++;
  		};
  		var iValue = 0;
  		for (var iFormat = 0; iFormat < format.length; iFormat++) {
  			if (literal)
  				if (format.charAt(iFormat) == "'" && !lookAhead("'"))
  					literal = false;
  				else
  					checkLiteral();
  			else
  				switch (format.charAt(iFormat)) {
  					case 'd':
  						day = getNumber('d');
  						break;
  					case 'D':
  						getName('D', dayNamesShort, dayNames);
  						break;
  					case 'o':
  						doy = getNumber('o');
  						break;
  					case 'm':
  						month = getNumber('m');
  						break;
  					case 'M':
  						month = getName('M', monthNamesShort, monthNames);
  						break;
  					case 'y':
  						year = getNumber('y');
  						break;
  					case '@':
  						var date = new Date(getNumber('@'));
  						year = date.getFullYear();
  						month = date.getMonth() + 1;
  						day = date.getDate();
  						break;
  					case '!':
  						var date = new Date((getNumber('!') - this._ticksTo1970) / 10000);
  						year = date.getFullYear();
  						month = date.getMonth() + 1;
  						day = date.getDate();
  						break;
  					case "'":
  						if (lookAhead("'"))
  							checkLiteral();
  						else
  							literal = true;
  						break;
  					default:
  						checkLiteral();
  				}
  		}
  		if (iValue < value.length){
  			throw "Extra/unparsed characters found in date: " + value.substring(iValue);
  		}
  		if (year == -1)
  			year = new Date().getFullYear();
  		else if (year < 100)
  			year += new Date().getFullYear() - new Date().getFullYear() % 100 +
  				(year <= shortYearCutoff ? 0 : -100);
  		if (doy > -1) {
  			month = 1;
  			day = doy;
  			do {
  				var dim = this._getDaysInMonth(year, month - 1);
  				if (day <= dim)
  					break;
  				month++;
  				day -= dim;
  			} while (true);
  		}
  		var date = this._daylightSavingAdjust(new Date(year, month - 1, day));
  		if (date.getFullYear() != year || date.getMonth() + 1 != month || date.getDate() != day)
  			throw 'Invalid date'; // E.g. 31/02/00
  		return date;
  	},
  
  	/* Standard date formats. */
  	ATOM: 'yy-mm-dd', // RFC 3339 (ISO 8601)
  	COOKIE: 'D, dd M yy',
  	ISO_8601: 'yy-mm-dd',
  	RFC_822: 'D, d M y',
  	RFC_850: 'DD, dd-M-y',
  	RFC_1036: 'D, d M y',
  	RFC_1123: 'D, d M yy',
  	RFC_2822: 'D, d M yy',
  	RSS: 'D, d M y', // RFC 822
  	TICKS: '!',
  	TIMESTAMP: '@',
  	W3C: 'yy-mm-dd', // ISO 8601
  
  	_ticksTo1970: (((1970 - 1) * 365 + Math.floor(1970 / 4) - Math.floor(1970 / 100) +
  		Math.floor(1970 / 400)) * 24 * 60 * 60 * 10000000),
  
  	/* Format a date object into a string value.
  	   The format can be combinations of the following:
  	   d  - day of month (no leading zero)
  	   dd - day of month (two digit)
  	   o  - day of year (no leading zeros)
  	   oo - day of year (three digit)
  	   D  - day name short
  	   DD - day name long
  	   m  - month of year (no leading zero)
  	   mm - month of year (two digit)
  	   M  - month name short
  	   MM - month name long
  	   y  - year (two digit)
  	   yy - year (four digit)
  	   @ - Unix timestamp (ms since 01/01/1970)
  	   ! - Windows ticks (100ns since 01/01/0001)
  	   '...' - literal text
  	   '' - single quote
  
  	   @param  format    string - the desired format of the date
  	   @param  date      Date - the date value to format
  	   @param  settings  Object - attributes include:
  	                     dayNamesShort    string[7] - abbreviated names of the days from Sunday (optional)
  	                     dayNames         string[7] - names of the days from Sunday (optional)
  	                     monthNamesShort  string[12] - abbreviated names of the months (optional)
  	                     monthNames       string[12] - names of the months (optional)
  	   @return  string - the date in the above format */
  	formatDate: function (format, date, settings) {
  		if (!date)
  			return '';
  		var dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort;
  		var dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames;
  		var monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort;
  		var monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames;
  		// Check whether a format character is doubled
  		var lookAhead = function(match) {
  			var matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) == match);
  			if (matches)
  				iFormat++;
  			return matches;
  		};
  		// Format a number, with leading zero if necessary
  		var formatNumber = function(match, value, len) {
  			var num = '' + value;
  			if (lookAhead(match))
  				while (num.length < len)
  					num = '0' + num;
  			return num;
  		};
  		// Format a name, short or long as requested
  		var formatName = function(match, value, shortNames, longNames) {
  			return (lookAhead(match) ? longNames[value] : shortNames[value]);
  		};
  		var output = '';
  		var literal = false;
  		if (date)
  			for (var iFormat = 0; iFormat < format.length; iFormat++) {
  				if (literal)
  					if (format.charAt(iFormat) == "'" && !lookAhead("'"))
  						literal = false;
  					else
  						output += format.charAt(iFormat);
  				else
  					switch (format.charAt(iFormat)) {
  						case 'd':
  							output += formatNumber('d', date.getDate(), 2);
  							break;
  						case 'D':
  							output += formatName('D', date.getDay(), dayNamesShort, dayNames);
  							break;
  						case 'o':
  							output += formatNumber('o',
  								Math.round((new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime() - new Date(date.getFullYear(), 0, 0).getTime()) / 86400000), 3);
  							break;
  						case 'm':
  							output += formatNumber('m', date.getMonth() + 1, 2);
  							break;
  						case 'M':
  							output += formatName('M', date.getMonth(), monthNamesShort, monthNames);
  							break;
  						case 'y':
  							output += (lookAhead('y') ? date.getFullYear() :
  								(date.getYear() % 100 < 10 ? '0' : '') + date.getYear() % 100);
  							break;
  						case '@':
  							output += date.getTime();
  							break;
  						case '!':
  							output += date.getTime() * 10000 + this._ticksTo1970;
  							break;
  						case "'":
  							if (lookAhead("'"))
  								output += "'";
  							else
  								literal = true;
  							break;
  						default:
  							output += format.charAt(iFormat);
  					}
  			}
  		return output;
  	},
  
  	/* Extract all possible characters from the date format. */
  	_possibleChars: function (format) {
  		var chars = '';
  		var literal = false;
  		// Check whether a format character is doubled
  		var lookAhead = function(match) {
  			var matches = (iFormat + 1 < format.length && format.charAt(iFormat + 1) == match);
  			if (matches)
  				iFormat++;
  			return matches;
  		};
  		for (var iFormat = 0; iFormat < format.length; iFormat++)
  			if (literal)
  				if (format.charAt(iFormat) == "'" && !lookAhead("'"))
  					literal = false;
  				else
  					chars += format.charAt(iFormat);
  			else
  				switch (format.charAt(iFormat)) {
  					case 'd': case 'm': case 'y': case '@':
  						chars += '0123456789';
  						break;
  					case 'D': case 'M':
  						return null; // Accept anything
  					case "'":
  						if (lookAhead("'"))
  							chars += "'";
  						else
  							literal = true;
  						break;
  					default:
  						chars += format.charAt(iFormat);
  				}
  		return chars;
  	},
  
  	/* Get a setting value, defaulting if necessary. */
  	_get: function(inst, name) {
  		return inst.settings[name] !== undefined ?
  			inst.settings[name] : this._defaults[name];
  	},
  
  	/* Parse existing date and initialise date picker. */
  	_setDateFromField: function(inst, noDefault) {
  		if (inst.input.val() == inst.lastVal) {
  			return;
  		}
  		var dateFormat = this._get(inst, 'dateFormat');
  		var dates = inst.lastVal = inst.input ? inst.input.val() : null;
  		var date, defaultDate;
  		date = defaultDate = this._getDefaultDate(inst);
  		var settings = this._getFormatConfig(inst);
  		try {
  			date = this.parseDate(dateFormat, dates, settings) || defaultDate;
  		} catch (event) {
  			this.log(event);
  			dates = (noDefault ? '' : dates);
  		}
  		inst.selectedDay = date.getDate();
  		inst.drawMonth = inst.selectedMonth = date.getMonth();
  		inst.drawYear = inst.selectedYear = date.getFullYear();
  		inst.currentDay = (dates ? date.getDate() : 0);
  		inst.currentMonth = (dates ? date.getMonth() : 0);
  		inst.currentYear = (dates ? date.getFullYear() : 0);
  		this._adjustInstDate(inst);
  	},
  
  	/* Retrieve the default date shown on opening. */
  	_getDefaultDate: function(inst) {
  		return this._restrictMinMax(inst,
  			this._determineDate(inst, this._get(inst, 'defaultDate'), new Date()));
  	},
  
  	/* A date may be specified as an exact value or a relative one. */
  	_determineDate: function(inst, date, defaultDate) {
  		var offsetNumeric = function(offset) {
  			var date = new Date();
  			date.setDate(date.getDate() + offset);
  			return date;
  		};
  		var offsetString = function(offset) {
  			try {
  				return $.datepicker.parseDate($.datepicker._get(inst, 'dateFormat'),
  					offset, $.datepicker._getFormatConfig(inst));
  			}
  			catch (e) {
  				// Ignore
  			}
  			var date = (offset.toLowerCase().match(/^c/) ?
  				$.datepicker._getDate(inst) : null) || new Date();
  			var year = date.getFullYear();
  			var month = date.getMonth();
  			var day = date.getDate();
  			var pattern = /([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g;
  			var matches = pattern.exec(offset);
  			while (matches) {
  				switch (matches[2] || 'd') {
  					case 'd' : case 'D' :
  						day += parseInt(matches[1],10); break;
  					case 'w' : case 'W' :
  						day += parseInt(matches[1],10) * 7; break;
  					case 'm' : case 'M' :
  						month += parseInt(matches[1],10);
  						day = Math.min(day, $.datepicker._getDaysInMonth(year, month));
  						break;
  					case 'y': case 'Y' :
  						year += parseInt(matches[1],10);
  						day = Math.min(day, $.datepicker._getDaysInMonth(year, month));
  						break;
  				}
  				matches = pattern.exec(offset);
  			}
  			return new Date(year, month, day);
  		};
  		var newDate = (date == null || date === '' ? defaultDate : (typeof date == 'string' ? offsetString(date) :
  			(typeof date == 'number' ? (isNaN(date) ? defaultDate : offsetNumeric(date)) : new Date(date.getTime()))));
  		newDate = (newDate && newDate.toString() == 'Invalid Date' ? defaultDate : newDate);
  		if (newDate) {
  			newDate.setHours(0);
  			newDate.setMinutes(0);
  			newDate.setSeconds(0);
  			newDate.setMilliseconds(0);
  		}
  		return this._daylightSavingAdjust(newDate);
  	},
  
  	/* Handle switch to/from daylight saving.
  	   Hours may be non-zero on daylight saving cut-over:
  	   > 12 when midnight changeover, but then cannot generate
  	   midnight datetime, so jump to 1AM, otherwise reset.
  	   @param  date  (Date) the date to check
  	   @return  (Date) the corrected date */
  	_daylightSavingAdjust: function(date) {
  		if (!date) return null;
  		date.setHours(date.getHours() > 12 ? date.getHours() + 2 : 0);
  		return date;
  	},
  
  	/* Set the date(s) directly. */
  	_setDate: function(inst, date, noChange) {
  		var clear = !date;
  		var origMonth = inst.selectedMonth;
  		var origYear = inst.selectedYear;
  		var newDate = this._restrictMinMax(inst, this._determineDate(inst, date, new Date()));
  		inst.selectedDay = inst.currentDay = newDate.getDate();
  		inst.drawMonth = inst.selectedMonth = inst.currentMonth = newDate.getMonth();
  		inst.drawYear = inst.selectedYear = inst.currentYear = newDate.getFullYear();
  		if ((origMonth != inst.selectedMonth || origYear != inst.selectedYear) && !noChange)
  			this._notifyChange(inst);
  		this._adjustInstDate(inst);
  		if (inst.input) {
  			inst.input.val(clear ? '' : this._formatDate(inst));
  		}
  	},
  
  	/* Retrieve the date(s) directly. */
  	_getDate: function(inst) {
  		var startDate = (!inst.currentYear || (inst.input && inst.input.val() == '') ? null :
  			this._daylightSavingAdjust(new Date(
  			inst.currentYear, inst.currentMonth, inst.currentDay)));
  			return startDate;
  	},
  
  	/* Attach the onxxx handlers.  These are declared statically so
  	 * they work with static code transformers like Caja.
  	 */
  	_attachHandlers: function(inst) {
  		var stepMonths = this._get(inst, 'stepMonths');
  		var id = '#' + inst.id.replace( /\\\\/g, "\\" );
  		inst.dpDiv.find('[data-handler]').map(function () {
  			var handler = {
  				prev: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._adjustDate(id, -stepMonths, 'M');
  				},
  				next: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._adjustDate(id, +stepMonths, 'M');
  				},
  				hide: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._hideDatepicker();
  				},
  				today: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._gotoToday(id);
  				},
  				selectDay: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._selectDay(id, +this.getAttribute('data-month'), +this.getAttribute('data-year'), this);
  					return false;
  				},
  				selectMonth: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._selectMonthYear(id, this, 'M');
  					return false;
  				},
  				selectYear: function () {
  					window['DP_jQuery_' + dpuuid].datepicker._selectMonthYear(id, this, 'Y');
  					return false;
  				}
  			};
  			$(this).bind(this.getAttribute('data-event'), handler[this.getAttribute('data-handler')]);
  		});
  	},
  	
  	/* Generate the HTML for the current state of the date picker. */
  	_generateHTML: function(inst) {
  		var today = new Date();
  		today = this._daylightSavingAdjust(
  			new Date(today.getFullYear(), today.getMonth(), today.getDate())); // clear time
  		var isRTL = this._get(inst, 'isRTL');
  		var showButtonPanel = this._get(inst, 'showButtonPanel');
  		var hideIfNoPrevNext = this._get(inst, 'hideIfNoPrevNext');
  		var navigationAsDateFormat = this._get(inst, 'navigationAsDateFormat');
  		var numMonths = this._getNumberOfMonths(inst);
  		var showCurrentAtPos = this._get(inst, 'showCurrentAtPos');
  		var stepMonths = this._get(inst, 'stepMonths');
  		var isMultiMonth = (numMonths[0] != 1 || numMonths[1] != 1);
  		var currentDate = this._daylightSavingAdjust((!inst.currentDay ? new Date(9999, 9, 9) :
  			new Date(inst.currentYear, inst.currentMonth, inst.currentDay)));
  		var minDate = this._getMinMaxDate(inst, 'min');
  		var maxDate = this._getMinMaxDate(inst, 'max');
  		var drawMonth = inst.drawMonth - showCurrentAtPos;
  		var drawYear = inst.drawYear;
  		if (drawMonth < 0) {
  			drawMonth += 12;
  			drawYear--;
  		}
  		if (maxDate) {
  			var maxDraw = this._daylightSavingAdjust(new Date(maxDate.getFullYear(),
  				maxDate.getMonth() - (numMonths[0] * numMonths[1]) + 1, maxDate.getDate()));
  			maxDraw = (minDate && maxDraw < minDate ? minDate : maxDraw);
  			while (this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1)) > maxDraw) {
  				drawMonth--;
  				if (drawMonth < 0) {
  					drawMonth = 11;
  					drawYear--;
  				}
  			}
  		}
  		inst.drawMonth = drawMonth;
  		inst.drawYear = drawYear;
  		var prevText = this._get(inst, 'prevText');
  		prevText = (!navigationAsDateFormat ? prevText : this.formatDate(prevText,
  			this._daylightSavingAdjust(new Date(drawYear, drawMonth - stepMonths, 1)),
  			this._getFormatConfig(inst)));
		/**
        * FOLLOWING LINES MODIFIED BY ATLASSIAN  https://github.com/jquery/jquery-ui/pull/1953 https://security.snyk.io/vuln/SNYK-JS-JQUERYUI-1767767
        **/
  		var prev;
		  if ( this._canAdjustMonth( inst, -1, drawYear, drawMonth ) ) {
			prev = $( "<a>" )
				.attr( {
					"class": "ui-datepicker-prev ui-corner-all",
					"data-handler": "prev",
					"data-event": "click",
					title: prevText
				} )
				.append(
					$( "<span>" )
						.addClass( "ui-icon ui-icon-circle-triangle-" +
							( isRTL ? "e" : "w" ) )
						.text( prevText )
				)[ 0 ].outerHTML;
		} else if ( hideIfNoPrevNext ) {
			prev = "";
		} else {
			prev = $( "<a>" )
				.attr( {
					"class": "ui-datepicker-prev ui-corner-all ui-state-disabled",
					title: prevText
				} )
				.append(
					$( "<span>" )
						.addClass( "ui-icon ui-icon-circle-triangle-" +
							( isRTL ? "e" : "w" ) )
						.text( prevText )
				)[ 0 ].outerHTML;
		}
		/** END ATLASSIAN */
		var nextText = this._get(inst, 'nextText');
  		nextText = (!navigationAsDateFormat ? nextText : this.formatDate(nextText,
  			this._daylightSavingAdjust(new Date(drawYear, drawMonth + stepMonths, 1)),
  			this._getFormatConfig(inst)));
		/**
        * FOLLOWING LINES MODIFIED BY ATLASSIAN  https://github.com/jquery/jquery-ui/pull/1953 https://security.snyk.io/vuln/SNYK-JS-JQUERYUI-1767767
        **/	  
  		var next;
		  if ( this._canAdjustMonth( inst, +1, drawYear, drawMonth ) ) {
			next = $( "<a>" )
				.attr( {
					"class": "ui-datepicker-next ui-corner-all",
					"data-handler": "next",
					"data-event": "click",
					title: nextText
				} )
				.append(
					$( "<span>" )
						.addClass( "ui-icon ui-icon-circle-triangle-" +
							( isRTL ? "w" : "e" ) )
						.text( nextText )
				)[ 0 ].outerHTML;
		} else if ( hideIfNoPrevNext ) {
			next = "";
		} else {
			next = $( "<a>" )
				.attr( {
					"class": "ui-datepicker-next ui-corner-all ui-state-disabled",
					title: nextText
				} )
				.append(
					$( "<span>" )
						.attr( "class", "ui-icon ui-icon-circle-triangle-" +
							( isRTL ? "w" : "e" ) )
						.text( nextText )
				)[ 0 ].outerHTML;
		}
		/** END ATLASSIAN */
  		var currentText = this._get(inst, 'currentText');
  		var gotoDate = (this._get(inst, 'gotoCurrent') && inst.currentDay ? currentDate : today);
  		currentText = (!navigationAsDateFormat ? currentText :
  		this.formatDate(currentText, gotoDate, this._getFormatConfig(inst)));
		
	    /**
        * FOLLOWING LINES MODIFIED BY ATLASSIAN  https://github.com/jquery/jquery-ui/pull/1953 https://security.snyk.io/vuln/SNYK-JS-JQUERYUI-1767767
        **/	
	    var controls = "";
		
		if ( !inst.inline ) {
			controls = $( "<button>" )
			  .attr( {
				  type: "button",
				  "class": "ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all",
				  "data-handler": "hide",
				  "data-event": "click"
			  } )
			  .text( this._get( inst, "closeText" ) )[ 0 ].outerHTML;
	  	}
	  
	 	var buttonPanel = "";
	 	if ( showButtonPanel ) {
			buttonPanel = $( "<div class='ui-datepicker-buttonpane ui-widget-content'>" )
			    .append( isRTL ? controls : "" )
		        .append( this._isInRange( inst, gotoDate ) ?
				  $( "<button>" )
					  .attr( {
						  type: "button",
						  "class": "ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all",
						  "data-handler": "today",
						  "data-event": "click"
					  } )
					  .text( currentText ) :
				  "" )
			    .append( isRTL ? "" : controls )[ 0 ].outerHTML;
	    }
		/** END ATLASSIAN */
  		var firstDay = parseInt(this._get(inst, 'firstDay'),10);
  		firstDay = (isNaN(firstDay) ? 0 : firstDay);
  		var showWeek = this._get(inst, 'showWeek');
  		var dayNames = this._get(inst, 'dayNames');
  		var dayNamesShort = this._get(inst, 'dayNamesShort');
  		var dayNamesMin = this._get(inst, 'dayNamesMin');
  		var monthNames = this._get(inst, 'monthNames');
  		var monthNamesShort = this._get(inst, 'monthNamesShort');
  		var beforeShowDay = this._get(inst, 'beforeShowDay');
  		var showOtherMonths = this._get(inst, 'showOtherMonths');
  		var selectOtherMonths = this._get(inst, 'selectOtherMonths');
  		var calculateWeek = this._get(inst, 'calculateWeek') || this.iso8601Week;
  		var defaultDate = this._getDefaultDate(inst);
  		var html = '';
  		for (var row = 0; row < numMonths[0]; row++) {
  			var group = '';
  			this.maxRows = 4;
  			for (var col = 0; col < numMonths[1]; col++) {
  				var selectedDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, inst.selectedDay));
  				var cornerClass = ' ui-corner-all';
  				var calender = '';
  				if (isMultiMonth) {
  					calender += '<div class="ui-datepicker-group';
  					if (numMonths[1] > 1)
  						switch (col) {
  							case 0: calender += ' ui-datepicker-group-first';
  								cornerClass = ' ui-corner-' + (isRTL ? 'right' : 'left'); break;
  							case numMonths[1]-1: calender += ' ui-datepicker-group-last';
  								cornerClass = ' ui-corner-' + (isRTL ? 'left' : 'right'); break;
  							default: calender += ' ui-datepicker-group-middle'; cornerClass = ''; break;
  						}
  					calender += '">';
  				}
  				calender += '<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix' + cornerClass + '">' +
  					(/all|left/.test(cornerClass) && row == 0 ? (isRTL ? next : prev) : '') +
  					(/all|right/.test(cornerClass) && row == 0 ? (isRTL ? prev : next) : '') +
  					this._generateMonthYearHeader(inst, drawMonth, drawYear, minDate, maxDate,
  					row > 0 || col > 0, monthNames, monthNamesShort) + // draw month headers
  					'</div><table class="ui-datepicker-calendar"><thead>' +
  					'<tr>';
  				var thead = (showWeek ? '<th class="ui-datepicker-week-col">' + this._get(inst, 'weekHeader') + '</th>' : '');
  				for (var dow = 0; dow < 7; dow++) { // days of the week
  					var day = (dow + firstDay) % 7;
  					thead += '<th' + ((dow + firstDay + 6) % 7 >= 5 ? ' class="ui-datepicker-week-end"' : '') + '>' +
  						'<span title="' + dayNames[day] + '">' + dayNamesMin[day] + '</span></th>';
  				}
  				calender += thead + '</tr></thead><tbody>';
  				var daysInMonth = this._getDaysInMonth(drawYear, drawMonth);
  				if (drawYear == inst.selectedYear && drawMonth == inst.selectedMonth)
  					inst.selectedDay = Math.min(inst.selectedDay, daysInMonth);
  				var leadDays = (this._getFirstDayOfMonth(drawYear, drawMonth) - firstDay + 7) % 7;
  				var curRows = Math.ceil((leadDays + daysInMonth) / 7); // calculate the number of rows to generate
  				var numRows = (isMultiMonth ? this.maxRows > curRows ? this.maxRows : curRows : curRows); //If multiple months, use the higher number of rows (see #7043)
  				this.maxRows = numRows;
  				var printDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1 - leadDays));
  				for (var dRow = 0; dRow < numRows; dRow++) { // create date picker rows
  					calender += '<tr>';
  					var tbody = (!showWeek ? '' : '<td class="ui-datepicker-week-col">' +
  						this._get(inst, 'calculateWeek')(printDate) + '</td>');
  					for (var dow = 0; dow < 7; dow++) { // create date picker days
  						var daySettings = (beforeShowDay ?
  							beforeShowDay.apply((inst.input ? inst.input[0] : null), [printDate]) : [true, '']);
  						var otherMonth = (printDate.getMonth() != drawMonth);
  						var unselectable = (otherMonth && !selectOtherMonths) || !daySettings[0] ||
  							(minDate && printDate < minDate) || (maxDate && printDate > maxDate);
  						tbody += '<td class="' +
  							((dow + firstDay + 6) % 7 >= 5 ? ' ui-datepicker-week-end' : '') + // highlight weekends
  							(otherMonth ? ' ui-datepicker-other-month' : '') + // highlight days from other months
  							((printDate.getTime() == selectedDate.getTime() && drawMonth == inst.selectedMonth && inst._keyEvent) || // user pressed key
  							(defaultDate.getTime() == printDate.getTime() && defaultDate.getTime() == selectedDate.getTime()) ?
  							// or defaultDate is current printedDate and defaultDate is selectedDate
  							' ' + this._dayOverClass : '') + // highlight selected day
  							(unselectable ? ' ' + this._unselectableClass + ' ui-state-disabled': '') +  // highlight unselectable days
  							(otherMonth && !showOtherMonths ? '' : ' ' + daySettings[1] + // highlight custom dates
  							(printDate.getTime() == currentDate.getTime() ? ' ' + this._currentClass : '') + // highlight selected day
  							(printDate.getTime() == today.getTime() ? ' ui-datepicker-today' : '')) + '"' + // highlight today (if different)
  							((!otherMonth || showOtherMonths) && daySettings[2] ? ' title="' + daySettings[2] + '"' : '') + // cell title
  							(unselectable ? '' : ' data-handler="selectDay" data-event="click" data-month="' + printDate.getMonth() + '" data-year="' + printDate.getFullYear() + '"') + '>' + // actions
  							(otherMonth && !showOtherMonths ? '&#xa0;' : // display for other months
  							(unselectable ? '<span class="ui-state-default">' + printDate.getDate() + '</span>' : '<a class="ui-state-default' +
  							(printDate.getTime() == today.getTime() ? ' ui-state-highlight' : '') +
  							(printDate.getTime() == currentDate.getTime() ? ' ui-state-active' : '') + // highlight selected day
  							(otherMonth ? ' ui-priority-secondary' : '') + // distinguish dates from other months
  							'" href="#">' + printDate.getDate() + '</a>')) + '</td>'; // display selectable date
  						printDate.setDate(printDate.getDate() + 1);
  						printDate = this._daylightSavingAdjust(printDate);
  					}
  					calender += tbody + '</tr>';
  				}
  				drawMonth++;
  				if (drawMonth > 11) {
  					drawMonth = 0;
  					drawYear++;
  				}
  				calender += '</tbody></table>' + (isMultiMonth ? '</div>' + 
  							((numMonths[0] > 0 && col == numMonths[1]-1) ? '<div class="ui-datepicker-row-break"></div>' : '') : '');
  				group += calender;
  			}
  			html += group;
  		}
  		html += buttonPanel + ($.browser.msie && parseInt($.browser.version,10) < 7 && !inst.inline ?
  			'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>' : '');
  		inst._keyEvent = false;
  		return html;
  	},
  
  	/* Generate the month and year header. */
  	_generateMonthYearHeader: function(inst, drawMonth, drawYear, minDate, maxDate,
  			secondary, monthNames, monthNamesShort) {
  		var changeMonth = this._get(inst, 'changeMonth');
  		var changeYear = this._get(inst, 'changeYear');
  		var showMonthAfterYear = this._get(inst, 'showMonthAfterYear');
  		var html = '<div class="ui-datepicker-title">';
  		var monthHtml = '';
  		// month selection
  		if (secondary || !changeMonth)
  			monthHtml += '<span class="ui-datepicker-month">' + monthNames[drawMonth] + '</span>';
  		else {
  			var inMinYear = (minDate && minDate.getFullYear() == drawYear);
  			var inMaxYear = (maxDate && maxDate.getFullYear() == drawYear);
  			monthHtml += '<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';
  			for (var month = 0; month < 12; month++) {
  				if ((!inMinYear || month >= minDate.getMonth()) &&
  						(!inMaxYear || month <= maxDate.getMonth()))
  					monthHtml += '<option value="' + month + '"' +
  						(month == drawMonth ? ' selected="selected"' : '') +
  						'>' + monthNamesShort[month] + '</option>';
  			}
  			monthHtml += '</select>';
  		}
  		if (!showMonthAfterYear)
  			html += monthHtml + (secondary || !(changeMonth && changeYear) ? '&#xa0;' : '');
  		// year selection
  		if ( !inst.yearshtml ) {
  			inst.yearshtml = '';
  			if (secondary || !changeYear)
  				html += '<span class="ui-datepicker-year">' + drawYear + '</span>';
  			else {
  				// determine range of years to display
  				var years = this._get(inst, 'yearRange').split(':');
  				var thisYear = new Date().getFullYear();
  				var determineYear = function(value) {
  					var year = (value.match(/c[+-].*/) ? drawYear + parseInt(value.substring(1), 10) :
  						(value.match(/[+-].*/) ? thisYear + parseInt(value, 10) :
  						parseInt(value, 10)));
  					return (isNaN(year) ? thisYear : year);
  				};
  				var year = determineYear(years[0]);
  				var endYear = Math.max(year, determineYear(years[1] || ''));
  				year = (minDate ? Math.max(year, minDate.getFullYear()) : year);
  				endYear = (maxDate ? Math.min(endYear, maxDate.getFullYear()) : endYear);
  				inst.yearshtml += '<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';
  				for (; year <= endYear; year++) {
  					inst.yearshtml += '<option value="' + year + '"' +
  						(year == drawYear ? ' selected="selected"' : '') +
  						'>' + year + '</option>';
  				}
  				inst.yearshtml += '</select>';
  				
  				html += inst.yearshtml;
  				inst.yearshtml = null;
  			}
  		}
  		html += this._get(inst, 'yearSuffix');
  		if (showMonthAfterYear)
  			html += (secondary || !(changeMonth && changeYear) ? '&#xa0;' : '') + monthHtml;
  		html += '</div>'; // Close datepicker_header
  		return html;
  	},
  
  	/* Adjust one of the date sub-fields. */
  	_adjustInstDate: function(inst, offset, period) {
  		var year = inst.drawYear + (period == 'Y' ? offset : 0);
  		var month = inst.drawMonth + (period == 'M' ? offset : 0);
  		var day = Math.min(inst.selectedDay, this._getDaysInMonth(year, month)) +
  			(period == 'D' ? offset : 0);
  		var date = this._restrictMinMax(inst,
  			this._daylightSavingAdjust(new Date(year, month, day)));
  		inst.selectedDay = date.getDate();
  		inst.drawMonth = inst.selectedMonth = date.getMonth();
  		inst.drawYear = inst.selectedYear = date.getFullYear();
  		if (period == 'M' || period == 'Y')
  			this._notifyChange(inst);
  	},
  
  	/* Ensure a date is within any min/max bounds. */
  	_restrictMinMax: function(inst, date) {
  		var minDate = this._getMinMaxDate(inst, 'min');
  		var maxDate = this._getMinMaxDate(inst, 'max');
  		var newDate = (minDate && date < minDate ? minDate : date);
  		newDate = (maxDate && newDate > maxDate ? maxDate : newDate);
  		return newDate;
  	},
  
  	/* Notify change of month/year. */
  	_notifyChange: function(inst) {
  		var onChange = this._get(inst, 'onChangeMonthYear');
  		if (onChange)
  			onChange.apply((inst.input ? inst.input[0] : null),
  				[inst.selectedYear, inst.selectedMonth + 1, inst]);
  	},
  
  	/* Determine the number of months to show. */
  	_getNumberOfMonths: function(inst) {
  		var numMonths = this._get(inst, 'numberOfMonths');
  		return (numMonths == null ? [1, 1] : (typeof numMonths == 'number' ? [1, numMonths] : numMonths));
  	},
  
  	/* Determine the current maximum date - ensure no time components are set. */
  	_getMinMaxDate: function(inst, minMax) {
  		return this._determineDate(inst, this._get(inst, minMax + 'Date'), null);
  	},
  
  	/* Find the number of days in a given month. */
  	_getDaysInMonth: function(year, month) {
  		return 32 - this._daylightSavingAdjust(new Date(year, month, 32)).getDate();
  	},
  
  	/* Find the day of the week of the first of a month. */
  	_getFirstDayOfMonth: function(year, month) {
  		return new Date(year, month, 1).getDay();
  	},
  
  	/* Determines if we should allow a "next/prev" month display change. */
  	_canAdjustMonth: function(inst, offset, curYear, curMonth) {
  		var numMonths = this._getNumberOfMonths(inst);
  		var date = this._daylightSavingAdjust(new Date(curYear,
  			curMonth + (offset < 0 ? offset : numMonths[0] * numMonths[1]), 1));
  		if (offset < 0)
  			date.setDate(this._getDaysInMonth(date.getFullYear(), date.getMonth()));
  		return this._isInRange(inst, date);
  	},
  
  	/* Is the given date in the accepted range? */
  	_isInRange: function(inst, date) {
  		var minDate = this._getMinMaxDate(inst, 'min');
  		var maxDate = this._getMinMaxDate(inst, 'max');
  		return ((!minDate || date.getTime() >= minDate.getTime()) &&
  			(!maxDate || date.getTime() <= maxDate.getTime()));
  	},
  
  	/* Provide the configuration settings for formatting/parsing. */
  	_getFormatConfig: function(inst) {
  		var shortYearCutoff = this._get(inst, 'shortYearCutoff');
  		shortYearCutoff = (typeof shortYearCutoff != 'string' ? shortYearCutoff :
  			new Date().getFullYear() % 100 + parseInt(shortYearCutoff, 10));
  		return {shortYearCutoff: shortYearCutoff,
  			dayNamesShort: this._get(inst, 'dayNamesShort'), dayNames: this._get(inst, 'dayNames'),
  			monthNamesShort: this._get(inst, 'monthNamesShort'), monthNames: this._get(inst, 'monthNames')};
  	},
  
  	/* Format the given date for display. */
  	_formatDate: function(inst, day, month, year) {
  		if (!day) {
  			inst.currentDay = inst.selectedDay;
  			inst.currentMonth = inst.selectedMonth;
  			inst.currentYear = inst.selectedYear;
  		}
  		var date = (day ? (typeof day == 'object' ? day :
  			this._daylightSavingAdjust(new Date(year, month, day))) :
  			this._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay)));
  		return this.formatDate(this._get(inst, 'dateFormat'), date, this._getFormatConfig(inst));
  	}
  });
  
  /*
   * Bind hover events for datepicker elements.
   * Done via delegate so the binding only occurs once in the lifetime of the parent div.
   * Global instActive, set by _updateDatepicker allows the handlers to find their way back to the active picker.
   */ 
  function bindHover(dpDiv) {
  	var selector = 'button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a';
  	return dpDiv.bind('mouseout', function(event) {
  			var elem = $( event.target ).closest( selector );
  			if ( !elem.length ) {
  				return;
  			}
  			elem.removeClass( "ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover" );
  		})
  		.bind('mouseover', function(event) {
  			var elem = $( event.target ).closest( selector );
  			if ($.datepicker._isDisabledDatepicker( instActive.inline ? dpDiv.parent()[0] : instActive.input[0]) ||
  					!elem.length ) {
  				return;
  			}
  			elem.parents('.ui-datepicker-calendar').find('a').removeClass('ui-state-hover');
  			elem.addClass('ui-state-hover');
  			if (elem.hasClass('ui-datepicker-prev')) elem.addClass('ui-datepicker-prev-hover');
  			if (elem.hasClass('ui-datepicker-next')) elem.addClass('ui-datepicker-next-hover');
  		});
  }
  
  /* jQuery extend now ignores nulls! */
  function extendRemove(target, props) {
  	$.extend(target, props);
  	for (var name in props)
  		if (props[name] == null || props[name] == undefined)
  			target[name] = props[name];
  	return target;
  };
  
  /* Determine whether an object is an array. */
  function isArray(a) {
  	return (a && (($.browser.safari && typeof a == 'object' && a.length) ||
  		(a.constructor && a.constructor.toString().match(/\Array\(\)/))));
  };
  
  /* Invoke the datepicker functionality.
     @param  options  string - a command, optionally followed by additional parameters or
                      Object - settings for attaching new datepicker functionality
     @return  jQuery object */
  $.fn.datepicker = function(options){
  	
  	/* Verify an empty collection wasn't passed - Fixes #6976 */
  	if ( !this.length ) {
  		return this;
  	}
  	
  	/* Initialise the date picker. */
  	if (!$.datepicker.initialized) {
  		$(document).mousedown($.datepicker._checkExternalClick).
  			find('body').append($.datepicker.dpDiv);
  		$.datepicker.initialized = true;
  	}
  
  	var otherArgs = Array.prototype.slice.call(arguments, 1);
  	if (typeof options == 'string' && (options == 'isDisabled' || options == 'getDate' || options == 'widget'))
  		return $.datepicker['_' + options + 'Datepicker'].
  			apply($.datepicker, [this[0]].concat(otherArgs));
  	if (options == 'option' && arguments.length == 2 && typeof arguments[1] == 'string')
  		return $.datepicker['_' + options + 'Datepicker'].
  			apply($.datepicker, [this[0]].concat(otherArgs));
  	return this.each(function() {
  		typeof options == 'string' ?
  			$.datepicker['_' + options + 'Datepicker'].
  				apply($.datepicker, [this].concat(otherArgs)) :
  			$.datepicker._attachDatepicker(this, options);
  	});
  };
  
  $.datepicker = new Datepicker(); // singleton instance
  $.datepicker.initialized = false;
  $.datepicker.uuid = new Date().getTime();
  $.datepicker.version = "1.8.24";
  
  // Workaround for #4055
  // Add another global to avoid noConflict issues with inline event handlers
  window['DP_jQuery_' + dpuuid] = $;
  
  })(jQuery);
  
  
  return module.exports;
}).call(this);;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-lib', location = 'streams-jira-plugin/dashboarditem/activity-stream/lib/ajs/ajs.date.js' */
!function(){function i(a,t){function r(t,e){return("000"+t).slice(-1*(e=e||2))}var i=Date.CultureInfo,e=t;if(t&&1===t.length){var n=i.formatPatterns;switch(t){case"d":e=n.shortDate;break;case"D":e=n.longDate;break;case"F":e=n.fullDateTime;break;case"m":e=n.monthDay;break;case"r":e=n.rfc1123;break;case"s":e=n.sortableDateTime;break;case"t":e=n.shortTime;break;case"T":e=n.longTime;break;case"u":e=n.universalSortableDateTime;break;case"y":e=n.yearMonth}}return e?e.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(t){if("\\"===t.charAt(0))return t.replace("\\","");var e=a.getHours();switch(t){case"hh":return r(e<13?0===e?12:e:e-12);case"h":return e<13?0===e?12:e:e-12;case"HH":return r(e);case"H":return e;case"mm":return r(a.getMinutes());case"m":return a.getMinutes();case"ss":return r(a.getSeconds());case"s":return a.getSeconds();case"yyyy":return r(a.getFullYear(),4);case"yy":return r(a.getFullYear());case"dddd":return i.dayNames[a.getDay()];case"ddd":return i.abbreviatedDayNames[a.getDay()];case"dd":return r(a.getDate());case"d":return a.getDate();case"MMMM":return i.monthNames[a.getMonth()];case"MMM":return i.abbreviatedMonthNames[a.getMonth()];case"MM":return r(a.getMonth()+1);case"M":return a.getMonth()+1;case"t":return(e<12?i.amDesignator:i.pmDesignator).substring(0,1);case"tt":return e<12?i.amDesignator:i.pmDesignator;case"S":return function(t){switch(+t){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}}(a.getDate());default:return t}}):a.toString()}var e=require("jira/util/formatter");AJS=AJS||{};AJS.Date=AJS.Date||{};var n="t",s="D";function m(t){return"gadget.activity.stream.time.today"===(t="gadget.activity.stream.time."+t)?"Today":"gadget.activity.stream.time.past.moment"===t?"Moments ago":"gadget.activity.stream.time.past.minute"===t?"1 minute ago":"gadget.activity.stream.time.past.minutes"===t?"{0} minutes ago":"gadget.activity.stream.time.past.hour"===t?"1 hour ago":"gadget.activity.stream.time.past.hours"===t?"{0} hours ago":"gadget.activity.stream.time.past.day"===t?"Yesterday":"gadget.activity.stream.time.past.dayWithTime"===t?"Yesterday at {0}":"gadget.activity.stream.time.past.days"===t?"{0} days ago":"gadget.activity.stream.time.past.weeks"===t?"{0} weeks ago":"gadget.activity.stream.time.past.year"===t?"More than a year ago":"gadget.activity.stream.time.datetime"===t?"{0} at {1}":t}function r(t){return t.getTime&&t.getTime()+60*t.getTimezoneOffset()}function g(t){var e=0;if(t){e+=60*(t=t.toString().match(/([-+])([0-9][0-9])([0-9][0-9])/))[2];e+=Number(t[3]);"-"===t[1]&&(e=-e)}return e}function c(t){return t&&"Invalid Date"!==t.toString()&&"NaN"!==t.toString()}function u(t,e){var a,r;if(c(t)&&e){a=(a=-10*(a=t).getTimezoneOffset()/6)<0?(r=(a-1e4).toString()).charAt(0)+r.substr(2):"+"+(r=(1e4+a).toString()).substr(1);t.setMilliseconds(t.getMilliseconds()+1e3*(a=a,g(e)-g(a)))}return t}function o(t,e){if(t instanceof Date)return t;var a=/([0-9])T([0-9])/,r=new Date(t);if(c(r))return u(r,e);t=(t=t.match(a)?t.replace(/\.[0-9]*/g,"").replace(/Z$/," -00:00").replace(a,"$1 $2"):t).replace(/([0-9]{4})-([0-9]{2})-([0-9]{2})/g,"$1/$2/$3").replace(/\s?([-\+][0-9]{2}):([0-9]{2})/," $1$2");return u(r=new Date(t||""),e)}function d(t,e){var a=(a=new Date(t))||o(t),a=(r(e=e||new Date)-r(a))/1e3;return isNaN(a)?null:a}function y(t){t=o(t);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)}function a(t,e,a){e=e||new Date;var r=o(t),t=d(r,e);if(null===t)return null;if(t<0)return AJS.format(m("datetime"),i(s),i(n));e=d(y(r),y(e))/86400;return r=r,t=t,a=a,0===(e=e)?a&&(t<60&&m("past.moment")||t<120&&m("past.minute")||t<3600&&AJS.format(m("past.minutes"),Math.floor(t/60))||t<7200&&m("past.hour")||t<86400&&AJS.format(m("past.hours"),Math.floor(t/3600)))||m("today"):1===e&&(a&&AJS.format(m("past.dayWithTime"),i(r,n))||m("past.day"))||e<7&&(a&&AJS.format(m("datetime"),i(r,"dddd"),i(r,n))||i(r,"dddd"))||e<365&&(a&&AJS.format(m("datetime"),i(r,"m"),i(r,n))||i(r,"m"))||365<=e&&(a&&i(r,s)||i(r,"y"))}AJS.Date.getFineRelativeDate=function(t,e){return a(t,e,!0)};AJS.Date.getCoarseRelativeDate=function(t,e){return a(t,e,!1)};AJS.Date.parse=o;AJS.Date.handleTimezoneOffset=u;AJS.Date.setDateFormat=function(t){s=t||s};AJS.Date.setTimeFormat=function(t){n=t?t.replace(/a/g,"tt").replace(/'(\w+)'/g,"\\$1"):n}}();;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-lib', location = 'streams-jira-plugin/dashboarditem/activity-stream/lib/ajs/ajs.json.js' */
AJS.json||(AJS.json={});!function(){function f(t){return t<10?"0"+t:t}if("function"!=typeof Date.prototype.toJSON){Date.prototype.toJSON=function(t){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(t){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){escapable.lastIndex=0;return escapable.test(t)?'"'+t.replace(escapable,function(t){var e=meta[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,e){var n,r,o,f,u,i=gap,a=e[t];a&&"object"==typeof a&&"[object Array]"!==Object.prototype.toString.apply(a)&&"function"==typeof a.toJSON&&(a=a.toJSON(t));switch(typeof(a="function"==typeof rep?rep.call(e,t,a):a)){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent;u=[];if("[object Array]"===Object.prototype.toString.apply(a)){f=a.length;for(n=0;n<f;n+=1)u[n]=str(n,a)||"null";o=0===u.length?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+i+"]":"["+u.join(",")+"]";gap=i;return o}if(rep&&"object"==typeof rep){f=rep.length;for(n=0;n<f;n+=1)"string"==typeof(r=rep[n])&&(o=str(r,a))&&u.push(quote(r)+(gap?": ":":")+o)}else for(r in a)Object.hasOwnProperty.call(a,r)&&(o=str(r,a))&&u.push(quote(r)+(gap?": ":":")+o);o=0===u.length?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+i+"}":"{"+u.join(",")+"}";gap=i;return o}}"function"!=typeof AJS.json.stringify&&(AJS.json.stringify=function(t,e,n){var r;indent=gap="";if("number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if((rep=e)&&"function"!=typeof e&&("object"!=typeof e||"number"!=typeof e.length))throw new Error("AJS.json.stringify");return str("",{"":t})});"function"!=typeof AJS.json.parse&&(AJS.json.parse=function(text,reviver){var j;function walk(t,e){var n,r,o=t[e];if(o&&"object"==typeof o)for(n in o)Object.hasOwnProperty.call(o,n)&&(void 0!==(r=walk(o,n))?o[n]=r:delete o[n]);return reviver.call(t,e,o)}cx.lastIndex=0;cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return"function"==typeof reviver?walk({"":j},""):j}throw new SyntaxError("AJS.json.parse")})}();;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-lib', location = 'streams-jira-plugin/dashboarditem/activity-stream/lib/atom/jatom.js' */
function jAtom(t){function r(t){var a={};t.find("> link").each(function(){var t=AJS.$(this),e=t.attr("rel"),i=t.attr("href"),t=a[e]||[];t.push(i);a[e]=t});return a}function s(t,e,i,a){i=t.find(e+i+"\\:"+a);return i=0==i.length?t.find(e+a):i}return function(t){var a,e=AJS.$("feed:first",t),n={version:"1.0",title:e.find("> title").text(),self:e.find('> link[rel="self"]').attr("href"),description:e.find("> subtitle").text(),language:e.attr("xml:lang"),updated:e.find("> updated").text(),timezoneOffset:s(e,"> ","atlassian","timezone-offset").text(),timedOutSources:AJS.$.makeArray(s(e,"> ","atlassian","timed-out-source-list").children().map(function(){return AJS.$(this).text()})),bannedSourceMessages:function(t){var i=[];s(t,">","atlassian","activity-source").each(function(){var t=AJS.$(this),e={};t[0]&&t[0].childNodes[0]&&(e.provider=t[0].childNodes[0].textContent);e.expiryTime=s(t,">","atlassian","expiry-time").text();i.push(e)});return i}(s(e,"> ","atlassian","banned-source-list")),links:r(e),authMessages:function(t){var i=[];s(t,">","atlassian","authorisation-message").each(function(){var t=AJS.$(this),e={id:"",appName:"",appUri:"",authUri:""};e.id=AJS.$.trim(s(t,">","atlassian","application-id").text());e.appName=s(t,">","atlassian","application-name").text();e.appUri=AJS.$.trim(s(t,">","atlassian","application-uri").text());e.authUri=AJS.$.trim(s(t,">","atlassian","authorisation-uri").text());i.push(e)});return i}(e),items:new Array};AJS.$("entry",t).each(function(){var t,e={authors:new Array,title:"",links:{},timedOutSources:[],summary:"",content:"",updated:"",timezoneOffset:"",id:"",category:"",type:"",generator:""},i=AJS.$(this);e.title=i.find("> title").text();e.links=r(i);e.iconTitle=i.find('> link[rel="http://streams.atlassian.com/syndication/icon"]').attr("title");e.summary=i.find("> summary").text();e.content=i.find("> content").text();e.updated=i.find("> updated").text();e.timezoneOffset=s(i,">","atlassian","timezone-offset").text();e.id=i.find("> id").text();e.category=i.find("> category").attr("term");e.generator=i.find("> generator").attr("uri");t=s(i,">","activity","object");0==(a=s(t,">","activity","object-type").text()).indexOf("http://streams.atlassian.com/syndication/types/")?e.type=a.substring("http://streams.atlassian.com/syndication/types/".length,a.length):0==a.indexOf("http://activitystrea.ms/schema/1.0/")?e.type=a.substring("http://activitystrea.ms/schema/1.0/".length,a.length):e.type=a;t.length&&(e.object={id:t.find("> id").text(),link:t.find("> link").attr("href"),type:s(t,">","activity","object-type").text()});(t=s(i,">","activity","target")).length&&(e.target={id:t.find("> id").text(),title:t.find("> title").text(),summary:t.find("> summary").text(),link:t.find("> link").attr("href"),type:s(t,">","activity","object-type").text()});e.application=s(i,">","atlassian","application").text();e.verb=s(i,">","activity","verb").text();i.find("author").each(function(){e.authors.push(function(t){var e,i,a={name:"",email:"",uri:"",username:"",photos:""};t=AJS.$(t);a.name=t.find("> name").text();a.email=t.find("> email").text();a.uri=t.find("> uri").text();a.username=s(t,">","usr","username").text();if(i=(e=t.find("> link[rel='photo']")).length){a.photos=[];for(var n=0;n<i;n++){var r=AJS.$(e[n]);a.photos.push({uri:r.attr("href"),width:r.attr("media:width"),height:r.attr("media:height")})}}return a}(this))});n.items.push(e)});return n}(function(e){if("string"!=typeof e)return e;try{var t=new ActiveXObject("Microsoft.XMLDOM");t.async=!1;t.loadXML(e);return t}catch(t){AJS.log("Failed to create an xml object from string: "+t);return e}}(t))};
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-lib', location = 'streams-jira-plugin/dashboarditem/activity-stream/lib/chosen/chosen.jquery.js' */
!function(){function i(t,e){return function(){return t.apply(e,arguments)}}var r,s,h=this,g=jQuery;g.fn.extend({chosen:function(s){return g(this).each(function(t){var e=g(this),i=e.data("chosen");if(!i){i=new r(this,s);return e.data("chosen",i)}})},unchosen:function(){return g(this).each(function(t){var e=g(this),i=e.data("chosen");if(i){i.remove();return e.data("chosen",null)}})}});r=function(){function t(t,e){this.settings={defaultText:"Select some options",defaultTextSingle:"Select an option",noResultsText:'No results match "{0}"'};g.extend(this.settings,e);this.set_default_values();this.form_field=t;this.form_field_jq=g(this.form_field).addClass("chosen-active");this.is_multiple=this.form_field.multiple;this.is_rtl=this.form_field_jq.hasClass("chzn-rtl");this.default_text_default=this.form_field.multiple?this.settings.defaultText:this.settings.defaultTextSingle;this.set_up_html();this.register_observers()}t.prototype.set_default_values=function(){this.click_test_action=i(function(t){return this.test_active_click(t)},this);this.active_field=!1;this.mouse_on_container=!1;this.results_showing=!1;this.result_highlighted=null;this.result_single_selected=null;return this.choices=0};t.prototype.set_up_html=function(){this.container_id=this.form_field.id.length?this.form_field.id.replace(/(:|\.)/g,"_"):this.generate_field_id();this.container_id+="_chzn";this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default;this.container=g("<div />",{id:this.container_id,class:"chzn-container "+(this.is_rtl?"chzn-rtl":"")});this.is_multiple?this.container.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):this.container.html('<a href="javascript:void(0)" class="chzn-single"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>');this.form_field_jq.hide().after(this.container);this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single"));this.dropdown=this.container.find("div.chzn-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chzn-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chzn-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chzn-search").first();this.selected_item=this.container.find(".chzn-single").first()}this.results_build();return this.set_tab_index()};t.prototype.register_observers=function(){this.dispatcher=g({});this.container.click(i(function(t){return this.container_click(t)},this));this.container.mouseenter(i(function(t){return this.mouse_enter(t)},this));this.container.mouseleave(i(function(t){return this.mouse_leave(t)},this));this.search_results.click(i(function(t){return this.search_results_click(t)},this));this.search_results.mouseover(i(function(t){return this.search_results_mouseover(t)},this));this.search_results.mouseout(i(function(t){return this.search_results_mouseout(t)},this));this.form_field_jq.bind("liszt:updated",i(function(t){return this.results_update_field(t)},this));this.search_field.blur(i(function(t){return this.input_blur(t)},this));this.search_field.keyup(i(function(t){return this.keyup_checker(t)},this));this.search_field.keydown(i(function(t){return this.keydown_checker(t)},this));if(this.is_multiple){this.search_choices.click(i(function(t){return this.choices_click(t)},this));return this.search_field.focus(i(function(t){return this.input_focus(t)},this))}return this.selected_item.focus(i(function(t){return this.activate_field(t)},this))};t.prototype.unregister_observers=function(){return this.form_field_jq.unbind("liszt:updated")};t.prototype.remove_html=function(){this.form_field_jq.show();return this.container.remove()};t.prototype.trigger=function(){this.dispatcher.trigger.apply(this.dispatcher,arguments);return this};t.prototype.bind=function(){this.dispatcher.bind.apply(this.dispatcher,arguments);return this};t.prototype.container_click=function(t){t&&"click"===t.type&&t.stopPropagation();if(this.pending_destroy_click)return this.pending_destroy_click=!1;if(this.active_field){if(!this.is_multiple&&t&&(g(t.target)===this.selected_item||g(t.target).parents("a.chzn-single").length)){t.preventDefault();this.results_toggle()}}else{this.is_multiple&&this.search_field.val("").attr("title",null);g(document).click(this.click_test_action);this.results_show()}return this.activate_field()};t.prototype.mouse_enter=function(){return this.mouse_on_container=!0};t.prototype.mouse_leave=function(){return this.mouse_on_container=!1};t.prototype.input_focus=function(t){if(!this.active_field)return setTimeout(i(function(){return this.container_click()},this),50)};t.prototype.input_blur=function(t){if(!this.mouse_on_container){this.active_field=!1;return setTimeout(i(function(){return this.blur_test()},this),100)}};t.prototype.blur_test=function(t){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()};t.prototype.close_field=function(){g(document).unbind("click",this.click_test_action);if(!this.is_multiple){this.selected_item.attr("tabindex",this.search_field.attr("tabindex"));this.search_field.attr("tabindex",-1)}this.active_field=!1;this.results_hide();this.trigger("hide");this.container.removeClass("chzn-container-active");this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};t.prototype.activate_field=function(){if(!this.is_multiple&&!this.active_field){this.search_field.attr("tabindex",this.selected_item.attr("tabindex"));this.selected_item.attr("tabindex",-1)}this.trigger("show");this.container.addClass("chzn-container-active");this.active_field=!0;this.search_field.val(this.search_field.val());return this.search_field.focus()};t.prototype.test_active_click=function(t){return g(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()};t.prototype.results_build=function(){var t,e,i,s,r;new Date;this.parsing=!0;this.results_data=h.SelectParser.select_to_array(this.form_field);if(this.is_multiple&&0<this.choices){this.search_choices.find("li.search-choice").remove();this.choices=0}else this.is_multiple||this.selected_item.find("span").text(this.default_text);t="";for(i=0,s=(r=this.results_data).length;i<s;i++)if((e=r[i]).group)t+=this.result_add_group(e);else if(!e.empty){t+=this.result_add_option(e);e.selected&&this.is_multiple?this.choice_build(e):e.selected&&!this.is_multiple&&this.selected_item.find("span").text(e.text)}this.show_search_field_default();this.search_field_scale();this.search_results.html(t);return this.parsing=!1};t.prototype.result_add_group=function(t){if(t.disabled)return"";t.dom_id=this.container_id+"_g_"+t.array_index;return'<li id="'+t.dom_id+'" class="group-result">'+g("<div />").text(t.label).html()+"</li>"};t.prototype.result_add_option=function(t){var e;if(t.disabled)return"";t.dom_id=this.container_id+"_o_"+t.array_index;e=t.selected&&this.is_multiple?[]:["active-result"];t.selected&&e.push("result-selected");null!=t.group_array_index&&e.push("group-option");return'<li id="'+t.dom_id+'" class="'+e.join(" ")+'">'+t.html+"</li>"};t.prototype.results_update_field=function(){this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};t.prototype.result_do_highlight=function(t){var e,i,s;if(t.length){this.result_clear_highlight();this.result_highlight=t;this.result_highlight.addClass("highlighted");return(i=parseInt(this.search_results.css("maxHeight"),10))+(s=this.search_results.scrollTop())<=(t=(e=this.result_highlight.position().top+this.search_results.scrollTop())+this.result_highlight.outerHeight())?this.search_results.scrollTop(0<t-i?t-i:0):e<s?this.search_results.scrollTop(e):void 0}};t.prototype.result_clear_highlight=function(){this.result_highlight&&this.result_highlight.removeClass("highlighted");return this.result_highlight=null};t.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()};t.prototype.results_show=function(){var t,e;if(!this.is_multiple){this.selected_item.addClass("chzn-single-with-drop");this.result_single_selected&&this.result_do_highlight(this.result_single_selected)}t=this.is_multiple?this.container.height():this.container.height()-1;e=this.container.outerWidth()-s(this.dropdown);this.dropdown.css({width:e+"px",top:t,left:0});this.container.addClass("chzn-showing");s(this.search_container);this.results_showing=!0;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};t.prototype.results_hide=function(){this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop");this.result_clear_highlight();this.dropdown.css({left:"-9000px"});this.container.removeClass("chzn-showing");return this.results_showing=!1};t.prototype.set_tab_index=function(t){var e;if(this.form_field_jq.attr("tabindex")){e=this.form_field_jq.attr("tabindex");this.form_field_jq.attr("tabindex",-1);if(this.is_multiple)return this.search_field.attr("tabindex",e);this.selected_item.attr("tabindex",e);return this.search_field.attr("tabindex",-1)}};t.prototype.reset_tab_index=function(){if(this.search_field.tabIndex){this.form_field_jq.tabIndex=this.search_field.tabIndex;return this.search_field.tabIndex=-1}};t.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?this.search_field.val(this.default_text).attr("title",this.default_text).addClass("default"):this.search_field.val("").attr("title",null).removeClass("default")};t.prototype.search_results_click=function(t){t=g(t.target).hasClass("active-result")?g(t.target):g(t.target).parents(".active-result").first();if(t.length){this.result_highlight=t;return this.result_select()}};t.prototype.search_results_mouseover=function(t){t=g(t.target).hasClass("active-result")?g(t.target):g(t.target).parents(".active-result").first();if(t)return this.result_do_highlight(t)};t.prototype.search_results_mouseout=function(t){if(g(t.target).hasClass("active-result"))return this.result_clear_highlight()};t.prototype.choices_click=function(t){t.preventDefault();return(t=g(t.target).parents(".search-choice")).length?this.focus_choice(t):this.active_field&&!this.results_showing?this.results_show():void 0};t.prototype.choice_build=function(t){var e=this.container_id+"_c_"+t.array_index;this.choices+=1;this.search_container.before('<li class="search-choice" id="'+e+'" title="'+t.html+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>');this.search_container.parent().find("#"+e).find("a").first().click(i(function(t){return this.choice_destroy_link_click(t)},this));return this.clear_backstroke()};t.prototype.choice_destroy_link_click=function(t){t.preventDefault();this.pending_destroy_click=!0;return this.choice_destroy(g(t.target))};t.prototype.choice_destroy=function(t){--this.choices;this.show_search_field_default();this.is_multiple&&0<this.choices&&this.search_field.val().length<1&&this.results_hide();this.result_deselect(t.attr("rel"));t.parents("li").first().remove();return this.search_field.focus()};t.prototype.result_select=function(){var t,e;if(this.result_highlight){e=(t=this.result_highlight).attr("id");this.result_clear_highlight();t.addClass("result-selected");this.is_multiple?this.result_deactivate(t):this.result_single_selected=t;e=e.substr(e.lastIndexOf("_")+1);(e=this.results_data[e]).selected=!0;this.form_field.options[e.options_index].selected=!0;this.is_multiple?this.choice_build(e):this.selected_item.find("span").first().text(e.text);this.results_hide();this.search_field.val("").attr("title",null);this.form_field_jq.trigger("change");return this.search_field_scale()}};t.prototype.result_activate=function(t){return t.addClass("active-result").show()};t.prototype.result_deactivate=function(t){return t.removeClass("active-result").hide()};t.prototype.result_deselect=function(t){var e=this.results_data[t];e.selected=!1;this.form_field.options[e.options_index].selected=!1;g("#"+this.container_id+"_o_"+t).removeClass("result-selected").addClass("active-result").show();this.result_clear_highlight();this.winnow_results();this.form_field_jq.trigger("change");return this.search_field_scale()};t.prototype.results_search=function(t){return this.results_showing?this.winnow_results():this.results_show()};t.prototype.winnow_results=function(){var t,e,i,s,r,h,l,n,o,a,c,u,_,d,f,p;new Date;this.no_results_clear();l=0;n=this.search_field.val()===this.default_text?"":g("<div/>").text(g.trim(this.search_field.val())).html();r=new RegExp("^"+n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");c=new RegExp(n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i");for(u=0,d=(p=this.results_data).length;u<d;u++)if(!(e=p[u]).disabled&&!e.empty)if(e.group)g("#"+e.dom_id).hide();else if(!this.is_multiple||!e.selected){t=!1;h=e.dom_id;if(r.test(e.html)){t=!0;l+=1}else if((0<=e.html.indexOf(" ")||0===e.html.indexOf("["))&&(s=e.html.replace(/\[|\]/g,"").split(" ")).length)for(_=0,f=s.length;_<f;_++){i=s[_];if(r.test(i)){t=!0;l+=1}}if(t){if(n.length){o=e.html.search(c);a=(a=e.html.substr(0,o+n.length)+"</em>"+e.html.substr(o+n.length)).substr(0,o)+"<em>"+a.substr(o)}else a=e.html;g("#"+h).html!==a&&g("#"+h).html(a);this.result_activate(g("#"+h));null!=e.group_array_index&&g("#"+this.results_data[e.group_array_index].dom_id).show()}else{this.result_highlight&&h===this.result_highlight.attr("id")&&this.result_clear_highlight();this.result_deactivate(g("#"+h))}}return l<1&&n.length?this.no_results(n):this.winnow_results_set_highlight()};t.prototype.winnow_results_clear=function(){var t,e,i,s,r;this.search_field.val("");r=[];for(i=0,s=(e=this.search_results.find("li")).length;i<s;i++){t=e[i];t=g(t);r.push(t.hasClass("group-result")?t.show():this.is_multiple&&t.hasClass("result-selected")?void 0:this.result_activate(t))}return r};t.prototype.winnow_results_set_highlight=function(){var t;if(!this.result_highlight&&null!=(t=((t=this.is_multiple?[]:this.search_results.find(".result-selected")).length?t:this.search_results.find(".active-result")).first()))return this.result_do_highlight(t)};t.prototype.no_results=function(t){return this.search_results.append(g(('<li class="no-results">'+this.settings.noResultsText+"</li>").replace("{0}",t)))};t.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};t.prototype.remove=function(){this.reset_tab_index();this.unregister_observers();this.remove_html();return this.form_field_jq.removeClass("chosen-active")};t.prototype.keydown_arrow=function(){var t;this.result_highlight?this.results_showing&&(t=this.result_highlight.nextAll("li.active-result").first())&&this.result_do_highlight(t):(t=this.search_results.find("li.active-result").first())&&this.result_do_highlight(g(t));if(!this.results_showing)return this.results_show()};t.prototype.keyup_arrow=function(){var t;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight){if((t=this.result_highlight.prevAll("li.active-result")).length)return this.result_do_highlight(t.first());0<this.choices&&this.results_hide();return this.result_clear_highlight()}};t.prototype.keydown_backstroke=function(){if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}return this.focus_choice(this.search_container.siblings("li.search-choice").last())};t.prototype.clear_backstroke=function(){this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus");return this.pending_backstroke=null};t.prototype.focus_choice=function(t){this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus");return this.pending_backstroke=t.addClass("search-choice-focus")};t.prototype.keyup_checker=function(t){var e=null!=(e=t.which)?e:t.keyCode;this.search_field_scale();switch(e){case 8:if(this.is_multiple&&this.backstroke_length<1&&0<this.choices)return this.keydown_backstroke();if(this.pending_backstroke)break;this.result_clear_highlight();return this.results_search();case 13:t.preventDefault();if(this.results_showing)return this.result_select();break;case 27:if(this.results_showing)return this.results_hide();break;case 9:case 38:case 40:case 16:break;default:return this.results_search()}};t.prototype.keydown_checker=function(t){var e=null!=(e=t.which)?e:t.keyCode;this.search_field_scale();8!==e&&this.pending_backstroke&&this.clear_backstroke();switch(e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.mouse_on_container=!1;break;case 13:t.preventDefault();break;case 38:t.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow()}};t.prototype.search_field_scale=function(){var t,e,i,s,r,h,l;if(this.is_multiple){i="position:absolute; left: -1000px; top: -1000px; display:none;";for(h=r=0,l=(s=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"]).length;h<l;h++)i+=(e=s[h])+":"+this.search_field.css(e)+";";(t=g("<div />",{style:i})).text(this.search_field.val());g("body").append(t);r=t.width()+25;t.remove();r>this.f_width-10&&(r=this.f_width-10);this.search_field.css({width:r+"px"});r=this.container.height();return this.dropdown.css({top:r+"px"})}};t.prototype.generate_field_id=function(){var t=this.generate_random_id();return this.form_field.id=t};t.prototype.generate_random_id=function(){for(var t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();0<g("#"+t).length;)t+=this.generate_random_char();return t};t.prototype.generate_random_char=function(){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZ",e=Math.floor(Math.random()*t.length);return t.substring(e,e+1)};return t}();s=function(t){return t.outerWidth()-t.width()};h.get_side_border_padding=s}.call(this);!function(){var l=function(){function t(){this.options_index=0;this.parsed=[]}t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName?this.add_group(t):this.add_option(t)};t.prototype.add_group=function(t){var e,i,s,r,h,l=this.parsed.length;this.parsed.push({array_index:l,group:!0,label:t.label,children:0,disabled:t.disabled});h=[];for(i=0,s=(r=t.childNodes).length;i<s;i++){e=r[i];h.push(this.add_option(e,l,t.disabled))}return h};t.prototype.add_option=function(t,e,i){if("OPTION"===t.nodeName){if(""!==t.text){null!=e&&(this.parsed[e].children+=1);this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,html:t.innerHTML,selected:t.selected,disabled:!0===i?i:t.disabled,group_array_index:e})}else this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0});return this.options_index+=1}};return t}();l.select_to_array=function(t){for(var e,i=new l,s=t.childNodes,r=0,h=s.length;r<h;r++){e=s[r];i.add_node(e)}return i.parsed};this.SelectParser=l}.call(this);;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-lib', location = 'streams-jira-plugin/dashboarditem/activity-stream/lib/external/jquery.waitforimages.js' */
!function(u){u.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]};u.expr[":"].uncached=function(e){return u(e).is('img[src!=""]')&&!e.complete};u.fn.waitForImages=function(o,l,r){if(u.isPlainObject(arguments[0])){l=o.each;r=o.waitForAll;o=o.finished}o=o||u.noop;l=l||u.noop;r=!!r;if(!u.isFunction(o)||!u.isFunction(l))throw new TypeError("An invalid callback was supplied.");return this.each(function(){var i=u(this),c=[];if(r){var e=u.waitForImages.hasImageProperties||[],t=/url\((['"]?)(.*?)\1\)/g;i.find("*").each(function(){var a=u(this);a.is("img:uncached")&&c.push({src:a.attr("src"),element:a[0]});u.each(e,function(e,r){var n,i=a.css(r);if(!i)return!0;for(;n=t.exec(i);)c.push({src:n[2],element:a[0]})})})}else i.find("img:uncached").each(function(){c.push({src:this.src,element:this})});var a=c.length,s=0;0==a&&o.call(i[0]);u.each(c,function(e,r){var n=new Image;u(n).bind("load error",function(e){s++;l.call(r.element,s,a,"load"==e.type);if(s==a){o.call(i[0]);return!1}});n.src=r.src})})}}(jQuery);;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-lib', location = 'streams-jira-plugin/dashboarditem/activity-stream/js/gadget-util.js' */
"use strict";define("jira-dashboard-items/gadget-util",[],function(){var i={0:!1,10:!0,13:!0,34:!0,39:!0,60:!0,62:!0,92:!0,8232:!0,8233:!0},s=function(e,s){return String.fromCharCode(s)};return{escapeString:function(e){for(var s,a,n=[],r=0,t=e.length;r<t;++r){s=e.charCodeAt(r);!0===(a=i[s])?n.push("&#",s,";"):!1!==a&&n.push(e.charAt(r))}return n.join("")},unescapeString:function(e){return e.replace(/&#([0-9]+);/g,s)},makeMessageCloseable:function(e){AJS.messages&&AJS.messages.makeClosable||e.each(function(e){var s=AJS.$(this),a=AJS.$('<span class="aui-icon icon-close"></span>');a.click(function(){s.trigger("messageClose",[this]).remove()});s.append(a);s.addClass("closeable")})}}});;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-applinks', location = 'streams-jira-plugin/dashboarditem/activity-stream/js/activity-stream-applinks.js' */
var ActivityStreamsApplinks=ActivityStreamsApplinks||function(){var s={},u=require("jira-dashboard-items/gadget-util");formatter=require("jira/util/formatter");var n="com_atlassian_applinks_authentication",t=/[&"'<>]/g,i={AUTH_APPROVED_LISTENERS:"AUTH_APPROVED_LISTENERS",APPLINKS_AUTH_COMPLETION_LISTENERS:"APPLINKS_AUTH_COMPLETION_LISTENERS"},r={AUTH_APPROVED_LISTENERS:{},APPLINKS_AUTH_COMPLETION_LISTENERS:{}};function a(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&#39;";default:return"&quot;"}}function o(e){return e.replace(t,a)}function p(e,t,a,n,i){if(t in s){var r=s[t];if(a){r.authAdminUri=n;delete s[t]}!function(t,e){var a=AJS.$(document);if(e){e=function(e){e.isDefaultPrevented()&&function(e){var t=AJS.$(document),a=AJS.$('<div class="aui-message success closeable shadowed applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),n=t.find("div.applinks-auth-confirmation-container");n.length||(n=t.find("body"));a.append(AJS.format("This application is now using \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\"\u003eOAuth access tokens\u003c/a\u003e.",o(e.appUri),o(e.appName),o(e.authAdminUri)));u.makeMessageCloseable(a);n.prepend(a);var i=AJS.$(".applinks-auth-confirmation",n);setTimeout(function(){i.fadeOut(1e3,function(){AJS.$(this).remove()})},5e3)}(t)};a.bind("applinks.auth.approved",e);a.trigger("applinks.auth.approved",t);a.unbind("applinks.auth.approved",e)}else a.trigger("applinks.auth.denied",t)}(r,a)}}AJS.$(document).ready(function(){for(var e="AUTH_COMPLETION_BANNER",t=c(i.APPLINKS_AUTH_COMPLETION_LISTENERS,e),a=0;a<t.length;a++)AJS.$(document).unbind("applinks.auth.completion",t[a]);l(i.APPLINKS_AUTH_COMPLETION_LISTENERS,e);AJS.$(document).bind("applinks.auth.completion",p);d(i.APPLINKS_AUTH_COMPLETION_LISTENERS,e,p)});function c(e,t){return r[e][t]||[]}function d(e,t,a){Array.isArray(r[e][t])||(r[e][t]=[]);r[e][t].push(a)}function l(e,t){r[e][t]=[]}return{createAuthRequestBanner:function(e){var t=AJS.$("<li></li>");t.append(AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eAuthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",o(e.authUri),o(e.appUri),o(e.appName)));!function(e,t){var a=e.find("a.applink-authenticate");e.hasClass("aui-message")&&u.makeMessageCloseable(e);a.click(function(e){window.open(t.authUri,n);e.preventDefault()});s[t.id]=t}(t,e);return t},LISTENERS_KEYS:i,getListeners:c,registerListener:d,unRegisterListeners:l}}();;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-js', location = 'streams-jira-plugin/dashboarditem/activity-stream/js/ActivityStreamDate.js' */
"use strict";define("jira-dashboard-items/activitystream-date",["jquery"],function(e){var a={dateFormat:"",dateTimeFormat:"",timeFormat:""};return{getDatePrefs:()=>dateprefs,getDateFormat:()=>a.dateFormat,getDateTimeFormat:()=>a.dateTimeFormat,getTimeFormat:()=>a.timeFormat,getDateRelativize:()=>a.dateRelativize,setDatePrefs:function(t){e.extend(a,t);AJS.Date.setTimeFormat(a.timeFormat)}}});;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-js', location = 'streams-jira-plugin/dashboarditem/activity-stream/js/activity-stream.js' */
var ActivityStreams=ActivityStreams||{};AJS.EventQueue=AJS.EventQueue||[];var wrmContextPath=require("wrm/context-path"),gadgetUtil=require("jira-dashboard-items/gadget-util");ActivityStreams.handleSpecialCases=function(e){var t=e.value,a=e.operator,e=e.type;if(AJS.$.isArray(t)){for(var i=[],s=0,r=t.length;s<r;s++)i.push(t[s].replace(/_/g,"\\_").replace(/ /g,"_"));t=i.join(" ")}if("date"===e){if(-1!==(t=function(e,t){e+="";var a;t=t.toUpperCase();e=-1!==e.indexOf(" ")?e.split(" "):[e];"BETWEEN"===t&&1===e.length&&(e[1]=e[0]);for(var i=0;i<e.length;i++){a=parseInt(e[i]);("AFTER"===t||"BETWEEN"===t&&1===i)&&(a+=864e5-1);e[i]=a}return e.join(" ")}(t,a="is"===a?"between":a)).indexOf("NaN"))return{}}else"list"!==e&&"user"!==e||(t=(t=t.replace(/,/g," ")).replace(/_/g,"\\_"));return{value:t,operator:a}};ActivityStreams.stream=function(e){var S,a="/plugins/servlet/streams",r=require("jira-dashboard-items/gadget-util"),o=require("jira-dashboard-items/activitystream-date"),T=require("jira/util/formatter"),w=require("jquery"),n=e.preferences,C=e.metrics,i=e.id,b=e.gadgetElement,s=e.baseUrl||"",l=e.container,x=e.loaded||function(){},k=e.resized||function(){},c="true"===n.isReallyConfigured,d=!e.hideHeader,u=n.renderingContext,v=e.maxResults&&parseInt(e.maxResults)||25,I={maxResults:v},m=e.title,p={numofentries:n.numofentries,refresh:n.refresh,rules:function(){var e=n.rules;if(e)return(e=function(e){return e?AJS.json.parse(unescape(e.replace(/&#34;/g,'"'))):void 0}(e))&&e.providers;return""}()},f=0;function h(e){var t=s+a;t+=-1==t.indexOf("?")?"?":"&";return t+=w.param(e)}function g(){return w('<a href="#" id="activity-stream-feed" target="_top"></a>').attr("aria-label","Feed")}function E(e){var t=w('<div class="applinks-auth-messages"></div>'),a=w('<div class="aui-message warning closeable shadowed applinks-auth-request"></div>');a.append(function(){var e=w('<p><span class="aui-icon icon-applinks-key"></span></p>');e.append("Additional information may be available, please authenticate for more information:");return e}());a.append(function(e){for(var t=w("<ul></ul>"),a=0,i=e.length;a<i;a++){var s=e[a],s=ActivityStreamsApplinks.createAuthRequestBanner(s);t.append(s)}return t}(e));gadgetUtil.makeMessageCloseable(a);t.append(a);return t}function y(e,t,a){var i=w('<div class="activity-item-info"></div>'),s=ActivityStreams.getActions(e.type),r=e.links["http://streams.atlassian.com/syndication/icon"],n=e.links.alternate;r&&w('<img class="icon" height="16" width="16" alt="">').attr({src:r,alt:e.iconTitle,title:e.iconTitle}).appendTo(i);(r=n?w("<a></a>").attr("href",n):w("<span></span>")).addClass("livestamp timestamp").text(t||"");if("function"==typeof moment){a=moment(a).utcOffset(e.timezoneOffset);r.attr("datetime",a.format()).attr("title",a.format("LLL"))}r.appendTo(i);o.getDateRelativize()&&r.data("relativize",!0);n&&w('<input type="hidden" class="activity-item-link">').attr("value",n).appendTo(i);s&&"view-issue"!==u&&!function(e,t){for(var a=w('<div class="activity-item-actions"></div>'),i=w('<span class="activity-item-action"></span>'),s=0,r=t.length;s<r;s++){var n=t[s](e);n&&n.clone&&i.clone().append(n.clone(!0)).appendTo(a)}return a}(e,s).appendTo(i);w('<div class="activity-item-action-status-container hidden">').appendTo(i);return i}function A(){var e,t=function(e){if(e=n[e]){for(var t=e.split("|"),a=r.escapeString,i=0,s=t.length;i<s;++i)t[i]=a(t[i].replace(/%7C/g,"|"));return t}return[]}("keys"),a=n.username,i=n.itemKeys;t&&t.length&&(e={keys:t});a&&((e=e||{}).username=a);i&&((e=e||{}).itemKeys=i);return e}function R(){for(var e={maxResults:I.maxResults,relativeLinks:!0},t=p.rules||[],a=[],i=0,s=t.length;i<s;i++){var r=t[i],n=r.provider,o=r.rules,l=[];if(!r.disabled){"streams"!==n&&a.push(n);for(var c=0,d=o.length;c<d;c++){var u=o[c],v=ActivityStreams.handleSpecialCases(u),m=v.operator,v=v.value;m&&v&&l.push([u.rule,m.toUpperCase(),v].join(" "))}e[n]=l}}a.length<t.length-1&&(e.providers=a.join(" "));return e}function D(){var e=AJS.Cookie.read("streams.view."+i)||"full-view",t=w('<div class="activity-stream-container"></div>').addClass(e);if(d)t.append(function(e){var t=w('<div class="activity-stream-header"></div>'),a=w('<div class="activity-stream-title-container"></div>').appendTo(t);w('<h3 id="stream-title"></h3>').text(e).appendTo(a);w('<div class="activity-stream-views"></div>').attr("aria-label","Select view").append(w("<ul></ul>").attr("role","radiogroup").attr("aria-label","Select full or list view").append(w("<li></li>").append(w('<button class="activity-stream-view full-view-icon"></button>').attr("role","radio").attr("aria-label","Full view"))).append(w("<li></li>").append(w('<button class="activity-stream-view list-view-icon"></button>').attr("role","radio").attr("aria-label","List view")))).append(g()).appendTo(t);w('<div class="clearer"></div>').appendTo(t);return t}(m));else{t.append(w('<div class="activity-stream-sparse-header"></div>').append(g()).append('<div class="throbber-placeholder"></div>').append('<div class="clearer"></div>'));b.addClass("no-title")}c||function(){if(!(p&&p.rules&&-1!==p.rules.findIndex(function(e){return"streams"===e.provider&&e.rules&&e.rules.length}))){var a,i,e=A();if(e){a={keys:"key",username:"user",itemKeys:"issue-key"};w.each(e,function(e,t){i=i||[];"__all_projects__"!==t&&i.push({rule:a[e],operator:"is",value:t})});if(i&&i.length){e=[{provider:"streams",rules:i}];AJS.json.stringify({providers:e});p.rules=e}c=!0}}}();w('<div id="filter-options"></div>').appendTo(t);w('<div class="blanket-container"></div>').append(w('<div class="applinks-auth-confirmation-container"></div>')).append(w('<div id="activity-stream"></div>')).append(function(){var e="Show more activities",e=w(`<a href="#" id="activity-stream-show-more" aria-label="${e}" class="hidden"></a>`).click(function(e){e.preventDefault();e=w("#activity-stream-show-more",b);e.addClass("loading");e.attr("data-clicked",!0);I.maxResults=parseInt(I.maxResults)+v;j()});w("<span></span>").text("Show more...").appendTo(e);return e}()).append((e=aui.message.hint({content:T.format("Activity Streams is limited to displaying up to {0} days of Jira issue activity.",180)}),w('<div id="activity-stream-issue-date-limit-info" class="hidden"/>').html(e))).appendTo(t).append(function(){var e=w('<a href="#" id="activity-stream-opt-in-slow-query" class="hidden"></a>').click(function(e){e.preventDefault();w("#activity-stream-opt-in-slow-query",b).addClass("loading");f++;O(h(Object.assign({},R(),{timeoutRetryCount:f})))});w("<span></span>").text("Retry with extended timeout limit").appendTo(e);return e}());z();return t}function J(e,t,a){e=function(e){var t,a=e.now||AJS.Date.handleTimezoneOffset(new Date),i=w('<li class="activity-item"></li>'),s=AJS.Date.getFineRelativeDate(e.date||AJS.Date.parse(e.updated,e.timezoneOffset),a),r=w('<span class="user-icon"></span>').appendTo(i),n=e.authors[0],o=n&&(n.name||n.username),l=e.summary||e.content,c=e.application,a=w('<div class="activity-item-summary"></div>');if(c){c=c.replace("com.atlassian.","").replace(/\./,"-");i.addClass(c+"-activity-item")}if(n&&n.photos){for(var d=0,u=n.photos.length;d<u&&48!=(t=n.photos[d]).width;d++);o=w('<img alt="">').attr({alt:o,title:o,src:t.uri,width:t.width,height:t.height});(n.uri?w('<a href=""></a>').attr("href",n.uri).append(o):o).appendTo(r)}0<w("<div/>").html(l).find("div.activity-item-description").size()||e.title==l?a.html(l):a.html(e.title).append(w("<div class='activity-item-description'></div>").html(l));(l=a.find("ul.commit-list")).length&&l.addClass("modified");a.appendTo(i);i.append(y(e,s,e.updated));w('<div class="clearer"></div>').appendTo(i);return i}(e);a&&e.addClass("activity-item-grouped");e.appendTo(t)}function _(e){e=w(e.target);if(e.hasClass("full-view-icon")){S.addClass("full-view").removeClass("list-view filter-view");AJS.Cookie.save("streams.view."+i,"full-view")}else if(e.hasClass("list-view-icon")){S.removeClass("full-view filter-view").addClass("list-view");AJS.Cookie.save("streams.view."+i,"list-view")}z();k()}function j(e,t){var a=!!t,i=U();if(a){I=t;v=parseInt(t.maxResults)||v}else t=I;t=h(0<f?Object.assign({},t,{timeoutRetryCount:f}):t);if(!a||j.url!=t||j.title!=i){j.url=t;j.title=i;O(t)}}function O(e){j.xhr&&j.xhr.abort&&j.xhr.abort();S.addClass("loading");C.reportCustomMarkStart("fetchData");j.xhr=w.ajax({type:"get",url:e,cache:!0,headers:{"Cache-control":"max-age=30"},global:!1,dataType:w.browser.msie?"text":"xml",success:function(e,t){C.reportCustomMarkEnd("fetchData");if("parsererror"!==t){var a,i,s,r,n=jAtom(e),o={},l=AJS.Date.handleTimezoneOffset(new Date,n.timezoneOffset);"function"==typeof ActivityStreams.sortActivityItems&&(n=ActivityStreams.sortActivityItems(n)||n);r="function"==typeof ActivityStreams.groupActivityItems?ActivityStreams.groupActivityItems:function(e,t){var a=e.authors[0].username;if("anonymous"===a)return!1;var i=a&&a===t.authors[0].username,a=e.authors[0].photos[0],e=t.authors[0].photos[0],t=a&&e&&a.uri===e.uri;return i&&(!a&&!e||t)};i=(a=n.items).length;A=n.authMessages;bannedSourceMessages=n.bannedSourceMessages;v=n.self+"&title="+encodeURIComponent(U()),w("#activity-stream-feed",b).attr("href",v);var c=w("#activity-stream",b),t=w("li.activity-item",c).length,e=c.empty().clone(),d=w('<ul class="activity-stream-list"></ul>');e.append(d);bannedSourceMessages&&0<bannedSourceMessages.length&&!function(e){var t=w("<div/>"),e=w.makeArray(w.map(e,function(e){return w("<div/>").text(T.format("We were unable to retrieve data from {0}. Please refresh in {1} seconds.",e.provider,e.expiryTime)).html()})).join("<div/>"),e=w("<div></div>").html(e),e=AJS.messages.warning(t,{body:e.html(),closeable:!0});gadgetUtil.makeMessageCloseable(e.find("div.aui-message"));e&&e.find("a").click(function(e){e.preventDefault();O(void 0)});return t}(bannedSourceMessages).appendTo(d);0<n.timedOutSources.length&&!function(e){var t=w("<div/>"),a=1<e.length?"{0} activity sources ({1}) were slow to respond and arent included.":"The activity source for {1} was slow to respond and isnt included.",i=w.makeArray(w.map(e,function(e){return w("<div/>").text(e).html()})).join(", "),i=w("<div></div>").html(AJS.format(a,e.length,i,void 0)),i=AJS.messages.warning(t,{body:i.html(),closeable:!0});gadgetUtil.makeMessageCloseable(i.find("div.aui-message"));i&&i.find("a").click(function(e){e.preventDefault();O(void 0)});return t}(n.timedOutSources).appendTo(d);!function(e){var t=w("#activity-stream-opt-in-slow-query",b);t.removeClass("loading");e?t.removeClass("hidden"):t.addClass("hidden")}(0<n.timedOutSources.length);n&&A&&0<A.length&&E(A).appendTo(d);var u,v=!1;if(n&&i){for(var v=0<t,m=0;m<i;m++){var p=a[m],f=!1,h=(p.authors[0].username,p.date=AJS.Date.parse(p.updated,p.timezoneOffset)),g=AJS.Date.getCoarseRelativeDate(h,l),y=p.links["http://streams.atlassian.com/syndication/css"];p.now=l;if(g&&g!==s){(h=g,w('<h2 class="date-header"></h2>').text(h)).appendTo(d);s=g}else f=m&&r(p,a[m-1]);y&&w.each(y,function(e,t){o[t]=o[t]||t});J(p,d,f)}w("li.activity-item",d).mouseover(function(){w(this).addClass("hover")}).mouseout(function(){w(this).removeClass("hover")})}else w('<div class="activity-item no-activity"></div>').text("No activity was found").appendTo(d);for(u in o)w('link[href="'+u+'"][rel="stylesheet"]').length||!function(e){var t='@import url("'+e+'");',a=w('<style type="text/css"></style>');if(a[0].styleSheet){a[0].styleSheet.cssText=t;return a}return w('<link media="all" rel="stylesheet" type="text/css">').attr("href",e)}(u).appendTo(w("head"));var A=i<I.maxResults;w("#activity-stream-show-more",b).removeClass("loading").toggleClass("hidden",A);n=!!w("#activity-stream-show-more",b).attr("data-clicked");w("#activity-stream-issue-date-limit-info",b).toggleClass("hidden",!(n&&A));c.replaceWith(e);S.trigger("contentLoaded.streams");x();if(0<w("img:uncached",e).length){AJS.debug&&console.log("At least one uncached image is in the stream. We will have to delay resize until they are loaded.");w("#activity-stream",b).waitForImages(function(){AJS.debug&&console.log("All images in stream have now loaded. Proceeding with resize...");k()})}else{AJS.debug&&console.log("All images are loaded, so no need to wait to resize.");k()}if(v){t=w("li.activity-item",d).get(t);if(void 0!==t){t=w(t).find(".activity-item-user").first();0<t.length&&t.focus()}}}var v;w(".activity-item a",b).bind("click",L)},error:function(e){C.reportCustomMarkEnd("fetchData");AJS.messages.error(w("#activity-stream",b),{body:"An error occurred while trying to retrieve recent activity.",closeable:!0});w("#activity-stream-show-more",b).removeClass("loading").addClass("hidden");S.trigger("contentLoaded.streams");x();k()},complete:function(){S.removeClass("loading");delete j.xhr}})}function L(e){var t=w(e.currentTarget.offsetParent),a=w(e.currentTarget.parentNode).attr("class"),i=w(e.currentTarget).attr("class"),s="streams";t.hasClass("confluence-activity-item")?s+=".confluence":t.hasClass("jira-activity-item")?s+=".jira":t.hasClass("bamboo-activity-item")?s+=".bamboo":t.hasClass("fisheye-activity-item")?s+=".fisheye":t.hasClass("crucible-activity-item")&&(s+=".crucible");a&&(s=s+"."+a.replace(" ","_"));i&&(s=s+"."+i.replace(" ","_"));AJS.EventQueue.push({name:s,properties:{itemText:w(e.currentTarget).text()}})}function t(){(S=D().appendTo(l,b)).bind("contentLoaded.streams",function(){"function"==typeof w.fn.livestamp&&w("span.livestamp",b).livestamp()});w("button.activity-stream-view",S).click(_).mouseover(function(){w(this).addClass("hover")}).mouseout(function(){w(this).removeClass("hover")});S.bind("contentUpdate.streams",j);function e(e){e.preventDefault();j()}for(var t=ActivityStreamsApplinks.getListeners(ActivityStreamsApplinks.LISTENERS_KEYS.AUTH_APPROVED_LISTENERS,i),a=0;a<t.length;a++)w(document).unbind("applinks.auth.approved",t[a]);ActivityStreamsApplinks.unRegisterListeners(ActivityStreamsApplinks.LISTENERS_KEYS.AUTH_APPROVED_LISTENERS,i);w(document).bind("applinks.auth.approved",e);ActivityStreamsApplinks.registerListener(ActivityStreamsApplinks.LISTENERS_KEYS.AUTH_APPROVED_LISTENERS,i,e);S.trigger("contentUpdate.streams",R());S.addClass("not-configurable");z()}function U(){return w("#stream-title",b).text()}function q(){var e,t,a=w("#activity-stream .streams-animate-hidden",b);if(a.length){e=a.filter(".activity-item:last");(t=e.prevAll(".date-header:first")).hasClass("streams-animate-hidden")&&t.fadeIn("slow",function(){t.removeClass("streams-animate-hidden")});e.fadeIn("slow",function(){e.removeClass("streams-animate-hidden")});setTimeout(q,3e3)}}function z(){w(".activity-stream-view",b).attr("aria-checked",!1);w(".activity-stream-container",b).hasClass("full-view")&&w(".full-view-icon",b).attr("aria-checked",!0);w(".activity-stream-container",b).hasClass("list-view")&&w(".list-view-icon",b).attr("aria-checked",!0)}t();return{load:t,update:j,getMaxResults:function(){return I.maxResults},animate:function(){w("#activity-stream .activity-item, #activity-stream .date-header",b).css("display","none").addClass("streams-animate-hidden");q()}}};function ActivityFeed(e,t,a){return ActivityStreams.stream({id:e,url:t,maxResults:a})}var inlineActions={};ActivityStreams.registerAction=function(e,t,a){for(var i=e?e.split(" "):[],s=0,r=i.length;s<r;s++){var n=i[s];if(inlineActions[n]){inlineActions[n].push({element:t,sortBy:a});inlineActions[n].sort(function(e,t){return e.sortBy<t.sortBy?-1:1})}else inlineActions[n]=[{element:t,sortBy:a}]}};ActivityStreams.getActions=function(e){for(var t=inlineActions[e]||[],a=[],i=0,s=t.length;i<s;i++)a.push(t[i].element);return a};ActivityStreams.getBaseUrl=function(){return wrmContextPath()};ActivityStreams.showThrobber=function(e,t){return function(e,t,a,i){i=i||1e3;var s,r=function(e,t){r.t=setTimeout(function(){clearTimeout(r.t);r.t=void 0;e&&e()},t)};r(function(){if(!s){e();r(function(){s&&s()},i)}},a=a||50);return function(){s=t;r.t||s()}}(function(){e.addClass("loading")},function(){e.removeClass("loading")},t=t||50,500)};;
;
/* module-key = 'com.atlassian.streams.actions:inlineActionsJs', location = 'streams-inline-actions-plugin/js/inline-actions/inline-actions.js' */
var ActivityStreams=ActivityStreams||{};ActivityStreams.InlineActions=ActivityStreams.InlineActions||(function(){function displayMessage(activityItem,message,type,additionalEvents){var container=activityItem.find("div.activity-item-action-status-container"),timeout=container.data("timeout");type=type||"info";if(timeout){clearTimeout(timeout)}container.bind("messageClose",function(e){container.addClass("hidden").trigger("contentResize.streams");additionalEvents&&additionalEvents()});AJS.messages[type](container,{body:message,closeable:false});container.removeClass("hidden").trigger("contentResize.streams");timeout=setTimeout(function(){container.find("div.aui-message").fadeOut(1000,function(){AJS.$(this).closeMessage()})},3000);container.data("timeout",timeout)}function proxy(url,feedItem){if(feedItem&&feedItem.generator&&(feedItem.generator!=ActivityStreamsGadgetBaseUrl)){return ActivityStreamsGadgetBaseUrl+"/rest/activity-stream/1.0/url-proxy?url="+url}return url}function registerEvents(){AJS.$("body").bind("beginInlineAction",function(e){var target=AJS.$(e.target),actionsContainer=target.closest("li.activity-item").find("div.activity-item-actions"),stopFn=ActivityStreams.showThrobber(actionsContainer);actionsContainer.data("stopFn",stopFn)}).bind("completeInlineAction",function(e){var target=AJS.$(e.target),actionsContainer=target.closest("li.activity-item").find("div.activity-item-actions"),stopFn=actionsContainer.data("stopFn");if(stopFn){stopFn()}else{actionsContainer.removeClass("loading")}})}registerEvents();return{statusMessage:displayMessage,proxy:proxy,register:registerEvents}})();;
;
/* module-key = 'com.atlassian.streams.actions:commentActionHandlers', location = 'streams-inline-actions-plugin/js/inline-actions/comment.js' */
(function(){var formatter=require("jira/util/formatter");function toggleCommentForm(e){var activityItem=AJS.$(e.target).closest("li.activity-item"),form=activityItem.find("form.activity-item-comment-form");e.preventDefault();if(!form.length){form=buildCommentForm(e,activityItem);form.appendTo(activityItem)}if(form.is(":visible")){form.slideUp(function(){form.trigger("contentResize.streams").removeClass("ready")})}else{form.slideDown(function(){form.find("textarea").focus();form.css({display:""});form.trigger("contentResize.streams").addClass("ready")})}}function buildCommentForm(e,activityItem){var form,fieldset,submit,feedItem;if(!e.data||!e.data.feedItem){ActivityStreams.InlineActions.statusMessage(activityItem,"An unknown error occurred while submitting your comment.","error");return null}feedItem=e.data.feedItem;form=AJS.$('<form class="activity-item-comment-form" method="post" action=""></form>').css({display:"none"});fieldset=AJS.$("<fieldset></fieldset>").appendTo(form);AJS.$('<input type="hidden" name="replyTo">').val(feedItem.links["http://streams.atlassian.com/syndication/reply-to"]).appendTo(fieldset);AJS.$('<input type="hidden" name="xsrfToken">').val(window.top.AJS.$("#atlassian-token").attr("content")).appendTo(fieldset);AJS.$('<textarea cols="40" rows="6" name="comment"></textarea>').appendTo(fieldset);submit=AJS.$('<div class="submit"></div>').appendTo(form);AJS.$('<button name="submit" type="submit"></button>').text("Add").appendTo(submit);AJS.$('<a href="#" class="streams-cancel"></a>').text("Cancel").click(toggleCommentForm).appendTo(submit);form.submit(function(e){e.preventDefault();var form=AJS.$(e.target),commentBody=AJS.$.trim(form.find("textarea").val());if(commentBody.length===0){ActivityStreams.InlineActions.statusMessage(activityItem,"Please enter a comment.","error");return }form.find("button").attr("disabled","true");AJS.$.ajax({type:"POST",url:ActivityStreams.getBaseUrl()+"/plugins/servlet/streamscomments",data:form.serialize(),dataType:"json",global:false,beforeSend:function(){form.trigger("beginInlineAction")},complete:function(){form.trigger("completeInlineAction")},success:function(data,textStatus,xhr){toggleCommentForm(e);form.find("button").removeAttr("disabled");form.find("textarea").val("");if(xhr.status==302){ActivityStreams.InlineActions.statusMessage(activityItem,"An unknown error occurred while submitting your comment.","error")}else{ActivityStreams.InlineActions.statusMessage(activityItem,"Successfully added comment.","info");form.trigger("issueCommented",feedItem)}},error:function(response){var data=(response&&response.data)||response,subcode=(data&&data.responseText&&AJS.json.parse(data.responseText).subCode)||"streams.comment.action.error.invalid.comment";toggleCommentForm(e);form.find("button").removeAttr("disabled");ActivityStreams.InlineActions.statusMessage(activityItem,formatter.I18n.getText(subcode),"error")}})});return form}function buildTrigger(label,feedItem){if(!feedItem.links["http://streams.atlassian.com/syndication/reply-to"]){return null}return AJS.$('<a href="#" class="activity-item-comment-link"></a>').text(label).bind("click",{feedItem:feedItem},toggleCommentForm)}function buildCommentLink(feedItem){var label="Comment";if(feedItem.application!=="com.atlassian.jira"&&feedItem.type==="comment"){label="Reply"}return buildTrigger(label,feedItem)}ActivityStreams.registerAction("article comment page issue file job",buildCommentLink,1)})();;
;
/* module-key = 'com.atlassian.streams.jira.inlineactions:actionHandlers', location = 'streams-jira-inline-actions-plugin/js/inline-actions/issue-vote.js' */
(function(){var formatter=require("jira/util/formatter");function addIssueVote(e){var target=AJS.$(e.target),activityItem=target.closest("li.activity-item"),url,feedItem=e.data&&e.data.feedItem;if(feedItem){url=feedItem.links["http://streams.atlassian.com/syndication/issue-vote"]}else{ActivityStreams.InlineActions.statusMessage(activityItem,"An unknown error occurred while voting.","error")}e.preventDefault();hideLink(activityItem);AJS.$.ajax({type:"POST",contentType:"application/json",url:ActivityStreams.InlineActions.proxy(url,feedItem),global:false,beforeSend:function(){target.trigger("beginInlineAction")},complete:function(){target.trigger("completeInlineAction")},success:function(){ActivityStreams.InlineActions.statusMessage(activityItem,"You have voted for this issue.","info")},error:function(request){var msg;if(request.status==401||request.rc==401){msg="Cannot authenticate JIRA user."}else{if(request.status==412||request.rc==412){msg="You could not vote for this issue at this time."}else{if(request.status==409||request.rc==409){msg="You have already voted for this issue."}else{msg="An unknown error occurred while voting."}}}ActivityStreams.InlineActions.statusMessage(activityItem,msg,"error")}})}function hideLink(activityItem){activityItem.find("a.activity-item-issue-vote-link").addClass("hidden");activityItem.find("span.activity-item-issue-vote-label").removeClass("hidden")}function buildLink(feedItem){if(!feedItem.links["http://streams.atlassian.com/syndication/issue-vote"]){return }var link=AJS.$('<a href="#" class="activity-item-issue-vote-link"></a>').text("Vote").bind("click",{feedItem:feedItem},addIssueVote),label=AJS.$('<span class="activity-item-issue-vote-label hidden"></span>').text("Vote");return link.add(label)}ActivityStreams.registerAction("issue file",buildLink,9)})();;
;
/* module-key = 'com.atlassian.streams.jira.inlineactions:actionHandlers', location = 'streams-jira-inline-actions-plugin/js/inline-actions/issue-watch.js' */
(function(){var formatter=require("jira/util/formatter");function addIssueWatcher(e){var target=AJS.$(e.target),activityItem=target.closest("li.activity-item"),url,feedItem=e.data&&e.data.feedItem;if(feedItem){url=feedItem.links["http://streams.atlassian.com/syndication/watch"]}else{ActivityStreams.InlineActions.statusMessage(activityItem,"An unknown error occurred while adding you as a watcher.","error")}e.preventDefault();hideLink(activityItem);AJS.$.ajax({type:"POST",contentType:"application/json",url:ActivityStreams.InlineActions.proxy(url,feedItem),global:false,beforeSend:function(){target.trigger("beginInlineAction")},complete:function(){target.trigger("completeInlineAction")},success:function(){ActivityStreams.InlineActions.statusMessage(activityItem,"Successfully added as a watcher.","info")},error:function(request){var msg;if(request.status==401||request.rc==401){msg="Cannot authenticate JIRA user."}else{if(request.status==412||request.rc==412){msg="You could not be added as a watcher at this time."}else{if(request.status==409||request.rc==409){msg="You are already watching this issue."}else{msg="An unknown error occurred while adding you as a watcher."}}}ActivityStreams.InlineActions.statusMessage(activityItem,msg,"error")}})}function hideLink(activityItem){activityItem.find("a.activity-item-issue-watch-link").addClass("hidden");activityItem.find("span.activity-item-issue-watch-label").removeClass("hidden")}function buildLink(feedItem){if(!feedItem.links["http://streams.atlassian.com/syndication/watch"]){return }var link=AJS.$('<a href="#" class="activity-item-issue-watch-link"></a>').text("Watch").bind("click",{feedItem:feedItem},addIssueWatcher),label=AJS.$('<span class="activity-item-issue-watch-label hidden"></span>').text("Watch");return link.add(label)}AJS.$("body").bind("issueCommented",function(e,feedItem){if(!feedItem.links["http://streams.atlassian.com/syndication/watch"]){return }var target=AJS.$(e.target),item=target.closest("li.activity-item");if(!item){return }var url=feedItem.links["http://streams.atlassian.com/syndication/watch"];AJS.$.ajax({type:"GET",url:ActivityStreams.InlineActions.proxy(url,feedItem),global:false,beforeSend:function(){target.trigger("beginInlineAction")},complete:function(){target.trigger("completeInlineAction")},success:function(result){if(result){hideLink(item)}},error:function(request){}})});ActivityStreams.registerAction("issue comment file",buildLink,10)})();;
;
/* module-key = 'com.atlassian.gadgets.publisher:dashboard-item-common', location = 'gadgets-publisher-plugin/dashboard-item/common/dashboard-item-common.soy' */
// This file was automatically generated from dashboard-item-common.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Atlassian.DashboardItem.Common.Templates.
 */

if (typeof Atlassian == 'undefined') { var Atlassian = {}; }
if (typeof Atlassian.DashboardItem == 'undefined') { Atlassian.DashboardItem = {}; }
if (typeof Atlassian.DashboardItem.Common == 'undefined') { Atlassian.DashboardItem.Common = {}; }
if (typeof Atlassian.DashboardItem.Common.Templates == 'undefined') { Atlassian.DashboardItem.Common.Templates = {}; }


Atlassian.DashboardItem.Common.Templates.config = function(opt_data, opt_ignored) {
  return '<div class="dashboard-item-preferences-config"><div class="dashboard-item-error"></div><form action="#" method="post" class="aui"><p class="mandatory-fields-description" aria-hidden="true">' + soy.$$escapeHtml('Required fields are marked with an asterisk') + ' <span class="aui-icon icon-required"></span></p>' + soy.$$filterNoAutoescape(opt_data.fields) + '<div class="buttons-container"><div class="buttons"><input class="button submit" type="submit" value="' + soy.$$escapeHtml('Save') + '">' + ((opt_data.isConfigured) ? '<input class="aui-button aui-button-link cancel" type="button" value="' + soy.$$escapeHtml('Cancel') + '">' : '') + '</div></div></form></div>';
};
if (goog.DEBUG) {
  Atlassian.DashboardItem.Common.Templates.config.soyTemplateName = 'Atlassian.DashboardItem.Common.Templates.config';
}


Atlassian.DashboardItem.Common.Templates.refreshInterval = function(opt_data, opt_ignored) {
  var output = '';
  var prefixedId__soy18 = opt_data.prefix + opt_data.id;
  output += '<div class="field-group ' + soy.$$escapeHtml(opt_data.id) + '"><label for="' + soy.$$escapeHtml(prefixedId__soy18) + '">' + soy.$$escapeHtml('Auto refresh') + '</label><div class="checkbox"><label><input type="checkbox" id="' + soy.$$escapeHtml(prefixedId__soy18) + '" name="' + soy.$$escapeHtml(opt_data.id) + '" value="15" class="checkbox" ' + ((opt_data.value != 'false' && opt_data.value != '') ? 'checked="checked"' : '') + '>' + soy.$$escapeHtml('Update every 15 minutes') + '</label></div><div class="description">&nbsp;</div></div>';
  return output;
};
if (goog.DEBUG) {
  Atlassian.DashboardItem.Common.Templates.refreshInterval.soyTemplateName = 'Atlassian.DashboardItem.Common.Templates.refreshInterval';
}
;
;
/* module-key = 'com.atlassian.jira.gadgets:dashboard-item-common-resources', location = 'jira-gadgets-plugin/static/dashboarditem/common/DashboardItemCommonFunctions.js' */
define("jira-dashboard-items/common-functions",["underscore","jira/analytics/web-client","jquery"],function(t,n,i){function r(e,r){return String.fromCharCode(r)}return{projectFilterBackwardCompatible:function(e){var r=t.extend({},e);if(r.projectOrFilterId&&(!r.type||!r.id)){r.name||(r.name=r.projectOrFilterId);e=r.projectOrFilterId.split("-");if(2===e.length){r.type=e[0];r.id=e[1]}}delete r.projectOrFilterId;return r},getSafeLegacyProjectOrFilterId:function(e){!(e=t.extend({},e)).projectOrFilterId&&e.type&&e.id&&(e.projectOrFilterId=e.type+"-"+e.id);delete e.id;delete e.type;return e},sendClickAnalyticsEvent:function(e,r){n.sendUIEvent({action:"clicked",actionSubject:"link",actionSubjectId:r,source:"dashboardScreen",attributes:{gadgetType:e}})},unescapeString:function(e){return e.replace(/&#([0-9]+);/g,r)},getFieldNameFromErrorKey:function(e){return"projectOrFilterId"===e?"project-filter-picker":e},getFieldGroup:function(e){return e.parents(".field-group")},setErrorOnFieldGroup:function(e,r){i(".error",e).text(r).show()},clearErrorsOnForm:function(e){i(".error",e).text("").hide()}}});;
;
/* module-key = 'com.atlassian.jira.gadgets:wrm-gadget-browser-metrics', location = 'jira-gadgets-plugin/static/dashboarditem/common/WrmGadgetMetrics.js' */
define("jira-dashboard-items/wrm-gadget-browser-metrics",["internal/browser-metrics","jira/featureflags/feature-manager"],function(i,t){function r(t,r,e){this.marks={};this.key=t;this.gadgetId=""+r;this.reportGadgetMetrics=e}function a(){return window&&window.performance&&window.performance.now()}r.prototype={markStart:function(t){this.marks.start=a();window.__SPA__&&"function"==typeof this.reportGadgetMetrics&&this.reportGadgetMetrics(this.gadgetId,"gadget-start",t)},report:function(t){var r=this;if(r.key&&r.marks.start)if(window.__SPA__)"function"==typeof this.reportGadgetMetrics&&this.reportGadgetMetrics(this.gadgetId,"gadget-rendering-finished",t);else{var e=a();i.start({key:r.key,isInitial:!0,reporters:function(){return{gadgetStart:r.marks.start,gadgetDuration:e-r.marks.start}}});i.end({key:r.key})}},reportCustomMarkStart:function(t){window.__SPA__&&this.reportGadgetMetrics(this.gadgetId,"gadget-mark","Unspecified",t,"start")},reportCustomMarkEnd:function(t){window.__SPA__&&this.reportGadgetMetrics(this.gadgetId,"gadget-mark","Unspecified",t,"end")}};return r});;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-dashboard-item-resources', location = 'streams-jira-plugin/dashboarditem/activity-stream/ActivityStream.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.ActivityStream&&(JIRA.DashboardItem.ActivityStream={}),"undefined"==typeof JIRA.DashboardItem.ActivityStream.Templates&&(JIRA.DashboardItem.ActivityStream.Templates={}),JIRA.DashboardItem.ActivityStream.Templates.Error=function(e,t){return'<div class="activity-stream-dashboard-item">'+aui.message.error({titleContent:"Oops - an error has occurred",content:"",closeable:"false"})+"</div>"},JIRA.DashboardItem.ActivityStream.Templates.Configuration=function(e,t){return'<div id="config" class="activity-stream-dashboard-item">'+Atlassian.DashboardItem.Common.Templates.config({fields:aui.form.textField({id:e.prefix+"stream-title-edit",name:"stream-title-edit",labelContent:"Add activity stream name",value:e.preferences.title?e.preferences.title:"",descriptionText:"",extraClasses:"stream-title-edit"})+'<fieldset id="streams-global-filters"><legend>'+soy.$$escapeHtml(e.filterSectionTitle)+"</legend>"+JIRA.DashboardItem.ActivityStream.Templates.AddFilter(null)+"</fieldset>"+(e.hasMultipleProviders?'<fieldset id="streams-available-streams"><legend>'+soy.$$escapeHtml("Available Streams")+'</legend><div class="available-streams-description">'+soy.$$escapeHtml("Each stream can be toggled and customised individually.")+"</div></fieldset>":"")+'<fieldset id="streams-display-options"><legend>'+soy.$$escapeHtml("Display Options")+"</legend>"+JIRA.DashboardItem.ActivityStream.Templates.NumberOfEntries({prefixedId:e.prefix+"numofentries",currentValue:e.preferences.numofentries})+JIRA.DashboardItem.ActivityStream.Templates.RefreshSection({prefixedIdCheckbox:e.prefix+"refresh-checkbox",prefixedIdSelect:e.prefix+"refresh-interval",currentValue:e.preferences.refresh,refreshIntervalOptions:e.refreshIntervalOptions})+"</fieldset>",isConfigured:e.preferences.isConfigured})+"</div>"},JIRA.DashboardItem.ActivityStream.Templates.AliasProvider=function(e,t){for(var a='<div class="aliased-providers" data-key="'+soy.$$escapeHtml(e.filterKey)+'" data-option="'+soy.$$escapeHtml(e.aliasKey)+'" data-type="'+soy.$$escapeHtml(e.aliasType)+'">',s=e.values,r=s.length,i=0;i<r;i++){var l=s[i];a+='<div class="stream-provider" data-key="'+soy.$$escapeHtml(l.key)+'" data-name="'+soy.$$escapeHtml(l.displayText)+'"><div class="stream-provider-header checkbox"><input type="checkbox" class="checkbox provider-enable"'+(l.isEnabled?'checked="checked"':"")+'name="'+soy.$$escapeHtml(e.provider)+"-"+soy.$$escapeHtml(l.key)+'-enable" id="'+soy.$$escapeHtml(e.provider)+"-"+soy.$$escapeHtml(l.key)+'-enable" title="Disable stream"><label for="'+soy.$$escapeHtml(e.provider)+"-"+soy.$$escapeHtml(l.key)+'-enable" title="'+soy.$$escapeHtml(l.title)+'">'+soy.$$escapeHtml(l.aliasedProviderKey)+"</label></div></div>"}return a+="</div>"},JIRA.DashboardItem.ActivityStream.Templates.AvailableFilters=function(e,t){return'<div class="stream-provider" data-key="'+soy.$$escapeHtml(e.applinkRenderOption.key)+'"><div class="stream-provider-header checkbox"><input type="checkbox" class="checkbox provider-enable applink-header-checkbox"'+(e.applinkRenderOption.isEnabled?'checked="checked"':"")+'name="'+soy.$$escapeHtml(e.applinkRenderOption.key)+'-enable" id="'+soy.$$escapeHtml(e.prefix)+soy.$$escapeHtml(e.applinkRenderOption.key)+'-enable" title="'+soy.$$escapeHtml(e.applinkRenderOption.isEnabled?"Disable stream":"Enable stream")+'"><label for="'+soy.$$escapeHtml(e.prefix)+soy.$$escapeHtml(e.applinkRenderOption.key)+'-enable" title="">'+soy.$$escapeHtml(e.applinkRenderOption.name)+'</label><a href="#" class="add-filter-link stream-provider-customize-link" data-key="'+soy.$$escapeHtml(e.applinkRenderOption.key)+'">('+soy.$$escapeHtml("add filter")+")</a></div></div>"},JIRA.DashboardItem.ActivityStream.Templates.AddFilter=function(e,t){return'<div class="global-filter-description stream-provider" data-key="streams">'+soy.$$escapeHtml("Filters can be used to customise the activity in your stream.")+'&nbsp;<a href="#" class="add-filter-link" id="add-global-filter">'+soy.$$escapeHtml("Add a filter.")+'</a><span class="add-filter-message"></span></div>'},JIRA.DashboardItem.ActivityStream.Templates.FilterContainer=function(e,t){return'<div class="smart-config"></div>'},JIRA.DashboardItem.ActivityStream.Templates.Operators=function(e,t){for(var a='<select class="operator">',s=e.operators,r=s.length,i=0;i<r;i++){var l=s[i];a+='<option value="'+soy.$$escapeHtml(l.key)+'" class="'+soy.$$escapeHtml(l.key)+'"'+(e.currentValue&&e.currentValue.operator&&e.currentValue.operator==l.key?'selected="selected"':"")+">"+soy.$$escapeHtml(l.name)+"</option>"}return a+="</select>"},JIRA.DashboardItem.ActivityStream.Templates.FilterRules=function(e,t){for(var a='<select class="rule">',s=e.filterOptions,r=s.length,i=0;i<r;i++){var l=s[i];a+='<option value="'+soy.$$escapeHtml(l.key)+'" class="'+soy.$$escapeHtml(l.keyWithUnderscore)+'"'+(e.currentValue&&e.currentValue.rule&&l.key==e.currentValue.rule?'selected="selected"':"")+">"+soy.$$escapeHtml(l.name)+"</option>"}return a+="</select>"},JIRA.DashboardItem.ActivityStream.Templates.MultiSelectDropdown=function(e,t){for(var a='<select multiple="multiple" class="multi-select update-on-change user-input" data-rule="'+soy.$$escapeHtml(e.dataRule)+'" data-type="'+soy.$$escapeHtml(e.option.type)+'" title="'+soy.$$escapeHtml(e.option.helpText)+'">',s=e.option.values,r=s.length,i=0;i<r;i++){var l=s[i];a+='<option value="'+soy.$$escapeHtml(l.key)+'" class="'+soy.$$escapeHtml(l.key)+'"'+(e.currentValue&&e.currentValue.value&&e.currentValue.value.indexOf(l.key)!=-1?'selected="selected"':"")+">"+soy.$$escapeHtml(l.displayText)+"</option>"}return a+="</select>"},JIRA.DashboardItem.ActivityStream.Templates.TextFieldInput=function(e,t){return'<input class="text update-on-change user-input" type="text"'+(e.disabled?" disabled ":"")+("date"==e.option.type?'data-parsed-time="'+soy.$$escapeHtml(e.currentValue&&e.currentValue.value?e.currentValue.value:"")+'" autocomplete="off"':'value="'+soy.$$escapeHtml(e.currentValue&&e.currentValue.value?e.currentValue.value:"")+'"')+(e.option&&e.option.helpText?'title="'+soy.$$escapeHtml(e.option.helpText)+'"':"")+'data-rule="'+soy.$$escapeHtml(e.dataRule)+'" data-type="'+soy.$$escapeHtml(e.option.type)+'">'},JIRA.DashboardItem.ActivityStream.Templates.DateRangeContainer=function(e,t){return'<span class="date-range-container"><input class="text update-on-change user-input date-range" type="text" autocomplete="off" data-parsed-time="'+soy.$$escapeHtml(e.currentValue&&e.currentValue.value&&2==e.currentValue.value.length?e.currentValue.value[0]:"")+'" data-rule="'+soy.$$escapeHtml(e.dataRule)+'" data-type="'+soy.$$escapeHtml(e.option.type)+'"><span class="date-range-joiner">'+soy.$$escapeHtml("and")+'</span><input class="text update-on-change user-input date-range" type="text" autocomplete="off" data-parsed-time="'+soy.$$escapeHtml(e.currentValue&&e.currentValue.value&&2==e.currentValue.value.length?e.currentValue.value[1]:"")+'" data-rule="'+soy.$$escapeHtml(e.dataRule)+'" data-type="'+soy.$$escapeHtml(e.option.type)+'"></span>'},JIRA.DashboardItem.ActivityStream.Templates.FilterRow=function(e,t){return'<div class="config-row">'+JIRA.DashboardItem.ActivityStream.Templates.FilterRules(e)+JIRA.DashboardItem.ActivityStream.Templates.Operators({operators:e.option.operators,currentValue:e.currentValue})+JIRA.DashboardItem.ActivityStream.Templates.UserInputSelector(e)+JIRA.DashboardItem.ActivityStream.Templates.AddRemoveFilter(null)+'<div class="clearer"></div></div>'},JIRA.DashboardItem.ActivityStream.Templates.UserInputSelector=function(e,t){var a="";switch(e.option.type){case"select":a+=JIRA.DashboardItem.ActivityStream.Templates.MultiSelectDropdown(e);break;case"date":a+=e.currentValue&&e.currentValue.operator&&"between"==e.currentValue.operator?JIRA.DashboardItem.ActivityStream.Templates.DateRangeContainer(e):JIRA.DashboardItem.ActivityStream.Templates.TextFieldInput(e);break;case"list":a+=JIRA.DashboardItem.ActivityStream.Templates.TextFieldInput(e);break;case"user":a+='<div class="activity-stream-deprecated-username-container">'+JIRA.DashboardItem.ActivityStream.Templates.TextFieldInput({dataRule:e.dataRule,option:e.option,currentValue:e.currentValue,disabled:!0})+'<div class="error">'+soy.$$escapeHtml("The \"Username\" field is now called \"Account ID\". To continue viewing data on the users above, add these users manually to the \"Account ID\" field. Once you\'re done, remove the \"Username\" field by clicking the \'minus\' button to the right.")+"</div></div>";break;case"account-id":a+='<div class="chzn-container activity-stream-user-selection-container user-input" data-rule="'+soy.$$escapeHtml(e.dataRule)+'" data-type="'+soy.$$escapeHtml(e.option.type)+'"><div class="activity-stream-user-selection"></div></div>';break;default:a+="<div>No component registered to handle type <strong>"+soy.$$escapeHtml(e.option.type)+"</strong> in the ActivityStream .FilterRow templates file</div>"}return a},JIRA.DashboardItem.ActivityStream.Templates.AddRemoveFilter=function(e,t){return'<span class="add-remove-buttons"><button class="add" type="button" title="'+soy.$$escapeHtml("Add")+'"><span>'+soy.$$escapeHtml("Add")+'</span></button><button class="remove" type="button" title="'+soy.$$escapeHtml("Remove")+'"><span>'+soy.$$escapeHtml("Remove")+"</span></button></span>"},JIRA.DashboardItem.ActivityStream.Templates.NumberOfEntries=function(e,t){return'<div class="field-group" id="max-results-container">Limit to&nbsp;<span class="input-container"><input class="text numofentries update-on-change" type="text" value="'+soy.$$escapeHtml(e.currentValue?e.currentValue:"")+'" name="numofentries" maxlength="2" id="'+soy.$$escapeHtml(e.prefixedId)+'"></span>&nbsp;items</div>'},JIRA.DashboardItem.ActivityStream.Templates.RefreshSection=function(e,t){return'<div class="field-group refresh-container"><div class="checkbox">'+aui.form.input({type:"checkbox",id:e.prefixedIdCheckbox,name:"refresh",isChecked:!!e.currentValue})+aui.form.label({forField:e.prefixedIdCheckbox,content:""+soy.$$escapeHtml("Automatically refresh this activity stream")})+"</div>"+(e.currentValue?JIRA.DashboardItem.ActivityStream.Templates.SelectPicker({prefixedId:e.prefixedIdSelect,label:"",name:"refresh-interval",options:e.refreshIntervalOptions,currentValue:e.currentValue}):"")+"</div>"},JIRA.DashboardItem.ActivityStream.Templates.SelectPicker=function(e,t){for(var a='<label for="'+soy.$$escapeHtml(e.prefixedId)+'">'+soy.$$escapeHtml(e.label)+'</label><select id="'+soy.$$escapeHtml(e.prefixedId)+'" name="'+soy.$$escapeHtml(e.name)+'" class="select">',s=e.options,r=s.length,i=0;i<r;i++){var l=s[i];a+='<option value="'+soy.$$escapeHtml(l.value)+'" '+(l.value==e.currentValue?' selected="selected"':"")+">"+soy.$$escapeHtml(l.label)+"</option>"}return a+="</select>"},JIRA.DashboardItem.ActivityStream.Templates.IndividualUser=function(e,t){return'<div class="activity-stream-individual-user"><span class="value-text">'+soy.$$escapeHtml(e.accountId)+'</span><img src="'+soy.$$escapeHtml(e.avatarUrl)+'" /><div>'+soy.$$escapeHtml(e.displayName)+"</div></div>"};;
;
/* module-key = 'com.atlassian.streams.streams-jira-plugin:activitystream-dashboard-item-resources', location = 'streams-jira-plugin/dashboarditem/activity-stream/ActivityStream.js' */
"use strict";define("jira-dashboard-items/activitystream",["jquery","underscore","jira/util/formatter","wrm/context-path","jira/ajs/select/multi-select","jira/ajs/select/multi-select/lozenge","jira/field/user-picker-util","jira-dashboard-items/activitystream-date","jira-dashboard-items/wrm-gadget-browser-metrics","jira/featureflags/feature-manager"],function(p,f,m,c,r,i,s,o,u,e){function t(e,t){this.constants={DATE:"date",STREAMS:"streams",SELECT:"select",BETWEEN:"between",SINGLE_SPACE:" ",HYPHEN:"-",UNDERSCORE:"_"};this.API=e;this.options=t||{};this.rendered=0;this.stream=null;this.prefix=this.API.getGadgetId()+this.constants.HYPHEN;this.filterOptionsMap={};this.chosenConfig={defaultText:"Start typing to select options",noResultsText:"No results matching \"{0}\""};this.loadedDateLibrary=!1;this.hasMultipleProviders=!1;this.refreshIntervalOptions=[{value:"15",label:m.format("Every {0} Minutes",15)},{value:"30",label:m.format("Every {0} Minutes",30)},{value:"60",label:m.format("Every {0} Hour",1)},{value:"120",label:m.format("Every {0} Hours",2)}]}function l(){this.API.hideLoadingBar();this.API.resize()}function a(e){e.html(JIRA.DashboardItem.ActivityStream.Templates.Error())}function d(e){var t=e.avatarUrls?Object.keys(e.avatarUrls):[];return Object.assign({avatarUrl:e.avatarUrls&&e.avatarUrls["48x48"]||(t.length?t[0]:"")},e)}function v(e){return e.split(/\s+/g).filter(function(e,t,r){return r.indexOf(e)===t}).map(function(e){return encodeURIComponent(e)})}function g(t,r){return Object.keys(t).filter(function(e){return t[e].provider===r}).map(function(e){return t[e]})}function h(a,e){var t=p(".activity-stream-user-selection:only-child",a);if(t.length){var n=new r({element:t,removeOnUnSelect:!1,showDropdownButton:!1,errorMessage:m.format("There is no user \'\'{0}\'\'.","'{0}'"),itemBuilder:function(e){var t=e.properties.accountId||e.properties.value||"",t=new i({label:t,title:t,container:n.$selectedItemsContainer});function r(e){e=JIRA.DashboardItem.ActivityStream.Templates.IndividualUser({accountId:e.accountId,avatarUrl:e.avatarUrl,displayName:e.displayName});p(".value-item",n.$selectedItemsContainer).last().html(e);setTimeout(function(){n.$container.trigger("multiSelectHeightUpdated")},0)}e.properties.displayName?r(e.properties):p.ajax({type:"get",url:c()+"/rest/api/3/user/?accountId="+e.properties.value,dataType:"json",success:function(e){r(d(e))}});return t},ajaxOptions:{url:c()+"/rest/api/3/user/picker",query:!0,data:{showAvatar:!0},formatResponse:s.formatResponseByAccountId}});n.$container.on("multiSelectHeightUpdated",function(){var e=p(".activity-stream-user-selection-container textarea",a),t=parseFloat(e.css("padding-top")),r=p(".activity-stream-user-selection-container .representation",a).outerHeight()+4;e.height(e.outerHeight()-t+r).css("padding-top",r)});if(e){e=v(e);p.ajax({type:"get",url:c()+"/rest/api/3/user/bulk?maxResults="+e.length+e.map(function(e){return"&accountId="+e}).join(""),dataType:"json",success:function(e){e.values.forEach(function(e,t){n.addItem({accountId:e.accountId,avatarUrl:d(e).avatarUrl,displayName:e.displayName,emailAddress:e.emailAddress,value:e.accountId})})}})}}}function n(t,r,a){var e=t.options.find(function(e){return 0===p('[data-rule="'+e.key+'"]',r).length});if(e){var n=void 0,n=a.hasMultipleProviders?g(a.filterOptionsMap,t.key):Object.keys(a.filterOptionsMap).map(function(e){return a.filterOptionsMap[e]}),i=Object.keys(a.filterOptionsMap).filter(function(e){return 1===p('[data-rule="'+e+'"]',r).length});n=n.filter(function(e){return!i.includes(e.key)});n=JIRA.DashboardItem.ActivityStream.Templates.FilterRow({dataRule:e.key,option:e,filterOptions:Object.values(n),currentValue:{rule:e.key}});r.find(".rule").each(function(){p(this).find("option").each(function(){p(this).val()===e.key&&p(this).remove()})});p(".smart-config",r).append(n);var s=p('[data-rule="'+e.key+'"]',r);switch(e.type){case a.constants.SELECT:y(s,a);case a.constants.DATE:A(s)}s.parent().find(".remove").on("click",function(e){E(e,a)});s.parent().find(".add").on("click",function(){P(t,r,a)});s.parent().find(".rule").on("focus",function(e){a.previousRuleKey=e.target.value}).on("change",function(e){x(e,t,a)});s.parent().find(".operator").on("change",function(e){O(e,t,a)});n=a.filterOptionsMap[s.parent().find(".rule").val()].keyWithHyphen+a.constants.HYPHEN+s.parent().find(".operator").val();s.parent().find(".user-input").attr({name:n,"data-operator":s.parent().find(".operator").val()});if(p(".config-row",r).length===Object.values(a.filterOptionsMap).length){p(".add",r).attr("disabled",!0);p(".add",r).addClass("disabled")}0!==p('[data-rule="streams user"]',r).length&&p("input.button.submit").prop("disabled",!0);S(r);h(r)}else{p(".add",r).attr("disabled",!0);p(".add",r).addClass("disabled");!function(e,t,r){var a=t.closest("div.stream-provider").find("span.add-filter-message"),r=p('<span class="add-filter-message"></span>').text(e).addClass(r);a.length?a.replaceWith(r):r.insertAfter(t);!function(e,t){t=t||2500;setTimeout(function(){e.fadeOut(250,function(){e.remove()})},t)}(r)}("All available filters have already been added.",p(".add-filter-link",r),"filter-error")}}function y(e,t){e.chosen(t.chosenConfig).data("chosen").bind("show",function(){p(e).parents(".config-row").addClass("chosen-dropdown")}).bind("hide",function(){p(e).parents(".config-row").removeClass("chosen-dropdown")})}function k(e){var t=e.datepicker("option","dateFormat");try{r=AJS.$.datepicker.parseDate(t,e.val())}catch(e){r=null}var r=r&&r.getTime();e.attr("data-parsed-time",r||null);return parseInt(r,10)}function b(e,t){t?e.attr("data-parsed-time",t):t=k(e);if("NaN"!=(t=parseInt(t)).toString()){var r=I().dateFormat,t=p.datepicker.formatDate(r,new Date(t));e.val(t)}return e}function I(){var e=Date.CultureInfo;return I.defaults=I.defaults||e&&{dayNames:e.dayNames,dayNamesShort:e.abbreviatedDayNames,dayNamesMin:e.shortestDayNames,monthNames:e.monthNames,monthNamesShort:e.abbreviatedMonthNames,dateFormat:e.formatPatterns.shortDate.replace("yyyy","yy"),showMonthAfterYear:"y"===e.dateElementOrder.charAt(0),showOn:"focus",currentText:"Today",nextText:"Next",prevText:"Previous",closeText:"Close",buttonText:"..."}||{}}function A(e){e.datepicker({dateFormat:I().dateFormat,onSelect:function(){k(e);e.trigger("change")}});e.bind("change",function(e){e.target!==document.activeElement&&b(p(e.target))});e.bind("keyup",function(e){p(e.target).datepicker("hide")});return e}function E(e,t){e.preventDefault();var r=p(e.target).closest("div.config-row"),a=r.find(".user-input").attr("data-rule"),t=t.filterOptionsMap[a],a=p("<option></option>").attr("class",t.keyWithUnderscore).val(t.key).text(t.name),t=p(e.target).closest("div.smart-config");t.parent().find(".stream-provider-customize-link");if(r.closest(".smart-config").find(".add").hasClass("disabled")){r.closest(".smart-config").find(".add").attr("disabled",!1);r.closest(".smart-config").find(".add").removeClass("disabled")}0===p('[data-rule="streams user"]',r.closest(".smart-config")).length&&p("input.button.submit").prop("disabled",!1);r.remove();r=t.find(".rule");0<r.length&&r.append(a);0===t.find(".config-row").length&&t.remove();e.stopPropagation()}function T(e,t,r,a,n){if(e&&e.rules&&e.rules.providers&&f.isArray(e.rules.providers)){var i=JIRA.DashboardItem.ActivityStream.Templates.FilterContainer({});r.rules.forEach(function(e){0===a.find("div.smart-config").length&&a.append(i);!function(t,e,r,a){var n=t.rule;if(o=a.filterOptionsMap[t.rule]){var i=o.keyWithHyphen+a.constants.HYPHEN+t.operator,s=e.options.find(function(e){return e.key===t.rule}),o=void 0,o=a.hasMultipleProviders?g(a.filterOptionsMap,e.key):Object.keys(a.filterOptionsMap).map(function(e){return a.filterOptionsMap[e]}),o=JIRA.DashboardItem.ActivityStream.Templates.FilterRow({dataRule:n,option:s,filterOptions:Object.values(o),currentValue:t});p("div.smart-config",r).append(o);switch(t.type){case a.constants.SELECT:y(p('[data-rule="'+n+'"]',r),a);break;case a.constants.DATE:if(t&&t.value&&"number"==typeof t.value)b(p('[data-rule="'+n+'"]',r),t.value);else{var u=p(".date-range",r);p.each(u,function(){b(p(this),p(this).attr("data-parsed-time"))})}A(p('[data-rule="'+n+'"]',r))}o=p('[data-rule="'+n+'"]',r);o.attr({name:i,"data-operator":t.operator});o=o.parent().parent().find(".remove");o&&o.on("click",function(e){E(e,a)});0!==p('[data-rule="streams user"]',r).length&&p("input.button.submit").prop("disabled",!0);S(r);h(r,t.value)}else console.warn("current saved rule no longer available to configure:",t)}((r.provider,e),t,a,n)});p(".smart-config",a).find(".rule").each(function(){void 0===p._data(p(this).get(0),"events")&&p(this).on("focus",function(e){n.previousRuleKey=e.target.value}).on("change",function(e){x(e,t,n)})});p(".smart-config",a).find(".operator").each(function(){void 0===p._data(p(this).get(0),"events")&&p(this).on("change",function(e){O(e,t,n)})});S(a);p(".add",a).on("click",function(){P(t,a,n)})}}function S(e){var r=p(".config-row .rule :selected",e).map(function(e,t){return p(t).val()}).get();p(".config-row .rule option:not(:selected)",e).each(function(e,t){p(t).attr("hidden",r.includes(p(t).val()))})}function x(t,r,a){var e=p(t.target).closest(".smart-config"),n=a.filterOptionsMap[t.target.value],i=a.filterOptionsMap[a.previousRuleKey],s=p("<option></option>").attr("class",i.keyWithUnderscore).val(i.key).text(i.name),o=r.options.find(function(e){return e.key===t.target.value}),u=JIRA.DashboardItem.ActivityStream.Templates.Operators({operators:o.operators});p(t.target).parent().find(".operator").replaceWith(u);p(t.target).parent().find(".operator").on("change",function(e){O(e,r,a)});i=JIRA.DashboardItem.ActivityStream.Templates.UserInputSelector({dataRule:t.target.value,option:o}),u=p(t.target).parent().find(".date-range-container");if(1===u.length){p.each(u.find(".date-range"),function(){p(this).datepicker("destroy")});u.replaceWith(i)}else{p(t.target).parent().find(".user-input").unchosen().datepicker("destroy");p(t.target).parent().find(".user-input").replaceWith(i)}switch(o.type){case a.constants.SELECT:y(p(t.target).parent().find(".user-input"),a);break;case a.constants.DATE:A(p(t.target).parent().find(".user-input"))}p(t.target).parent().find(".user-input").attr({"data-operator":p(t.target).parent().find(".operator").val(),name:t.target.value.replace(" ","-")+a.constants.HYPHEN+p(t.target).parent().find(".operator").val()});e=e.find(".rule");0<e.length&&e.filter(function(){return p(this).val()!==t.target.value}).append(s);e.each(function(){p(this).val()!==n.key&&p(this).find("option").each(function(){p(this).val()===n.key&&p(this).remove()})});0!==p('[data-rule="streams user"]',p(t.target).parent()).length&&p("input.button.submit").prop("disabled",!0);S(p(t.target).parent());h(p(t.target).parent())}function O(t,e,r){if(p(t.target).parent().find(".user-input").attr("data-type")===r.constants.DATE){e=e.options.find(function(e){return e.key===p(t.target).parent().find(".rule").val()}),e=JIRA.DashboardItem.ActivityStream.Templates.UserInputSelector({dataRule:e.key,option:e,currentValue:{operator:t.target.value}});(1===p(t.target).parent().find(".date-range-container").length?p(t.target).parent().find(".date-range-container"):p(t.target).parent().find(".user-input")).replaceWith(e);A(p(t.target).parent().find(".user-input"))}p(t.target).parent().find(".user-input").attr({"data-operator":t.target.value,name:p(t.target).parent().find(".rule").val().replace(" ","-")+r.constants.HYPHEN+t.target.value})}function j(e){e.forEach(function(e){e.options=e.options.map(function(t){if("select"!==t.type||0!==Object.keys(t.values).length){if(t.values&&f.isObject(t.values)){var e=Object.keys(t.values),r=[];e.forEach(function(e){r.push({key:e,displayText:t.values[e]})});t.values=r}return t}}).filter(function(e){return e})});!function(e){var t=this;e.filter(function(e){return e.key===t.constants.STREAMS}).forEach(function(e){e.options.forEach(function(e){e&&"date"===e.type&&e.operators.unshift({key:"is",name:"is"})})})}.call(this,e)}function P(e,t,r){0===p(t).find("div.smart-config").length&&p(t).append(JIRA.DashboardItem.ActivityStream.Templates.FilterContainer({}));n(e,t,r)}function w(e){e=function(e){switch(e){case"invalid.date":return "The date entered is invalid. The preferred format is \"{0}\".";case"pref.numofentries.number":return "Item limit must be a number between 1 and 99"}}(e);1<arguments.length&&(e=AJS.format(e,Array.prototype.slice.call(arguments,1)));return p('<div class="activity-stream-validation-error"></div>').text(e)}function R(e){AJS.$("div.activity-stream-validation-error",e).remove()}function N(e,t){R();return function(e){var r=!0,a=I().dateFormat;p("input.hasDatePicker:visible",e).each(function(e,t){if("NaN"===(t=p(t)).attr("data-parsed-time")){w("invalid.date",p.datepicker.formatDate(a,new Date)).appendTo(t.closest("div.config-row"));return r=!1}});return r}(t)&&function(e,t){if(1<=parseInt(e))return!0;w("pref.numofentries.number").appendTo(p("#max-results-container",t));return!1}(e.numofentries||e.maxResults)}function D(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent}function M(e,n,t){var o=this,i=[],r=t,a="stream-title-edit";r.filters=function(e){for(var t=e.slice(),r=0;r<t.length;r++){var a=t[r],n=a.providerAliasOptionKey;if(n)for(var i=a.options.length,s=0;s<i;s++){var o=a.options[s];o.key!==n||o.values&&!AJS.$.isEmptyObject(o.values)||t.splice(r--,1)}}return t}(r.filters);j.call(o,r.filters);o.filterOptionsMap=r.filters.reduce(function(t,r){r.options.forEach(function(e){t[r.key+" "+e.key]={provider:r.key,key:r.key+" "+e.key,keyWithHyphen:r.key+"-"+e.key,keyWithUnderscore:r.key+"_"+e.key,name:e.name}});return t},{});o.hasMultipleProviders=2<r.filters.length;t=o.hasMultipleProviders?"Global Filters":"Filters",t=JIRA.DashboardItem.ActivityStream.Templates.Configuration({prefix:o.prefix,preferences:n,filterSectionTitle:t,hasMultipleProviders:o.hasMultipleProviders,refreshIntervalOptions:o.refreshIntervalOptions});e.html(t);var u=p("form",e);if(o.hasMultipleProviders){i.push(o.constants.STREAMS);r.filters.forEach(function(t){t.options=t.options.map(function(e){return Object.assign({},e,{key:t.key+" "+e.key})})});Object.fromEntries||(Object.fromEntries=function(e){var t={};e.forEach(function(e){t[e[0]]=e[1]||void 0});return t});var s=Object.fromEntries(r.filters.map(function(e){return[e.key,e]})),c=void 0;if(n.rules&&n.rules.providers){n.rules.providers.forEach(function(t){t.rules=t.rules.map(function(e){return Object.assign({},e,{rule:t.provider+" "+e.rule})})});c=Object.fromEntries(n.rules.providers.map(function(e){return[e.provider,e]}))}c&&c[o.constants.STREAMS]&&T(n,s[o.constants.STREAMS],c[o.constants.STREAMS],p('[data-key="streams"]',u),o);r.filters.filter(function(e){return e.key!==o.constants.STREAMS}).forEach(function(t){var r=n&&n.rules&&n.rules.providers&&n.rules.providers.find(function(e){return e.provider===t.key}),e=function(e){for(var t=e.providerAliasOptionKey,r=e.options,a=0;a<r.length;a++){var n=r[a];if(n.key.split(" ")[1]===t)return n}return null}(t);if(e){e.values=e.values.map(function(e){return Object.assign({},e,{title:e.key.replace(/@[^@]+$/,""),aliasedProviderKey:t.applinkName?AJS.format("{0} ({1})",e.displayText,t.applinkName):e.displayText})});if(r)if(r.hasOwnProperty("disabled")&&r.disabled)e.values=e.values.map(function(e){return Object.assign({},e,{isEnabled:!r.disabled})});else if(r.rules&&Array.isArray(r.rules)&&0<r.rules.length){var a=(a=r.rules.map(function(e){return e.value})).flat();e.values=e.values.map(function(e){return Object.assign({},e,{isEnabled:a.includes(e.key)})})}else e.values=e.values.map(function(e){return Object.assign({},e,{isEnabled:!0})});else e.values=e.values.map(function(e){return Object.assign({},e,{isEnabled:!0})});p("#streams-available-streams",u).append(JIRA.DashboardItem.ActivityStream.Templates.AliasProvider({provider:t.key.split(" ")[0],filterKey:t.key,aliasKey:e.key.split(" ")[1],aliasType:e.type,values:e.values}))}else{i.push(t.key);e={key:t.key,name:t.name,applinkName:t.applinkName,isEnabled:!(r&&r.disabled)};p("#streams-available-streams",u).append(JIRA.DashboardItem.ActivityStream.Templates.AvailableFilters({prefix:o.prefix,applinkRenderOption:e}));c&&c[e.key]&&T(n,s[e.key],c[e.key],p('div[data-key="'+e.key+'"',u),o)}});p(".applink-header-checkbox",u).each(function(){p(this).is(":checked")||p(this).parent().find(".add-filter-link").hide()});p(".add-filter-link",u).on("click",function(e){e.preventDefault();var t=void 0,r=void 0;if(p(this).parent().parent().data().hasOwnProperty("key")){t=p(this).parent().parent().data().key;r=p(this).parent().parent()}else if(p(this).parent().data().hasOwnProperty("key")){t=p(this).parent().data().key;r=p(this).parent()}P(s[t],r,o);e.stopPropagation()});p(".applink-header-checkbox",u).on("change",function(e){var t=p(e.target).parent().find(".add-filter-link");if(p(e.target).is(":checked")){t.show();var r=t.data().key;c&&c[r]&&T(n,s[r],c[r],p(e.target).parent().parent(),o)}else{t.hide();p(e.target).parent().parent().find("div.smart-config").remove()}e.stopPropagation()})}else{var l={key:o.constants.STREAMS,name:"",options:[]},d={provider:o.constants.STREAMS,rules:[]};i.includes(o.constants.STREAMS)||i.push(o.constants.STREAMS);!function(e,t,r,a,n){e.forEach(function(t){t.options.forEach(function(e){e.key=t.key+n.constants.SINGLE_SPACE+e.key;r.options.push(e)})});t=t.providers;f.isArray(t)&&0<t.length&&t.forEach(function(t){var e=t.rules;e.forEach(function(e){e.rule=t.provider+n.constants.SINGLE_SPACE+e.rule});a.rules=a.rules.concat(e)})}(r.filters,n.rules,l,d,o);0<d.rules.length&&T(n,l,d,p('[data-key="streams"]',u),o);p(".add-filter-link",u).on("click",function(e){e.preventDefault();P(l,p(this).parent(),o)})}d=p(".cancel",u);d&&d.click(f.bind(function(){o.API.closeEdit()},this));p("#"+o.prefix+"refresh-checkbox").on("click",function(){if(p(this).is(":checked")){var e=JIRA.DashboardItem.ActivityStream.Templates.SelectPicker({prefixedId:o.prefix+"refresh-interval",label:"",name:"refresh-interval",options:o.refreshIntervalOptions,currentValue:!(!n||f.isUndefined(n.refresh))&&n.refresh});p(".refresh-container",u).append(e)}else p("#"+o.prefix+"refresh-interval, [for="+o.prefix+"refresh-interval]").remove()});p(":input.update-on-change",u).live("change",function(){R(u)});u.on("submit",f.bind(function(e){e.preventDefault();var s={};p(".smart-config .config-row",u).each(function(e,t){var r=p(".rule :selected",t).val().split(o.constants.SINGLE_SPACE),a=p("[data-type]",t).attr("data-type"),n=p(":input.user-input",t).map(function(e,t){t=p(t);return a===o.constants.DATE?k(t):t.val()}).get(),i=function(){switch(a){case o.constants.DATE:return 1===n.length?isNaN(n[0])?"":n[0]:-1===n.findIndex(function(e){return isNaN(e)})?n.join(o.constants.SINGLE_SPACE).trim():"";case"account-id":return p(".activity-stream-user-selection-container .value-text",t).map(function(e,t){return t.textContent}).get().join(" ");default:return n}}();(Array.isArray(i)?i.join("").trim():i)&&(s[r[0]]=(s[r[0]]||[]).concat({rule:r[1],operator:p(".operator :selected",t).val(),value:i,type:a}))});e=Object.keys(s),e={providers:Array.from(new Set(e.concat(i))).map(function(e){var t=p("div[data-key='"+e+"']",u);return{disabled:!(1!==t.length||1!==p("input[type='checkbox']",t).length||p("input[type='checkbox']",t).is(":checked")),provider:e,rules:s[e]||[]}}).concat(o.hasMultipleProviders?function(e){for(var t=[],r=p("div.aliased-providers",e),a=0;a<r.length;a++){var n=p(r[a]),i=n.find("input.checkbox"),s=[],o={provider:n.attr("data-key"),rules:[]};i.each(function(e,t){(t=p(t)).is(":checked")&&s.push(t.closest("div.stream-provider").attr("data-key"))});i.length&&!s.length?o.disabled=!0:i.length!==s.length&&o.rules.push({rule:n.attr("data-option"),operator:"IS",value:s,type:n.attr("data-type")});t.push(o)}return t}(u):[])},e=Object.assign({},n,{isConfigured:!0,isReallyConfigured:!0,numofentries:p('[name="numofentries"]',u).val(),refresh:p('[name="refresh"]',u).is(":checked")&&p('[name="refresh-interval"]',u).val()||!1,rules:encodeURIComponent(JSON.stringify(e)),title:encodeURIComponent(p('[name="'+a+'"]',u).val())});N(e,u)&&o.API.savePreferences(e)},this))}t.prototype.render=function(e,t){var n=this,r=p(e),a=new u("jira.gadgets.activity-stream",this.API.getGadgetId(),this.API.reportGadgetMetrics);if(0===n.rendered){a.markStart("View");n.rendered+=1}n.API.setTitle("Activity Streams");r.empty();n.API.showLoadingBar();new Promise(function(r,a){p.ajax({type:"get",url:c()+"/rest/activity-stream/1.0/preferences",dataType:"json",success:function(e,t){o.setDatePrefs(e);AJS.$(document).trigger("preferencesLoaded.streams")},complete:function(){if(!n.loadedDateLibrary){var e=c()+"/download/resources/com.atlassian.streams.streams-jira-plugin:date-"+n.API.getContext().user.languageTag+"/date.js";p.getScript(e).done(function(e,t){n.loadedDateLibrary=!0;p(document).trigger("dateLocalizationLoaded.streams");r()}).fail(function(e,t,r){console.error("Cannot get date.js for i18n: ",r);a()})}}})}).finally(function(){var e=D(decodeURIComponent(t.title));this.stream=ActivityStreams.stream({id:n.API.getGadgetId(),gadgetElement:r,baseUrl:c(),maxResults:t.numofentries,container:r,title:e,hideHeader:n.API&&n.API.view&&"issueTab"===n.API.view||!t.titleRequired,preferences:t,metrics:a,loaded:function(){l.call(n);if(1===n.rendered){a.report("View");n.rendered+=1}},resized:function(){n.API.resize()}})})};t.prototype.renderEdit=function(e,t){var s=this,o=p(e),u=JSON.parse(JSON.stringify(t)),t=D(decodeURIComponent(u.title));u.title=t;u&&u.rules&&(u.rules=JSON.parse(decodeURIComponent(u.rules)));u&&u.rules&&u.rules.providers&&u.rules.providers.forEach(function(e){e.rules=e.rules.map(function(e){e.type===s.constants.DATE&&e.operator===s.constants.BETWEEN&&(e.value=e.value.split(s.constants.SINGLE_SPACE));return e})});s.API.showLoadingBar();s.API.setTitle("Activity Stream");var r=p.ajax(c()+"/rest/activity-stream/1.0/config"),t=c()+"/download/resources/com.atlassian.streams.streams-jira-plugin:date-"+s.API.getContext().user.languageTag+"/date.js";p.getScript(t).done(function(){p(document).trigger("dateLocalizationLoaded.streams");p.when(r).done(function(e){var t=JSON.parse(JSON.stringify(e)),n=u&&u.rules&&u.rules.providers&&u.rules.providers.findIndex(function(e){return"streams"===e.provider}),r=0===n||0<n?u.rules.providers[n].rules:[],e=r.find(function(e){return"account-id"===e.rule}),i=r.find(function(e){return"user"===e.rule});if(!e&&i){e=v(i.value);return p.ajax({type:"get",url:c()+"/rest/api/3/user/bulk/migration?maxResults="+e.length+e.map(function(e){return"&username="+e}).join(""),dataType:"json",success:function(e){var r=e.filter(function(e){return e.accountId&&"unknown"!==e.accountId}),a=e.filter(function(e){return!e.accountId||"unknown"===e.accountId});u.rules.providers[n].rules=u.rules.providers[n].rules.reduce(function(e,t){if("user"===t.rule){a.length&&e.push(Object.assign({},t,{value:a.map(function(e){return e.username}).join(" ").trim()}));e.push({rule:"account-id",operator:i.operator,value:r.map(function(e){return e.accountId}).join(" ").trim(),type:"account-id"})}else e.push(t);return e},[]);a.length||(t.filters=t.filters.map(function(e){return"streams"===e.key?Object.assign({},e,{options:e.options.filter(function(e){return"user"!==e.key})}):e}));return M.bind(s,o,u,t)()}})}t.filters=t.filters.map(function(e){return"streams"===e.key?Object.assign({},e,{options:e.options.filter(function(e){return"user"!==e.key})}):e});return M.bind(s,o,u,t)()}).fail(f.partial(a,o)).always(f.bind(l,s))})};return t});;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-class-names', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/class-names.js' */
("undefined"===typeof window?global:window).__17e04bba0bef0009cc832216dc2470d2=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default={NO_VALUE:"aui-restfultable-editable-no-value",NO_ENTRIES:"aui-restfultable-no-entires",RESTFUL_TABLE:"aui-restfultable",ROW:"aui-restfultable-row",READ_ONLY:"aui-restfultable-readonly",ACTIVE:"aui-restfultable-active",ALLOW_HOVER:"aui-restfultable-allowhover",FOCUSED:"aui-restfultable-focused",MOVEABLE:"aui-restfultable-movable",
DISABLED:"aui-restfultable-disabled",SUBMIT:"aui-restfultable-submit",CANCEL:"aui-restfultable-cancel",EDIT_ROW:"aui-restfultable-editrow",CREATE:"aui-restfultable-create",DRAG_HANDLE:"aui-restfultable-draghandle",ORDER:"aui-restfultable-order",EDITABLE:"aui-restfultable-editable",ERROR:"error",DELETE:"aui-restfultable-delete",LOADING:"loading"};return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-custom-create-view', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/custom-create-view.js' */
("undefined"===typeof window?global:window).__226d5785d36c6f3d2eaa19d9b986ea68=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});var b=__e3ce9f42f29f6bd2118d84461512f4a4;a.default=(b&&b.__esModule?b:{"default":b}).default.View;return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-custom-edit-view', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/custom-edit-view.js' */
("undefined"===typeof window?global:window).__a88f71998f64176b4467b73bf7f68708=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});var b=__e3ce9f42f29f6bd2118d84461512f4a4;a.default=(b&&b.__esModule?b:{"default":b}).default.View;return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-custom-read-view', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/custom-read-view.js' */
("undefined"===typeof window?global:window).__54897143fc7cd42cd80d313dd2bfdf55=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});var b=__e3ce9f42f29f6bd2118d84461512f4a4;a.default=(b&&b.__esModule?b:{"default":b}).default.View;return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-data-keys', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/data-keys.js' */
("undefined"===typeof window?global:window).__b68b83266eb028cf402de39c4933799b=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default={ENABLED_SUBMIT:"enabledSubmit",ROW_VIEW:"RestfulTable_Row_View"};return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-vendor-jquery-serializetoobject', location = 'auiplugin/node_modules/@atlassian/aui/src/js-vendor/jquery/serializetoobject.js' */
("undefined"===typeof window?global:window).__c972538512dcf935ab0c75d63e2e3cff=function(){jQuery.fn.serializeObject=function(){var a={};this.find(":input:not(:button):not(:submit):not(:radio):not('select[multiple]')").each(function(){""!==this.name&&(null===this.value&&(this.value=""),a[this.name]=this.value.match(/^(tru|fals)e$/i)?"true"==this.value.toLowerCase():this.value)});this.find("input:radio:checked").each(function(){a[this.name]=this.value});this.find("select[multiple]").each(function(){var c=
jQuery(this),b=c.val();a[this.name]=c.data("aui-ss")?b?b[0]:"":null!==b?b:[]});return a};return{}}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-events', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/events.js' */
("undefined"===typeof window?global:window).__f9e062e0834111cb42fed4e788d40075=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default={REORDER_SUCCESS:"RestfulTable.reorderSuccess",ROW_ADDED:"RestfulTable.rowAdded",ROW_REMOVED:"RestfulTable.rowRemoved",EDIT_ROW:"RestfulTable.switchedToEditMode",SERVER_ERROR:"RestfulTable.serverError",CREATED:"created",UPDATED:"updated",FOCUS:"focus",BLUR:"blur",SUBMIT:"submit",SAVE:"save",MODAL:"modal",MODELESS:"modeless",CANCEL:"cancel",
CONTENT_REFRESHED:"contentRefreshed",RENDER:"render",FINISHED_EDITING:"finishedEditing",VALIDATION_ERROR:"validationError",SUBMIT_STARTED:"submitStarted",SUBMIT_FINISHED:"submitFinished",INITIALIZED:"initialized",ROW_INITIALIZED:"rowInitialized",ROW_EDIT:"editRow"};return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-throbber', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/throbber.js' */
("undefined"===typeof window?global:window).__f736a94af005df464b5cb85d70aeb4be=function(){var a={};"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=function(){return'<span class="aui-restfultable-throbber"></span>'};return a=a["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-edit-row', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/edit-row.js' */
("undefined"===typeof window?global:window).__306e5d088ae3093bce3a4ccc028d1000=function(){function f(a){return a&&a.__esModule?a:{"default":a}}var g={};"use strict";Object.defineProperty(g,"__esModule",{value:!0});var j="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},c=f(__307d3e18fd611f85395c67cddeb1fe24);__c972538512dcf935ab0c75d63e2e3cff;var k=
f(__e3ce9f42f29f6bd2118d84461512f4a4),l=f(__17e04bba0bef0009cc832216dc2470d2),m=f(__b68b83266eb028cf402de39c4933799b),n=f(__f9e062e0834111cb42fed4e788d40075);f(__d74c881c8f23921c15438d0f30c99f80);var o=f(__f736a94af005df464b5cb85d70aeb4be);g.default=k.default.View.extend({tagName:"tr",events:{focusin:"_focus",click:"_focus",keyup:"_handleKeyUpEvent"},initialize:function(a){this.$el=(0,c.default)(this.el);this._event=n.default;this.classNames=l.default;this.dataKeys=m.default;this.columns=a.columns;
this.isCreateRow=a.isCreateRow;this.allowReorder=a.allowReorder;this.events["click ."+this.classNames.CANCEL]="_cancel";this.delegateEvents();a.isUpdateMode?this.isUpdateMode=!0:(this._modelClass=a.model,this.model=new this._modelClass);this.fieldFocusSelector=a.fieldFocusSelector;this.bind(this._event.CANCEL,function(){this.disabled=true}).bind(this._event.SAVE,function(a){this.disabled||this.submit(a)}).bind(this._event.FOCUS,function(a){this.focus(a)}).bind(this._event.BLUR,function(){this.$el.removeClass(this.classNames.FOCUSED);
this.disable()}).bind(this._event.SUBMIT_STARTED,function(){this._submitStarted()}).bind(this._event.SUBMIT_FINISHED,function(){this._submitFinished()})},defaultColumnRenderer:function(a){if(!1!==a.allowEdit)return(0,c.default)("<input type='text' />").addClass("text").attr({name:a.name,value:a.value});if(a.value)return document.createTextNode(a.value)},renderDragHandle:function(){return'<span class="'+this.classNames.DRAG_HANDLE+'"></span></td>'},_handleKeyUpEvent:function(a){27===a.keyCode&&this.trigger(this._event.CANCEL)},
_cancel:function(a){this.trigger(this._event.CANCEL);a.preventDefault();return this},_submitStarted:function(){this.submitting=!0;this.showLoading().disable().delegateEvents({});return this},_submitFinished:function(){this.submitting=!1;this.hideLoading().enable().delegateEvents(this.events);return this},_focus:function(a){this.hasFocus()||this.trigger(this._event.FOCUS,a.target.name);return this},hasFocus:function(){return this.$el.hasClass(this.classNames.FOCUSED)},focus:function(a){this.enable();
a?a=this.$el.find(this.fieldFocusSelector(a)):(a=this.$el.find(this.classNames.ERROR+":first"),a=0===a.length?this.$el.find(":input:text:first"):a.parent().find(":input"));this.$el.addClass(this.classNames.FOCUSED);a.focus().trigger("select");return this},disable:function(){var a,b;c.default.browser.mozilla&&(b=this.$el.find(":submit"),b.length&&(a=(0,c.default)("<input type='submit' class='"+this.classNames.SUBMIT+"' />").addClass(b.attr("class")).val(b.val()).data(this.dataKeys.ENABLED_SUBMIT,b),
b.replaceWith(a)));this.$el.addClass(this.classNames.DISABLED).find(":submit").attr("disabled","disabled");return this},enable:function(){var a,b;c.default.browser.mozilla&&(a=this.$el.find(this.classNames.SUBMIT),(b=a.data(this.dataKeys.ENABLED_SUBMIT))&&a.length&&a.replaceWith(b));this.$el.removeClass(this.classNames.DISABLED).find(":submit").removeAttr("disabled");return this},showLoading:function(){this.$el.addClass(this.classNames.LOADING);return this},hideLoading:function(){this.$el.removeClass(this.classNames.LOADING);
return this},hasUpdates:function(){return!!this.mapSubmitParams(this.serializeObject())},serializeObject:function(){var a=this.$el;return a.serializeObject?a.serializeObject():a.serialize()},mapSubmitParams:function(a){return this.model.changedAttributes(a)},submit:function(a){var b=this,h;document.activeElement!==window&&(0,c.default)(document.activeElement).blur();if(this.isUpdateMode){if(h=this.mapSubmitParams(this.serializeObject()),!h)return b.trigger(b._event.CANCEL)}else this.model.clear(),
h=this.mapSubmitParams(this.serializeObject());this.trigger(this._event.SUBMIT_STARTED);this.model.save(h,{success:function(){b.isUpdateMode?b.trigger(b._event.UPDATED,b.model,a):(b.trigger(b._event.CREATED,b.model.toJSON()),b.model=new b._modelClass,b.render({errors:{},values:{}}),b.trigger(b._event.FOCUS));b.trigger(b._event.SUBMIT_FINISHED)},error:function(a,c,h){400===h.status&&(b.renderErrors(c.errors),b.trigger(b._event.VALIDATION_ERROR,c.errors));b.trigger(b._event.SUBMIT_FINISHED)},silent:!0});
return this},renderError:function(a,b){return(0,c.default)("<div />").attr("data-field",a).addClass(this.classNames.ERROR).text(b)},renderErrors:function(a){var b=this;this.$("."+this.classNames.ERROR).remove();a&&c.default.each(a,function(a,c){b.$el.find("[name='"+a+"']").closest("td").append(b.renderError(a,c))});return this},render:function(a){var b=this;this.$el.empty();this.allowReorder&&(0,c.default)('<td  class="'+this.classNames.ORDER+'" />').append(this.renderDragHandle()).appendTo(b.$el);
c.default.each(this.columns,function(f,d){var e,i;e=a.values[d.id];var g=[{name:d.id,value:e,allowEdit:d.allowEdit},a.values,b.model];e&&b.$el.attr("data-"+d.id,e);e=b.isCreateRow&&d.createView?(new d.createView({model:b.model})).render(g[0]):d.editView?(new d.editView({model:b.model})).render(g[0]):b.defaultColumnRenderer.apply(b,g);i=(0,c.default)("<td />");"object"===("undefined"===typeof e?"undefined":j(e))&&e.done?e.done(function(a){i.append(a)}):i.append(e);d.styleClass&&i.addClass(d.styleClass);
i.appendTo(b.$el)});this.$el.append(this.renderOperations(a.update,a.values)).addClass(this.classNames.ROW+" "+this.classNames.EDIT_ROW);this.trigger(this._event.RENDER,this.$el,a.values);this.$el.trigger(this._event.CONTENT_REFRESHED,[this.$el]);return this},renderOperations:function(a){var b=(0,c.default)('<td class="aui-restfultable-operations" />');a?b.append((0,c.default)('<input class="aui-button" type="submit" />').attr({accesskey:this.submitAccessKey,value:"Update"})).append((0,
c.default)('<a class="aui-button aui-button-link" href="#" />').addClass(this.classNames.CANCEL).text("Cancel").attr({accesskey:this.cancelAccessKey})):b.append((0,c.default)('<input class="aui-button" type="submit" />').attr({accesskey:this.submitAccessKey,value:"Add"}));return b.add((0,c.default)('<td class="aui-restfultable-status" />').append((0,o.default)()))}});return g=g["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-events', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/events.js' */
("undefined"===typeof window?global:window).__1a99a68c34e660050a094f87fb28903d=function(){function g(a){return a&&a.__esModule?a:{"default":a}}function d(a,b){(0,h.default)(j.default).trigger(a,b)}function e(a,b){(0,h.default)(j.default).bind(a,b)}function f(a,b,c){(0,h.default)(b).trigger(a,c);d(a,c);b.id&&d(b.id+"-"+a,c)}var b={};"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.triggerEvtForInst=b.triggerEvt=b.bindEvt=void 0;var h=g(__307d3e18fd611f85395c67cddeb1fe24),a;a=__c8cfa00f1eba9ac7af89ee3d0d33961d;
if(!a||!a.__esModule){var c={};if(null!=a)for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(c[i]=a[i]);c.default=a;a=c}var j=g(__fd277fcde858b82a198666a405e85600),c=g(__4d02fe17b8e885a34493e34af3d145dd);b.bindEvt=e=a.fn(e,"bindEvt",{sinceVersion:"5.8.0"});b.triggerEvt=d=a.fn(d,"triggerEvt",{sinceVersion:"5.8.0"});b.triggerEvtForInst=f=a.fn(f,"triggerEvtForInst",{sinceVersion:"5.8.0"});(0,c.default)("bindEvt",e);(0,c.default)("triggerEvt",d);(0,c.default)("triggerEvtForInst",f);b.bindEvt=
e;b.triggerEvt=d;b.triggerEvtForInst=f;return b}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-entry-model', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/entry-model.js' */
("undefined"===typeof window?global:window).__928a2470c59a6ae17c3b26224648a948=function(){function f(a){return a&&a.__esModule?a:{"default":a}}var i={};"use strict";Object.defineProperty(i,"__esModule",{value:!0});var l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=f(__307d3e18fd611f85395c67cddeb1fe24),m=__1a99a68c34e660050a094f87fb28903d,
j=f(__922acd0053a6de3ea4c53d8902766ab6),h=f(__e3ce9f42f29f6bd2118d84461512f4a4),n=f(__f9e062e0834111cb42fed4e788d40075),k=h.default.Model.extend({sync:function(a,b,d){var e=this,c=d.error;d.error=function(a){e._serverErrorHandler(a,this);c&&c.apply(this,arguments)};return h.default.sync.apply(h.default,arguments)},save:function(a,b){var b=b||{},d=this,e,c=b.error,f=b.success;b.error=function(a,b){var e=g.default.parseJSON(b.responseText||b.data);c&&c.call(d,d,e,b)};this.isNew()?h.default.Model.prototype.save.call(this,
a,b):a&&(e=k.extend({url:this.url()}),e=new e({id:this.id}),e.save=h.default.Model.prototype.save,b.success=function(a,b){d.clear().set(a.toJSON());f&&f.call(d,d,b)},e.save(a,b))},destroy:function(a){var a=a||{},b=this,d=this.url(),e;a.data&&(e=g.default.param(a.data));""!==e&&(d=d+"?"+e);g.default.ajax({url:d,type:"DELETE",dataType:"json",contentType:"application/json",success:function(c){b.collection&&b.collection.remove(b);a.success&&a.success.call(b,c)},error:function(c){b._serverErrorHandler(c,
this);a.error&&a.error.call(b,c)}});return this},changedAttributes:function(a){var b={},d=this.toJSON();g.default.each(a,function(a,c){d[a]?d[a]&&d[a]!==c&&("object"===("undefined"===typeof c?"undefined":l(c))?j.default.isEqual(c,d[a])||(b[a]=c):b[a]=c):"string"===typeof c?""!==g.default.trim(c)&&(b[a]=c):g.default.isArray(c)?0!==c.length&&(b[a]=c):b[a]=c});if(!j.default.isEmpty(b))return this.addExpand(b),b},addExpand:function(){},_serverErrorHandler:function(a,b){var d;400!==a.status&&(d=g.default.parseJSON(a.responseText||
a.data),(0,m.triggerEvtForInst)(n.default.SERVER_ERROR,this,[d,a,b]))},fetch:function(a){a=a||{};this.clear();h.default.Model.prototype.fetch.call(this,a)}});i.default=k;return i=i["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table-row', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table/row.js' */
("undefined"===typeof window?global:window).__db1289144ca525c25c4d90561fcced7d=function(){function e(a){return a&&a.__esModule?a:{"default":a}}var h={};"use strict";Object.defineProperty(h,"__esModule",{value:!0});var b=e(__307d3e18fd611f85395c67cddeb1fe24),j;var c=__8eca5e5171c0c22be18ea931ed65c747;if(c&&c.__esModule)j=c;else{var k={};if(null!=c)for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(k[d]=c[d]);k.default=c;j=k}d=e(__e3ce9f42f29f6bd2118d84461512f4a4);var l=e(__17e04bba0bef0009cc832216dc2470d2),
m=e(__b68b83266eb028cf402de39c4933799b),n=e(__f9e062e0834111cb42fed4e788d40075);e(__d74c881c8f23921c15438d0f30c99f80);var o=e(__f736a94af005df464b5cb85d70aeb4be);h.default=d.default.View.extend({tagName:"tr",events:{"click .aui-restfultable-editable":"edit"},initialize:function(a){a=a||{};this._event=n.default;this.classNames=l.default;this.dataKeys=m.default;this.columns=a.columns;this.allowEdit=a.allowEdit;this.allowDelete=a.allowDelete;if(!this.events["click .aui-restfultable-editable"])throw Error("It appears you have overridden the events property. To add events you will need to usea work around. https://github.com/documentcloud/backbone/issues/244");
this.index=a.index||0;this.deleteConfirmation=a.deleteConfirmation;this.allowReorder=a.allowReorder;this.$el=(0,b.default)(this.el);this.bind(this._event.CANCEL,function(){this.disabled=!0}).bind(this._event.FOCUS,function(a){this.focus(a)}).bind(this._event.BLUR,function(){this.unfocus()}).bind(this._event.MODAL,function(){this.$el.addClass(this.classNames.ACTIVE)}).bind(this._event.MODELESS,function(){this.$el.removeClass(this.classNames.ACTIVE)})},renderDragHandle:function(){return'<span class="'+
this.classNames.DRAG_HANDLE+'"></span></td>'},defaultColumnRenderer:function(a){if(a.value)return document.createTextNode(a.value.toString())},sync:function(a){var b=this;this.model.addExpand(a);this.showLoading();this.model.save(a,{success:function(){b.hideLoading().render();b.trigger(b._event.UPDATED)},error:function(){b.hideLoading()}});return this},refresh:function(a,b){var c=this;this.showLoading();this.model.fetch({success:function(){c.hideLoading().render();a&&a.apply(this,arguments)},error:function(){c.hideLoading();
b&&b.apply(this,arguments)}});return this},hasFocus:function(){return this.$el.hasClass(this.classNames.FOCUSED)},focus:function(){(0,b.default)(this.el).addClass(this.classNames.FOCUSED);return this},unfocus:function(){(0,b.default)(this.el).removeClass(this.classNames.FOCUSED);return this},showLoading:function(){this.$el.addClass(this.classNames.LOADING);return this},hideLoading:function(){this.$el.removeClass(this.classNames.LOADING);return this},edit:function(a){a=(0,b.default)(a.target).is("."+
this.classNames.EDITABLE)?(0,b.default)(a.target).attr("data-field-name"):(0,b.default)(a.target).closest("."+this.classNames.EDITABLE).attr("data-field-name");this.trigger(this._event.ROW_EDIT,a);return this},renderOperations:function(){var a=this;if(!1!==this.allowDelete)return(0,b.default)("<a href='#' class='aui-button' />").addClass(this.classNames.DELETE).text("Delete").click(function(b){b.preventDefault();a.destroy()})},destroy:function(){if(this.deleteConfirmation){var a=
j.popup(400,200,"delete-entity-"+this.model.get("id"));a.element.html(this.deleteConfirmation(this.model.toJSON()));a.show();a.element.find(".cancel").click(function(){a.hide()});a.element.find("form").submit(_.bind(function(b){a.hide();this.model.destroy();b.preventDefault()},this))}else this.model.destroy()},render:function(){var a=this,c=this.model.toJSON(),e=(0,b.default)("<td class='aui-restfultable-operations' />").append(this.renderOperations({},c)),d=(0,b.default)("<td class='aui-restfultable-status' />").append((0,
o.default)());this.$el.removeClass(this.classNames.DISABLED+" "+this.classNames.FOCUSED+" "+this.classNames.LOADING+" "+this.classNames.EDIT_ROW).addClass(this.classNames.READ_ONLY).empty();this.allowReorder&&(0,b.default)('<td  class="'+this.classNames.ORDER+'" />').append(this.renderDragHandle()).appendTo(a.$el);this.$el.attr("data-id",this.model.id);b.default.each(this.columns,function(e,f){var g,d=(0,b.default)("<td />");g=c[f.id];var i=f.fieldName||f.id,h=[{name:i,value:g,allowEdit:f.allowEdit},
c,a.model];g&&a.$el.attr("data-"+f.id,g);g=f.readView?(new f.readView({model:a.model})).render(h[0]):a.defaultColumnRenderer.apply(a,h);if(!1!==a.allowEdit&&!1!==f.allowEdit){if(i=(0,b.default)("<span />").addClass(a.classNames.EDITABLE).append('<span class="aui-icon aui-icon-small aui-iconfont-edit"></span>').append(g).attr("data-field-name",i),d=(0,b.default)("<td />").append(i).appendTo(a.$el),!g||""==b.default.trim(g))d.addClass(a.classNames.NO_VALUE),i.html((0,b.default)("<em />").text(this.emptyText||
"Enter value"))}else d.append(g);f.styleClass&&d.addClass(f.styleClass);d.appendTo(a.$el)});this.$el.append(e).append(d).addClass(this.classNames.ROW+" "+this.classNames.READ_ONLY);this.trigger(this._event.RENDER,this.$el,c);this.$el.trigger(this._event.CONTENT_REFRESHED,[this.$el]);return this}});return h=h["default"]}.call(this);;
;
/* module-key = 'com.atlassian.auiplugin:internal-@atlassian-aui-src-js-aui-restful-table', location = 'auiplugin/node_modules/@atlassian/aui/src/js/aui/restful-table.js' */
("undefined"===typeof window?global:window).__abf29ef092b15abcf6c6c04fa65a04b4=function(){function f(a){return a&&a.__esModule?a:{"default":a}}function l(a,b,c){(0,e.default)(b).trigger(a,c);(0,e.default)(document).trigger(a,c);b.id&&(a=b.id+"_"+a,(0,e.default)(document).trigger(a,c))}var m={};"use strict";Object.defineProperty(m,"__esModule",{value:!0});var e=f(__307d3e18fd611f85395c67cddeb1fe24),n;var h=__cf890abdf040e0993fb71f2f839bc972;if(h&&h.__esModule)n=h;else{var j={};if(null!=h)for(var k in h)Object.prototype.hasOwnProperty.call(h,
k)&&(j[k]=h[k]);j.default=h;n=j}var o=f(__e3ce9f42f29f6bd2118d84461512f4a4),r=f(__17e04bba0bef0009cc832216dc2470d2);k=f(__226d5785d36c6f3d2eaa19d9b986ea68);var h=f(__a88f71998f64176b4467b73bf7f68708),j=f(__54897143fc7cd42cd80d313dd2bfdf55),s=f(__b68b83266eb028cf402de39c4933799b),t=f(__306e5d088ae3093bce3a4ccc028d1000),p=f(__928a2470c59a6ae17c3b26224648a948),u=f(__f9e062e0834111cb42fed4e788d40075),w=f(__4d02fe17b8e885a34493e34af3d145dd);f(__d74c881c8f23921c15438d0f30c99f80);var q=f(__db1289144ca525c25c4d90561fcced7d),
v=f(__f736a94af005df464b5cb85d70aeb4be),g=o.default.View.extend({initialize:function(a){var b=this;b.options=e.default.extend(!0,b._getDefaultOptions(a),a);b.id=this.options.id;b._event=u.default;b.classNames=r.default;b.dataKeys=s.default;this.$table=(0,e.default)(a.el).addClass(this.classNames.RESTFUL_TABLE).addClass(this.classNames.ALLOW_HOVER).addClass("aui").addClass(b.classNames.LOADING);this.$table.wrapAll("<form class='aui' action='#' />");this.$thead=(0,e.default)("<thead/>");this.$theadRow=
(0,e.default)("<tr />").appendTo(this.$thead);this.$tbody=(0,e.default)("<tbody/>");if(!this.$table.length)throw Error("RestfulTable: Init failed! The table you have specified ["+this.$table.selector+"] cannot be found.");if(!this.options.columns)throw Error("RestfulTable: Init failed! You haven't provided any columns to render.");this.showGlobalLoading();this.options.columns.forEach(function(a){var d=e.default.isFunction(a.header)?a.header():a.header;"undefined"===typeof d&&(n.warn("You have not specified [header] for column ["+
a.id+"]. Using id for now..."),d=a.id);b.$theadRow.append("<th>"+d+"</th>")});b.$theadRow.append("<th></th><th></th>");this._models=this._createCollection();this._rowClass=this.options.views.row;this.editRows=[];this.$table.closest("form").submit(function(a){b.focusedRow&&b.focusedRow.trigger(b._event.SAVE);a.preventDefault()});this.options.allowReorder&&(this.$theadRow.prepend("<th />"),this.$tbody.sortable({handle:"."+this.classNames.DRAG_HANDLE,helper:function(a,d){var i=(0,e.default)("<div/>").attr("class",
d.attr("class")).addClass(b.classNames.MOVEABLE);d.children().each(function(){var a=(0,e.default)(this),b=parseInt(0+a.css("border-left-width"),10),c=parseInt(0+a.css("border-right-width"),10),b=a[0].clientWidth+b+c;i.append((0,e.default)("<div/>").html(a.html()).attr("class",a.attr("class")).width(b))});i=(0,e.default)("<div class='aui-restfultable-readonly'/>").append(i);i.css({left:d.offset().left});i.appendTo(document.body);return i},start:function(a,d){var i=d.helper[0].clientHeight,f=d.placeholder.find("td");
d.item.addClass(b.classNames.MOVEABLE).children().each(function(a){(0,e.default)(this).width(f.eq(a).width())});var g='<td colspan="'+b.getColumnCount()+'">&nbsp;</td>';d.placeholder.html(g).css({height:i,visibility:"visible"});b.getRowFromElement(d.item[0]).trigger(b._event.MODAL)},stop:function(a,d){if((0,e.default)(d.item[0]).is(":visible"))d.item.removeClass(b.classNames.MOVEABLE).children().attr("style",""),d.placeholder.removeClass(b.classNames.ROW),b.getRowFromElement(d.item[0]).trigger(b._event.MODELESS)},
update:function(a,d){var e={row:b.getRowFromElement(d.item[0]),item:d.item,nextItem:d.item.next(),prevItem:d.item.prev()};b.move(e)},axis:"y",delay:0,containment:"document",cursor:"move",scroll:!0,zIndex:8E3}),this.$tbody.bind("selectstart mousedown",function(a){return!(0,e.default)(a.target).is("."+b.classNames.DRAG_HANDLE)}));!1!==this.options.allowCreate&&(this._createRow=(new this.options.views.editRow({columns:this.options.columns,isCreateRow:!0,model:this.options.model.extend({url:function(){return b.options.resources.self}}),
cancelAccessKey:this.options.cancelAccessKey,submitAccessKey:this.options.submitAccessKey,allowReorder:this.options.allowReorder,fieldFocusSelector:this.options.fieldFocusSelector})).bind(this._event.CREATED,function(a){b.options.addPosition==void 0&&b.options.createPosition==="bottom"||b.options.addPosition==="bottom"?b.addRow(a):b.addRow(a,0)}).bind(this._event.VALIDATION_ERROR,function(){this.trigger(b._event.FOCUS)}).render({errors:{},values:{}}),this.$create=(0,e.default)('<tbody class="'+this.classNames.CREATE+
'" />').append(this._createRow.el),this._applyFocusCoordinator(this._createRow),this._createRow.trigger(this._event.FOCUS));this._models.bind("remove",function(a){b.getRows().forEach(function(d){if(d.model===a){d.hasFocus()&&b._createRow&&b._createRow.trigger(b._event.FOCUS);b.removeRow(d)}})});this.fetchInitialResources()},fetchInitialResources:function(){var a=this;e.default.isFunction(this.options.resources.all)?this.options.resources.all(function(b){a.populate(b)}):e.default.get(this.options.resources.all,
function(b){a.populate(b)})},move:function(a){var b=this,c=function(a){return a.length?{after:b.getRowFromElement(a).model.url()}:{position:"First"}};a.row&&(c=b.options.reverseOrder?c(a.nextItem):c(a.prevItem),e.default.ajax({url:a.row.model.url()+"/move",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(c),complete:function(){a.row.hideLoading()},success:function(a){AJS.triggerEvtForInst(b._event.REORDER_SUCCESS,b,[a])},error:function(a){var c=e.default.parseJSON(a.responseText||
a.data);AJS.triggerEvtForInst(b._event.SERVER_ERROR,b,[c,a,this])}}),a.row.showLoading())},_createCollection:function(){var a=this;return new (this.options.Collection.extend({sort:function(b){b||(b={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");this.tableRows=a.getRows();this.models=this.sortBy(this.comparator);this.tableRows=void 0;b.silent||this.trigger("refresh",this,b);return this},remove:function(b,c){this.tableRows=a.getRows();o.default.Collection.prototype.remove.apply(this,
arguments);this.tableRows=void 0;return this}}))([],{comparator:function(b){var c;(void 0!==this.tableRows?this.tableRows:a.getRows()).some(function(a,e){if(a.model.id===b.id)return c=e,!0});return c}})},populate:function(a){this.options.reverseOrder&&a.reverse();this.hideGlobalLoading();a&&a.length?(this._models.reset([],{silent:!0}),this.renderRows(a),this.isEmpty()&&this.showNoEntriesMsg()):this.showNoEntriesMsg();this.$table.append(this.$thead);"bottom"===this.options.createPosition?this.$table.append(this.$tbody).append(this.$create):
this.$table.append(this.$create).append(this.$tbody);this.$table.removeClass(this.classNames.LOADING).trigger(this._event.INITIALIZED,[this]);l(this._event.INITIALIZED,this,[this]);this.options.autoFocus&&this.$table.find(":input:text:first").focus()},showGlobalLoading:function(){this.$loading||(this.$loading=(0,e.default)('<div class="aui-restfultable-init">'+(0,v.default)()+'<span class="aui-restfultable-loading">'+this.options.loadingMsg+"</span></div>"));this.$loading.is(":visible")||this.$loading.insertAfter(this.$table);
return this},hideGlobalLoading:function(){this.$loading&&this.$loading.remove();return this},addRow:function(a,b){var c,d;if(!a.id)throw Error("RestfulTable.addRow: to add a row values object must contain an id. Maybe you are not returning it from your restend point?Recieved:"+JSON.stringify(a));d=new this.options.model(a);c=this._renderRow(d,b);this._models.add(d);this.removeNoEntriesMsg();l(this._event.ROW_ADDED,this,[c,this]);return this},removeRow:function(a){this._models.remove(a.model);a.remove();
this.isEmpty()&&this.showNoEntriesMsg();l(this._event.ROW_REMOVED,this,[a,this])},isEmpty:function(){return 0===this._models.length},getModels:function(){return this._models},getTable:function(){return this.$table},getTableBody:function(){return this.$tbody},getCreateRow:function(){return this._createRow},getColumnCount:function(){var a=2;this.allowReorder&&++a;return this.options.columns.length+a},getRowFromElement:function(a){return(0,e.default)(a).data(this.dataKeys.ROW_VIEW)},showNoEntriesMsg:function(){this.$noEntries&&
this.$noEntries.remove();this.$noEntries=(0,e.default)("<tr>").addClass(this.classNames.NO_ENTRIES).append((0,e.default)("<td>").attr("colspan",this.getColumnCount()).text(this.options.noEntriesMsg)).appendTo(this.$tbody);return this},removeNoEntriesMsg:function(){this.$noEntries&&0<this._models.length&&this.$noEntries.remove();return this},getRows:function(){var a=this,b=[];this.$tbody.find("."+this.classNames.READ_ONLY).each(function(){var c=(0,e.default)(this).data(a.dataKeys.ROW_VIEW);c&&b.push(c)});
return b},_renderRow:function(a,b){var c=this,d=this.$tbody.find("."+this.classNames.READ_ONLY),e,f;f=new this._rowClass({model:a,columns:this.options.columns,allowEdit:this.options.allowEdit,allowDelete:this.options.allowDelete,allowReorder:this.options.allowReorder,deleteConfirmation:this.options.deleteConfirmation});this.removeNoEntriesMsg();f.bind(this._event.ROW_EDIT,function(a){l(this._event.EDIT_ROW,{},[this,c]);c.edit(this,a)});e=f.render().$el;-1!==b&&("number"===typeof b&&0!==d.length?e.insertBefore(d[b]):
this.$tbody.append(e));e.data(this.dataKeys.ROW_VIEW,f);f.bind(this._event.MODAL,function(){c.$table.removeClass(c.classNames.ALLOW_HOVER);c.$tbody.sortable("disable");c.getRows().forEach(function(a){c.isRowBeingEdited(a)||a.delegateEvents({})})});f.bind(this._event.MODELESS,function(){c.$table.addClass(c.classNames.ALLOW_HOVER);c.$tbody.sortable("enable");c.getRows().forEach(function(a){c.isRowBeingEdited(a)||a.delegateEvents()})});this._applyFocusCoordinator(f);this.trigger(this._event.ROW_INITIALIZED,
f);return f},isRowBeingEdited:function(a){var b=!1;this.editRows.some(function(c){if(c.el===a.el)return b=!0});return b},_applyFocusCoordinator:function(a){var b=this;a.hasFocusBound||(a.hasFocusBound=!0,a.bind(this._event.FOCUS,function(){b.focusedRow&&b.focusedRow!==a&&b.focusedRow.trigger(b._event.BLUR);b.focusedRow=a;a instanceof q.default&&b._createRow&&b._createRow.enable()}));return this},_removeEditRow:function(a){a=e.default.inArray(a,this.editRows);this.editRows.splice(a,1);return this},
_shiftFocusAfterEdit:function(){0<this.editRows.length?this.editRows[this.editRows.length-1].trigger(this._event.FOCUS):this._createRow&&this._createRow.trigger(this._event.FOCUS);return this},_saveEditRowOnBlur:function(){return 1>=this.editRows.length},dismissEditRows:function(){this.editRows.forEach(function(a){a.hasUpdates()||a.trigger(this._event.FINISHED_EDITING)},this)},edit:function(a,b){var c=this,d=new this.options.views.editRow({el:a.el,columns:this.options.columns,isUpdateMode:!0,allowReorder:this.options.allowReorder,
fieldFocusSelector:this.options.fieldFocusSelector,model:a.model,cancelAccessKey:this.options.cancelAccessKey,submitAccessKey:this.options.submitAccessKey}),e=a.model.toJSON();e.update=!0;d.render({errors:{},update:!0,values:e}).bind(c._event.UPDATED,function(b,d){c._removeEditRow(this);this.unbind();a.render().delegateEvents();a.trigger(c._event.UPDATED);!1!==d&&c._shiftFocusAfterEdit()}).bind(c._event.VALIDATION_ERROR,function(){this.trigger(c._event.FOCUS)}).bind(c._event.FINISHED_EDITING,function(){c._removeEditRow(this);
a.render().delegateEvents();this.unbind()}).bind(c._event.CANCEL,function(){c._removeEditRow(this);this.unbind();a.render().delegateEvents();c._shiftFocusAfterEdit()}).bind(c._event.BLUR,function(){c.dismissEditRows();c._saveEditRowOnBlur()&&this.trigger(c._event.SAVE,!1)});this._applyFocusCoordinator(d);d.trigger(c._event.FOCUS,b);c._createRow&&c._createRow.disable();this.editRows.push(d);return d},renderRows:function(a){var b=this._models.comparator,c=[];this._models.comparator=void 0;a=_.map(a,
function(a){a=new this.options.model(a);c.push(this._renderRow(a,-1).el);return a},this);this._models.add(a,{silent:!0});this._models.comparator=b;this.removeNoEntriesMsg();this.$tbody.append(c);return this},_getDefaultOptions:function(a){return{model:a.model||p.default,allowEdit:!0,views:{editRow:t.default,row:q.default},Collection:o.default.Collection.extend({url:a.resources.self,model:a.model||p.default}),allowReorder:!1,fieldFocusSelector:function(a){return":input[name="+a+"], #"+a},loadingMsg:a.loadingMsg||
"Loading"}}});g.ClassNames=r.default;g.CustomCreateView=k.default;g.CustomEditView=h.default;g.CustomReadView=j.default;g.DataKeys=s.default;g.EditRow=t.default;g.EntryModel=p.default;g.Events=u.default;g.Row=q.default;g.Throbber=v.default;(0,w.default)("RestfulTable",g);m.default=g;return m=m["default"]}.call(this);;
;
/* module-key = 'jira.webresources:aui-restfultable-amd-shim', location = '/static/lib/amd-shims/aui-restfultable-amd.js' */
define("aui/restful-table",function(){return AJS.RestfulTable});;
;
/* module-key = 'com.atlassian.jira.gadgets:column-picker-dragndrop', location = 'jira-gadgets-plugin/static/components/columnpicker/column-picker-dragndrop.js' */
define("jira-dashboard-items/components/column-picker-dragndrop",["jquery","jira/util/formatter"],function(d,c){var s,l="grabbed",m="moved",u="dropped",g="cancelled",f="tabbed",p="original-item-idx",b="dnd-grabbed",v="button.picker-option-item",x="ul.ui-sortable",n="columns-to-display-container",y="columns-to-display-container-announcement",T="columns-to-display-container-item-announcement";return{addDragAndDrop:function(t){var e=d("#"+t+n);!function(){d("<div class='assistive'></div>").attr("id",t+T).text("Draggable item. Make sure your screen reader isn\'t in browse mode and press the spacebar to grab.").appendTo(e);s=d("<div class='assistive' aria-live='polite' aria-atomic='true'></div>").attr("id",t+y).appendTo(e)}();e.on("focusin",v,function(e){i(f,d(e.target))});e.on("keydown",v,function(e){var n=d(e.target);switch(e.key){case" ":!function(e,n){o(e);(r(n)?function(e){e.attr("aria-labelledby",e.attr("data-label")+" "+t+T);i(u,e);a(e)}:function(e){e.addClass(b).removeAttr("aria-labelledby");var n=e.closest(x).find(v).index(e);e.attr(p,n);i(l,e)})(n)}(e,n);break;case"ArrowUp":!function(e,n){if(r(n)){const t=n.parent(),a=t.insertBefore(t.prev());a.find(v).focus();i(m,n);o(e)}}(e,n);break;case"ArrowDown":!function(e,n){if(r(n)){const t=n.parent(),a=t.insertAfter(t.next());a.find(v).focus();i(m,n);o(e)}}(e,n);break;case"Escape":!function(e,n){if(r(n)){n.attr("aria-labelledby",n.attr("data-label")+" "+t+T);i(g,n);a(n);o(e)}}(e,n)}});function o(e){e.preventDefault();e.stopPropagation()}function r(e){return e.hasClass(b)}function a(e){e.removeClass(b);e.removeAttr(p)}function i(e,n){var t,a=n.text().trim(),o=Number(n.attr(p))+1,r="Columns to display",i=n.closest(x).find(v).index(n)+1,n=n.closest(x).find(v).length;if(e===l)t=c.format("Element \'\'{0}\'\' grabbed. Current position is {1} of {2} in the \'\'{3}\'\' section. Use the arrow keys to move, the space bar key to drop, and the escape key to cancel the operation.",a,i,n,r);else if(e===m)t=c.format("You have moved \'\'{0}\'\' from position {1} to position {2} in the \'\'{3}\'\' section. Use the arrow keys to move, the space bar key to drop, and the escape key to cancel.",a,o,i,r);else if(e===u)t=c.format("You have dropped \'\'{0}\'\' in the \'\'{1}\'\' section. Final position is {2} of {3}.",a,r,i,n);else if(e===g)t=c.format("You have cancelled. \'\'{0}\'\' has position {1} of {2} in the \'\'{3}\'\' section.",a,i,n,r);else if(e===f){if(!a)return;t=c.format("\'\'{0}\'\' is a draggable item. Make sure your screen reader isn\'\'t in browse mode and press the spacebar to grab.",a)}s.text(t)}}}});;
;
/* module-key = 'com.atlassian.jira.gadgets:column-picker-component', location = 'jira-gadgets-plugin/static/components/columnpicker/ColumnPicker.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.Common&&(JIRA.DashboardItem.Common={}),"undefined"==typeof JIRA.DashboardItem.Common.Config&&(JIRA.DashboardItem.Common.Config={}),"undefined"==typeof JIRA.DashboardItem.Common.Config.Templates&&(JIRA.DashboardItem.Common.Config.Templates={}),JIRA.DashboardItem.Common.Config.Templates.columnPicker=function(e,a){var o="",s=e.id+"-table",t=e.id+"-select",l=e.id+"-picker",n=t+"-description",i=e.prefix+s,m=e.prefix+t,c=e.prefix+l,d=e.prefix+"columns-to-display-container";return o+='<div class="field-group '+soy.$$escapeHtml(s)+' dnd-column">'+(e.isFeatureEnabled?'<label for="'+soy.$$escapeHtml(d)+'" class="dnd-column-header">'+soy.$$escapeHtml("Columns to display")+'<span class="aui-icon icon-required"> '+soy.$$escapeHtml("required")+'</span></label><div id="'+soy.$$escapeHtml(d)+'" class="ab-drag-container"><ul id="'+soy.$$escapeHtml(c)+'" class="grabable ui-sortable"></ul></div>':'<label for="'+soy.$$escapeHtml(i)+'">'+soy.$$escapeHtml("Columns to display")+'<span class="aui-icon icon-required"> '+soy.$$escapeHtml("required")+'</span></label><table class="column-picker-order" id="'+soy.$$escapeHtml(i)+'"></table>')+'<div class="description">'+soy.$$escapeHtml("Drag-drop to reorder the fields.")+'</div><div class="error">'+soy.$$escapeHtml("You must select at least one field.")+'</div></div><div class="field-group '+soy.$$escapeHtml(t)+'"><label for="'+soy.$$escapeHtml(m)+'">'+soy.$$escapeHtml("Add columns to display")+'</label><select class="select" id="'+soy.$$escapeHtml(m)+'" name="'+soy.$$escapeHtml(e.id)+'" aria-describedby="'+soy.$$escapeHtml(n)+'"></select><div id="'+soy.$$escapeHtml(n)+'" class="description">'+soy.$$escapeHtml("Add fields to the list above by selecting them.")+"</div></div>"},JIRA.DashboardItem.Common.Config.Templates.pickerOptionItem=function(e,a){var o="",s=e.prefix+e.columnValue+"-picker-option-label",t=e.prefix+"columns-to-display-container-item-announcement";return o+='<li class="picker-option" data-id="'+soy.$$escapeHtml(e.columnValue)+'" data-label="'+soy.$$escapeHtml(e.columnLabel)+'"><button type="button" class="picker-option-item" aria-labelledby="'+soy.$$escapeHtml(s)+" "+soy.$$escapeHtml(t)+'"><span class="icon-draghandle"></span><span id="'+soy.$$escapeHtml(s)+'">'+soy.$$escapeHtml(e.columnLabel)+"</span></button>"+JIRA.DashboardItem.Common.Config.Templates.deleteColumnButton({columnName:e.columnLabel})+"</li>"},JIRA.DashboardItem.Common.Config.Templates.deleteColumnButton=function(e,a){return'<button class="aui-button aui-button-subtle" aria-label="'+soy.$$escapeHtml(AJS.format("Delete {0}",e.columnName))+'"><span class="aui-icon aui-icon-small aui-iconfont-delete"></span></button>'};;
;
/* module-key = 'com.atlassian.jira.gadgets:column-picker-component', location = 'jira-gadgets-plugin/static/components/columnpicker/ColumnPicker.js' */
define("jira-dashboard-items/components/column-picker",["aui/restful-table","jira/util/formatter","jira/ajs/list/item-descriptor","wrm/context-path","underscore","jquery","jira/ajs/ajax/smart-ajax","jira/ajs/select/single-select","jira/featureflags/feature-manager","jira-dashboard-items/components/column-picker-dragndrop"],function(a,n,o,s,u,i,c,d,l,r){"use strict";function m(e,t){i(e).empty();AJS.messages.error(e,{title:"Error",body:"<p>"+c.buildSimpleErrorContent(t)+"</p>",closeable:!1});i(e).show()}function f(e){return e.find("li").map(function(){return i(this).attr("data-id").replace(/\|/g,"%7C")}).get()}function p(e,t,n){if(f(t).includes(e.value))return t;(e=i(JIRA.DashboardItem.Common.Config.Templates.pickerOptionItem({prefix:n,columnValue:e.value,columnLabel:e.label}))).find(".aui-button").click(function(e){e.preventDefault();i(this).closest("li.picker-option").remove()});t.append(e);return t}return function(){return{init:function(e){var t=this;if(l.isFeatureEnabled("endeavour_gadget_column_picker_a11y_remove_table")){this.picker=function(e,t){t.sortable({opacity:.7,cancel:""});r.addDragAndDrop(e);return t}(e.prefix,e.pickerElement);this.picker.getColumnValues=function(){return u.map(t.picker.find("li"),function(e){return i(e).attr("data-id").replace(/\|/g,"%7C")})};this.select=function(n,a){var t=n.errorContainer,l=n.columnNames,r=[];c.makeRequest({url:s()+"/rest/gadget/1.0/availableColumns",method:"GET",success:function(e){e.availableColumns&&e.availableColumns.length&&u.each(e.availableColumns,function(e){r.push(new o(e))});if("--Default--"===l)u.each(e.defaultColumns,function(e){p({value:e.value,label:e.label},a,n.prefix)});else{e=l.split("|").map(e=>e.replace(/%7C/g,"|"));u.each(e,function(t){var e=u.find(r,function(e){return e.value()===t});e&&p({value:e.value(),label:e.label()},a,n.prefix)})}i.enable()},error:function(e){m(t,e)},complete:function(){n.onContentLoaded&&n.onContentLoaded()}});var i=new d({element:n.fieldElement,itemAttrDisplayed:"label",revertOnInvalid:!0,submitInputVal:!1,showDropdownButton:!0,suggestions:function(n){return u.filter(r,function(e){var t=f(a).includes(e.value()),e=-1<e.label().toLocaleLowerCase().indexOf(n.toLocaleLowerCase());return!t&&e})}});i.disable();i.model.$element.on("selected",function(e,t){i.clear();if(t.value()&&!f(a).includes(t.value())){p({value:t.value(),label:t.label()},a,n.prefix);n.onContentLoaded&&n.onContentLoaded()}});return i}(e,this.picker)}else{this.tableElement=e.tableElement;this.table=function(e){var t=a.EntryModel.extend({destroy:function(){this.collection.remove(this)}}),n=a.Row.extend({initialize:function(e){e=u.extend({},e,{allowReorder:!0});a.Row.prototype.initialize.call(this,e)},renderOperations:function(){var e=this.model.attributes.label;return i(JIRA.DashboardItem.Common.Config.Templates.deleteColumnButton({columnName:e})).click(u.bind(function(e){e.preventDefault();this.destroy()},this))}}),r=new a({el:e,allowReorder:!1,allowEdit:!1,allowCreate:!1,autoFocus:!1,model:t,resources:{all:function(e){e([])}},columns:[{id:"label",header:""}],views:{row:n}});r.$thead.detach();r.$theadRow.prepend("<th />");r.$tbody.sortable({handle:"."+r.classNames.DRAG_HANDLE,helper:function(e,t){var l=i("<div/>").addClass(r.classNames.MOVEABLE+" "+t.attr("class"));t.children().each(function(e){var t=i(this),n=parseInt(0+t.css("border-left-width"),10),a=parseInt(0+t.css("border-right-width"),10),a=t[0].clientWidth+n+a;l.append(i("<div/>").html(t.html()).addClass(t.attr("class")).width(a))});(l=i("<div class='aui-restfultable-readonly'/>").append(l)).css({left:t.offset().left});l.appendTo(document.body);return l},start:function(e,t){var n=t.helper[0].clientHeight,a=t.placeholder.find("td");t.item.addClass(r.classNames.MOVEABLE).children().each(function(e){i(this).width(a.eq(e).width())});var l='<td colspan="'+r.getColumnCount()+'">&nbsp;</td>';t.placeholder.html(l).css({height:n,visibility:"visible"});r.getRowFromElement(t.item[0]).trigger(r._event.MODAL)},stop:function(e,t){if(i(t.item[0]).is(":visible")){t.item.removeClass(r.classNames.MOVEABLE).children().attr("style","");t.placeholder.removeClass(r.classNames.ROW);r.getRowFromElement(t.item[0]).trigger(r._event.MODELESS)}},axis:"y",delay:0,containment:"document",cursor:"move",scroll:!0,zIndex:8e3});r.$tbody.bind("selectstart mousedown",function(e){return!i(e.target).is("."+r.classNames.DRAG_HANDLE)});return r}(e.tableElement);this.select=function(n,a){var t=n.errorContainer,l=n.columnNames,r=[];c.makeRequest({url:s()+"/rest/gadget/1.0/availableColumns",method:"GET",success:function(e){e.availableColumns&&e.availableColumns.length&&u.each(e.availableColumns,function(e){r.push(new o(e))});if("--Default--"===l)u.each(e.defaultColumns,function(e){a.addRow({id:e.value,label:e.label})});else{e=l.split("|").map(e=>e.replace(/%7C/g,"|"));u.each(e,function(t){var e=u.find(r,function(e){return e.value()===t});e&&a.addRow({id:e.value(),label:e.label()})})}i.enable()},error:function(e){m(t,e)},complete:function(){n.onContentLoaded&&n.onContentLoaded()}});var i=new d({element:n.fieldElement,itemAttrDisplayed:"label",revertOnInvalid:!0,submitInputVal:!1,showDropdownButton:!0,suggestions:function(n){return u.filter(r,function(e){var t=a._models.get(e.value()),e=-1<e.label().toLocaleLowerCase().indexOf(n.toLocaleLowerCase());return!t&&e})}});i.disable();i.model.$element.on("selected",function(e,t){i.clear();if(t.value()&&!a._models.get(t.value())){a.addRow({id:t.value(),label:t.label()});n.onContentLoaded&&n.onContentLoaded()}});return i}(e,this.table);this.table.getColumnValues=function(){return u.map(t.table.$table.find("tr"),function(e){return i(e).attr("data-id").replace(/\|/g,"%7C")})}}return this},getValue:function(){return(l.isFeatureEnabled("endeavour_gadget_column_picker_a11y_remove_table")?this.picker:this.table).getColumnValues().join("|")},validate:function(){var e,t;if(l.isFeatureEnabled("endeavour_gadget_column_picker_a11y_remove_table")){e=this.picker.getColumnValues().length;t=this.picker.parents(".field-group").find(".error")}else{e=this.table._models.length;t=this.tableElement.parents(".field-group").find(".error")}if(0<e){t.hide();return!0}t.show();return!1}}}});;
;
/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'jira-gadgets-plugin/static/components/searchresults/SearchResults.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.Common&&(JIRA.DashboardItem.Common={}),"undefined"==typeof JIRA.DashboardItem.Common.SearchResults&&(JIRA.DashboardItem.Common.SearchResults={}),"undefined"==typeof JIRA.DashboardItem.Common.SearchResults.Templates&&(JIRA.DashboardItem.Common.SearchResults.Templates={}),JIRA.DashboardItem.Common.SearchResults.Templates.errorResult=function(e,s){return'<div class="empty-results search-results-dashboard-item">'+aui.message.error({content:"<p>"+soy.$$escapeHtml("Error occurred running search.")+"</p>"})+"</div>"},JIRA.DashboardItem.Common.SearchResults.Templates.noResults=function(e,s){return'<div class="empty-results search-results-dashboard-item">'+soy.$$escapeHtml("Search returned no results.")+"</div>"},JIRA.DashboardItem.Common.SearchResults.Templates.resultsTable=function(e,s){return'<div class="results-wrap search-results-dashboard-item"><div class="search-results-dashboard-item-issue-table '+(1==e.pagination?"paging-table":"")+'">'+soy.$$filterNoAutoescape(e.table)+"</div></div>"},JIRA.DashboardItem.Common.SearchResults.Templates.searchLink=function(e,s){return'<a href="'+soy.$$escapeHtml(e.href)+'" '+(e.title?'title="'+soy.$$escapeHtml(e.title)+'"':"")+">"+soy.$$escapeHtml(e.issueCount)+"</a>"};;
;
/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'jira-gadgets-plugin/static/components/searchresults/SearchResults.js' */
define("jira-dashboard-items/components/search-results",["jira/fragments/issueActionsFragment","jira/ajs/dropdown/dropdown","wrm/context-path","jquery","underscore","backbone","jira/featureflags/feature-manager"],function(p,f,h,m,a,e,b){"use strict";function D(){var e=function(e){var t=e.$activeTrigger&&e.$activeTrigger.context;if(t&&t.hasAttribute("data-issueid")&&t.hasAttribute("data-issuekey")){e.issueId=t.getAttribute("data-issueid");e.issueKey=t.getAttribute("data-issuekey")}return{data:{decorator:"dialog",inline:"true"}}}(this);return S?S.getPostRequestAjaxOptionsWithCustomDefaultOptions.call(this,e):{}}var S,w,A;return function(i){var o,s=i.context,r=i.preferences,n=i.gadgetId&&i.reportGadgetMetrics?i.reportGadgetMetrics:m.noop,l={num:r.num,tableContext:i.tableContext||"jira.table.cols.dashboard",addDefault:!1,columnNames:r.columnNames.split("|").map(e=>e.replace(/%7C/g,"|")),enableSorting:!0,paging:!0,showActions:!0},d=!0===i.shouldUseCache?"max-age=30":"no-cache, max-age=2";!function(e){var t=a.indexOf(e.columnNames,"--Default--");if(-1!==t){e.addDefault=!0;e.columnNames.splice(t,1)}}(l);function u(e,t,a){s.empty();e.table="<div>"+e.table+"</div>";(n=m(e.table)).find("#issuetable").removeAttr("id").addClass("issue-table");n.find("[id]").removeAttr("id");e.table=n.html();if(0!=e.displayed){var o,n=e.displayed===e.total;s.append(JIRA.DashboardItem.Common.SearchResults.Templates.resultsTable({pagination:n,table:e.table}));n=s.find(".results-count-link");e.url?o=h()+e.url:r.jql&&(o=h()+"/issues/?jql="+encodeURIComponent(r.jql));o&&n.replaceWith(JIRA.DashboardItem.Common.SearchResults.Templates.searchLink({href:o,title:e.title,issueCount:n.html()}));m("th.sortable",s).each(function(){this.onclick=null}).click(function(e){e.preventDefault();s.find(".search-results-dashboard-item-issue-table").addClass("loading");r.sortBy=m(this).attr("rel");g.trigger("sorted",{sortBy:r.sortBy})});m(".pagination a",s).click(function(e){e.preventDefault();s.find(".search-results-dashboard-item-issue-table").addClass("loading");r.startIndex=m(this).attr("rel");c()});m(".issue-link, .tinylink, .lozenge, .external-link",s).click(function(e){var t=m(e.target).closest("td").attr("class")||"unknown";g.trigger("onIssueLinkClick",{event:e,type:t})});b.isFeatureEnabled("endeavour_announce_options_on_issue_table_gadgets")||f.create({trigger:".issue-actions-trigger",autoScroll:!1,ajaxOptions:{dataType:"json",cache:!1,formatSuccess:p}});S=require("jira/dialog/dialog-util");w=require("jira/dialog/form-dialog");A=require("jira/loading/loading");if(w&&S&&A){new w({id:"assign-dialog",trigger:"a.issueaction-assign-issue",ajaxOptions:D,onSuccessfulSubmit:location.reload.bind(location),delayShowUntil:S.BeforeShowIssueDialogHandler.execute,widthClass:"large"});new w({trigger:"a.issueaction-assign-to-me",ajaxOptions:D,onSuccessfulSubmit:location.reload.bind(location),delayShowUntil:S.BeforeShowIssueDialogHandler.execute});new w({trigger:".issueaction-watch-issue:not([id='toggle-watch-issue'])",ajaxOptions:D,onSuccessfulSubmit:location.reload.bind(location),delayShowUntil:S.BeforeShowIssueDialogHandler.execute});new w({trigger:".issueaction-unwatch-issue:not([id='toggle-watch-issue'])",ajaxOptions:D,onSuccessfulSubmit:location.reload.bind(location),delayShowUntil:S.BeforeShowIssueDialogHandler.execute});new w({trigger:".issueaction-vote-issue:not([id='toggle-vote-issue'])",ajaxOptions:D,onSuccessfulSubmit:location.reload.bind(location),delayShowUntil:S.BeforeShowIssueDialogHandler.execute});new w({trigger:".issueaction-unvote-issue:not([id='toggle-vote-issue'])",ajaxOptions:D,onSuccessfulSubmit:location.reload.bind(location),delayShowUntil:S.BeforeShowIssueDialogHandler.execute});m(document).on("click",".issueaction-greenhopper-rank-top-operation",function(e){e.preventDefault();A.showLoadingIndicator();e=m(this).attr("data-issueid");m.ajax({type:"post",contentType:"application/json",url:h()+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:e}),complete:function(){A.hideLoadingIndicator();location.reload()}})});m(document).on("click",".issueaction-greenhopper-rank-bottom-operation",function(e){e.preventDefault();e=m(this).attr("data-issueid");A.showLoadingIndicator();m.ajax({type:"post",contentType:"application/json",url:h()+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:e}),complete:function(){A.hideLoadingIndicator();location.reload()}})})}i.onContentLoaded&&setTimeout(i.onContentLoaded,500)}else i.onEmptyResult?i.onEmptyResult(e,t,a):s.empty().append(JIRA.DashboardItem.Common.SearchResults.Templates.noResults())}function c(){n(i.gadgetId,"gadget-mark","Unspecified","fetchData","start");var e=function(e){if(!e||!e.match(/^cf\[[0-9]+]:(ASC|DESC)$/))return e;var t=2<=(a=e.match(/cf\[([0-9]+)]/)).length?a[1]:null,a=2<=(a=e.match(/:(.*$)/)).length&&["ASC","DESC"].includes(a[1])?a[1]:null;return t&&a?`customfield_${t}:${a}`:e}(r.sortBy),t=m.extend({},l,{sortBy:e&&""!==e?e:null,startIndex:r.startIndex||0}),a=o+"?"+m.param(t);if(window.DASHBOARD_GADGET_PRELOADED_DATA&&window.DASHBOARD_GADGET_PRELOADED_DATA[a]){e=window.DASHBOARD_GADGET_PRELOADED_DATA[a];delete window.DASHBOARD_GADGET_PRELOADED_DATA[a];n(i.gadgetId,"gadget-mark","Unspecified","fetchData","end");e.errors&&0<e.errors.length?i.onError?i.onError(e):s.empty().append(JIRA.DashboardItem.Common.SearchResults.Templates.errorResult()):u.apply(this,[e]);return m.Deferred().resolve(e)}return m.ajax({url:o,type:"GET",contentType:"application/json",dataType:"json",cache:!0,headers:{"Cache-control":d},data:t,error:function(e,t,a){n(i.gadgetId,"gadget-mark","Unspecified","fetchData","end");i.onError?i.onError(e,t,a):s.empty().append(JIRA.DashboardItem.Common.SearchResults.Templates.errorResult())},success:function(){n(i.gadgetId,"gadget-mark","Unspecified","fetchData","end");u.apply(this,arguments)},complete:i.onContentLoaded})}var g=a.extend({render:function(){if(r.filterId){o=h()+"/rest/gadget/1.0/issueTable/filter";l.filterId=r.filterId;return c()}if(r.jql){o=h()+"/rest/gadget/1.0/issueTable/jql";l.jql=r.jql;return c()}throw new Error("Unable to render search results. filterId or jql are required.")}},e.Events);return g}});;
;
/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'jira-gadgets-plugin/static/components/searchresults/SearchResultsConfig.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.Common&&(JIRA.DashboardItem.Common={}),"undefined"==typeof JIRA.DashboardItem.Common.SearchResults&&(JIRA.DashboardItem.Common.SearchResults={}),"undefined"==typeof JIRA.DashboardItem.Common.SearchResults.Templates&&(JIRA.DashboardItem.Common.SearchResults.Templates={}),JIRA.DashboardItem.Common.SearchResults.Templates.config=function(e,s){return""+Atlassian.DashboardItem.Common.Templates.config({isConfigured:e.preferences.isConfigured,fields:"<fieldset>"+JIRA.DashboardItem.Common.SearchResults.Templates.numberResults({prefix:e.prefix,id:"number-results",value:e.preferences.num})+JIRA.DashboardItem.Common.Config.Templates.columnPicker({prefix:e.prefix,id:"fields-to-display",isFeatureEnabled:e.isFeatureEnabled})+Atlassian.DashboardItem.Common.Templates.refreshInterval({prefix:e.prefix,id:"refresh-interval",value:e.preferences.refresh})+"</fieldset>"})},JIRA.DashboardItem.Common.SearchResults.Templates.numberResults=function(e,s){var a="",t=e.prefix+e.id,o=t+"-description",r=t+"-error";return a+='<div class="field-group '+soy.$$escapeHtml(e.id)+'"><label for="'+soy.$$escapeHtml(t)+'">'+soy.$$escapeHtml("Number of Results")+'<span class="aui-icon icon-required"></span></label><input class="text" type="text" id="'+soy.$$escapeHtml(t)+'" name="'+soy.$$escapeHtml(e.id)+'" value="'+soy.$$escapeHtml(e.value)+'" aria-required="true" aria-describedby="'+soy.$$escapeHtml(r)+" "+soy.$$escapeHtml(o)+'"><div id="'+soy.$$escapeHtml(r)+'" class="error"></div><div id="'+soy.$$escapeHtml(o)+'" class="description">'+soy.$$escapeHtml("Number of results to display (maximum of 50).")+"</div></div>"};;
;
/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'jira-gadgets-plugin/static/components/searchresults/SearchResultsConfig.js' */
define("jira-dashboard-items/components/search-results-config",["jira-dashboard-items/components/column-picker","jquery","underscore","jira/featureflags/feature-manager"],function(s,u,d,f){"use strict";return function(i){var a=u(i.context),o=i.preferences;return{renderConfig:function(){var e=(Math.random()+1).toString(36).substring(7)+"-";a.empty().html(JIRA.DashboardItem.Common.SearchResults.Templates.config({prefix:e,preferences:{num:o.num,refresh:o.refresh,isConfigured:o.isConfigured},isFeatureEnabled:f.isFeatureEnabled("endeavour_gadget_column_picker_a11y_remove_table")}));var r=a.find("form"),t=(new s).init({errorContainer:a.find(".dashboard-item-error"),tableElement:r.find("#"+e+"fields-to-display-table"),fieldElement:r.find("#"+e+"fields-to-display-select"),pickerElement:r.find("#"+e+"fields-to-display-picker"),prefix:e,columnNames:o.columnNames,onContentLoaded:i.onContentLoaded});function n(){var e=function(){var e=r.find("input[name=number-results]"),n=e.val(),t=e.parents(".field-group").find(".error");if(0<n&&n<=50){t.text("");t.hide();return!0}n?t.text("Provided value must be a number"):t.text("Enter a number of results");e.focus();t.show();return!1}(),n=t.validate();return e&&n}r.on("submit",d.bind(function(e){e.preventDefault();if(n()){e=u(e.target);i.onSave({num:e.find("input[name=number-results]").val(),refresh:i.gadgetAPI.getRefreshFieldValue("refresh-interval"),columnNames:t.getValue()})}else i.onContentLoaded()},this));r.find(".buttons-container .cancel").on("click",d.bind(function(){i.onCancel()},this));return r}}}});;
;
/* module-key = 'com.atlassian.jira.gadgets:assigned-to-me-dashboard-item-resources', location = 'jira-gadgets-plugin/static/dashboarditem/assignedtome/AssignedToMe.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.AssignedToMe&&(JIRA.DashboardItem.AssignedToMe={}),"undefined"==typeof JIRA.DashboardItem.AssignedToMe.Templates&&(JIRA.DashboardItem.AssignedToMe.Templates={}),JIRA.DashboardItem.AssignedToMe.Templates.errorResult=function(e,s){return'<div class="empty-results search-results-dashboard-item">'+aui.message.error({content:"<p>"+soy.$$escapeHtml("An unknown error occurred while trying to perform a search.")+"</p>"})+"</div>"},JIRA.DashboardItem.AssignedToMe.Templates.noResults=function(e,s){var t='<div class="empty-results search-results-dashboard-item">',a='<a href="'+soy.$$escapeHtml(e.href)+'">';return t+=soy.$$filterNoAutoescape(AJS.format("You currently have no {0}issues{1} assigned to you. Enjoy your day!",a,"</a>"))+"</div>"};;
;
/* module-key = 'com.atlassian.jira.gadgets:assigned-to-me-dashboard-item-resources', location = 'jira-gadgets-plugin/static/dashboarditem/assignedtome/AssignedToMe.js' */
define("jira-dashboard-items/assigned-to-me",["jira/util/formatter","wrm/context-path","jquery","underscore","jira-dashboard-items/components/search-results-config","jira-dashboard-items/components/search-results","internal/browser-metrics","jira-dashboard-items/wrm-gadget-browser-metrics","jira-dashboard-items/common-functions","wrm/require"],function(o,a,d,e,n,c,t,h,I,g){"use strict";function r(e){this.API=e;this.rendered=0}r.prototype.render=function(t,r){var s=this,n=s.API.gadget?s.API.gadget.amdModule:"UNKNOWN_GADGET",e=new h("jira.gadgets.assign-to-me",this.API.getGadgetId(),this.API.reportGadgetMetrics);if(0===s.rendered){e.markStart("View");s.rendered+=1}g("wrc!jira.heritage.form.dialog");s.API.showLoadingBar();s.API.setTitle("Assigned to Me");var i=d.extend({},r);i.jql="assignee = currentUser() AND statusCategory != 3 ORDER BY priority DESC, created ASC";i.sortColumn&&(i.sortBy=i.sortColumn);this.searchResults=new c({gadgetId:this.API.getGadgetId(),context:t,preferences:i,onContentLoaded:this.API.resize.bind(this.API),reportGadgetMetrics:this.API.reportGadgetMetrics?this.API.reportGadgetMetrics.bind(this.API):d.noop,onEmptyResult:function(){t.append(JIRA.DashboardItem.AssignedToMe.Templates.noResults({href:a()+"/issues/?jql="+encodeURIComponent(i.jql)}));s.API.resize()},onError:function(){t.empty().append(JIRA.DashboardItem.AssignedToMe.Templates.errorResult());s.API.resize()}});this.searchResults.on("sorted",function(e){r.sortBy=r.sortColumn=e.sortBy;s.API.isEditable()?s.API.savePreferences(r):s.render(t,r)});this.searchResults.on("onIssueLinkClick",function(e){I.sendClickAnalyticsEvent(n,e.type)});this.searchResults.render().always(this.API.hideLoadingBar.bind(this.API)).always(function(){if(1===s.rendered){e.report("View");s.rendered+=1}});s.API.initRefresh(i,this.searchResults.render)};r.prototype.renderEdit=function(e,t){var r=this,s=new n({context:e,preferences:t,onContentLoaded:function(){r.API.hideLoadingBar();r.API.resize()},onCancel:this.API.closeEdit.bind(this.API),onSave:this.API.savePreferences.bind(this.API),gadgetAPI:r.API}).renderConfig();this.API.once("afterRender",function(){e.width()<350&&s.addClass("top-label");r.API.showLoadingBar()})};return r});;
;
/* module-key = 'com.atlassian.jira.gadgets:project-filter-autocomplete-component', location = 'jira-gadgets-plugin/static/components/project-filter-autocomplete/project-filter-autocomplete.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.ProjectFilterAutoComplete&&(JIRA.DashboardItem.ProjectFilterAutoComplete={}),"undefined"==typeof JIRA.DashboardItem.ProjectFilterAutoComplete.Templates&&(JIRA.DashboardItem.ProjectFilterAutoComplete.Templates={}),JIRA.DashboardItem.ProjectFilterAutoComplete.Templates.ConfigurationField=function(e,t){var i="",s=e.prefix+e.id,a=s+"-error";return i+='<div class="field-group"><label for="'+soy.$$escapeHtml(s)+'">'+soy.$$escapeHtml("Project or Saved Filter")+'<span class="aui-icon icon-required"> '+soy.$$escapeHtml("required")+'</span></label><div class="builder-container"><input type="hidden" name="name" '+(e.selectionName?'value="'+soy.$$escapeHtml(e.selectionName)+'"':"")+'><input type="hidden" name="type" '+(e.selectionType?'value="'+soy.$$escapeHtml(e.selectionType)+'"':"")+'><input type="hidden" name="id" '+(e.selectionID?'value="'+soy.$$escapeHtml(e.selectionID)+'"':"")+'><span class="filterpicker-value-name field-value">'+(e.selectionName?soy.$$filterNoAutoescape(e.selectionName):soy.$$escapeHtml("No Filter/Project selected"))+'</span><div class="quick-find"><input class="text" id="'+soy.$$escapeHtml(s)+'" placeholder="'+soy.$$escapeHtml("Search")+'" aria-describedby="'+soy.$$escapeHtml(e.id)+"-description "+soy.$$escapeHtml(a)+'"><div class="hidden" id="'+soy.$$escapeHtml(e.id)+'-description">'+soy.$$escapeHtml("Project or saved filter to use as the basis for the graph.")+'</div><span class="inline-error"></span></div><input class="hidden" id="filter_'+soy.$$escapeHtml(s)+'_id"/><input class="hidden" id="filter_'+soy.$$escapeHtml(s)+'_name"/></div><div id="'+soy.$$escapeHtml(a)+'" class="projectOrFilter-error error"></div><div class="description">'+soy.$$escapeHtml("Project or saved filter to use as the basis for the graph.")+'<br/><a id="filter_'+soy.$$escapeHtml(s)+'_advance" class="advanced-search" href="#" title="'+soy.$$escapeHtml("Click here to select/change filter or project.")+'" target="_parent">'+soy.$$escapeHtml("Advanced Search")+"</a></div></div>"},JIRA.DashboardItem.ProjectFilterAutoComplete.Templates.HiddenConfigurationFields=function(e,t){return e=e||{},'<div class="field-group"><input type="hidden" name="type" '+(e.selectionType?'value="'+soy.$$escapeHtml(e.selectionType)+'"':"")+'><input type="hidden" name="id" '+(e.selectionID?'value="'+soy.$$escapeHtml(e.selectionID)+'"':"")+"></div>"},JIRA.DashboardItem.ProjectFilterAutoComplete.Templates.SuggestionSection=function(e,t){return"<div class='suggestionBlock'><h5>"+soy.$$escapeHtml(e.sectionTitle)+"</h5><ul class='aui-list-section'></ul></div>"},JIRA.DashboardItem.ProjectFilterAutoComplete.Templates.SuggestionProject=function(e,t){return'<li class="aui-list-item" data-type="project" data-id="'+soy.$$escapeHtml(e.suggestion.id)+'"><a href="#" class="aui-list-item-link aui-indented-link" target="_parent">'+soy.$$filterNoAutoescape(e.suggestion.html)+"("+soy.$$escapeHtml(e.suggestion.key)+")</a></li>"},JIRA.DashboardItem.ProjectFilterAutoComplete.Templates.SuggestionFilter=function(e,t){return'<li class="aui-list-item" data-type="filter" data-id="'+soy.$$escapeHtml(e.suggestion.id)+'"><a href="#" class="aui-list-item-link aui-indented-link" target="_parent">'+soy.$$filterNoAutoescape(e.suggestion.nameHtml)+"</a></li>"};;
;
/* module-key = 'com.atlassian.jira.gadgets:project-filter-autocomplete-component', location = 'jira-gadgets-plugin/static/components/project-filter-autocomplete/ProjectFilterAutoComplete.js' */
define("jira-dashboard-items/components/autocomplete/project-filter-autocomplete",["jira/util/formatter","wrm/context-path","jira/autocomplete/rest-autocomplete","jira/util/events","jira/util/objects","jquery"],function(a,s,e,o,n,l){function c(e){function t(){var e=(t=l("#filter_"+r+"_id").attr("value")).substr(0,t.indexOf("-")),t=t.substr(t.indexOf("-")+1),n=l("#filter_"+r+"_name").text();i.find("input[name=type]").val(e);i.find("input[name=id]").val(t);i.find("input[name=name]").val(n);i.find(".filterpicker-value-name").text(n).addClass("success");o.trigger("gadget-advancedprojectfilter-selected")}var i=e.parentElement,r=e.fieldID;(e=i.find("#filter_"+r+"_id")).on("DOMAttrModified",t);if(window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver){observer=new MutationObserver(t);observer.observe(e[0],{attributes:!0})}i.find("#filter_"+r+"_advance").click(function(e){var t=s()+"/secure/FilterPickerPopup.jspa?showProjects=true&field="+r,n="filter_"+r.replace(new RegExp("-","g"),"")+"_window";window.open(t,n,"width=800, height=500, resizable, scrollbars=yes").focus();e.preventDefault()})}var u=JIRA.DashboardItem.ProjectFilterAutoComplete.Templates;return function(t){t=t||{};var i=n.begetObject(e);i.getAjaxParams=function(){return{url:s()+"/rest/gadget/1.0/pickers/projectsAndFilters",data:t.ajaxData||{},dataType:"json",type:"GET"}};i.completeField=function(e){if(e){t.parentElement.find("input[name=type]").val(e.type);t.parentElement.find("input[name=id]").val(e.id);t.parentElement.find("input[name=name]").val(e.name);t.parentElement.find(".filterpicker-value-name").text(e.name).addClass("success");this.field.val("");this.field.trigger("change")}};function r(e,n,t,i,r){var a=[],s=(t=l(u.SuggestionSection({sectionTitle:t}))).find("ul.aui-list-section");l(i).each(function(){var e=this,t=l(r({suggestion:e}));e.type=n;t.mouseover(function(){l(this).addClass("active")});a.push([t,e]);s.append(t)});e.append(t);return a}i.renderSuggestions=function(e){this.clearResponseContainer();this.responseContainer.addClass("aui-list");var t,n=[];e&&e.projects&&0<e.projects.length&&(t=r(this.responseContainer,"project","Projects",e.projects,u.SuggestionProject),n=n.concat(t));if(e&&e.filters&&0<e.filters.length){e=r(this.responseContainer,"filter","Filters",e.filters,u.SuggestionFilter);n=n.concat(e)}this.responseContainer.find(".aui-list-item-link").click(function(e){e.preventDefault()});i.addSuggestionControls(n);return n};t.minQueryLength=1;t.queryDelay=.25;i.init(t);c(t);return i}});;
;
/* module-key = 'com.atlassian.plugin.jslibs:jquery.resize-0.5.1', location = 'atlassian-jslibs/jquery-plugins/jquery.resize/0.5.1/jquery.resize-0.5.1.js' */
!function(e){define("atlassian/jquery-plugins/jquery.resize-0.5.1",function(){return function(i){return e(window,document,i),i}})}(function(e,i,t){!function(r){function s(e){var i=e.__resizeTriggers__,t=i.firstElementChild,r=i.lastElementChild,s=t.firstElementChild;r.scrollLeft=r.scrollWidth,r.scrollTop=r.scrollHeight,s.style.width=t.offsetWidth+1+"px",s.style.height=t.offsetHeight+1+"px",t.scrollLeft=t.scrollWidth,t.scrollTop=t.scrollHeight}function n(e){return e.offsetWidth!=e.__resizeLast__.width||e.offsetHeight!=e.__resizeLast__.height}function _(e){var i=this;s(this),this.__resizeRAF__&&d(this.__resizeRAF__),this.__resizeRAF__=h(function(){n(i)&&(i.__resizeLast__.width=i.offsetWidth,i.__resizeLast__.height=i.offsetHeight,i.__resizeListeners__.forEach(function(t){t.call(i,e)}))})}function o(){if(!c){var e='.resize-triggers { visibility: hidden; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',t=i.head||i.getElementsByTagName("head")[0],r=i.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(i.createTextNode(e)),t.appendChild(r)}}var a=i.attachEvent,c=!1,l=r.fn.resize;if(r.fn.resize=function(i){return this.each(function(){this==e?l.call(t(this),i):addResizeListener(this,i)})},r.fn.removeResize=function(e){return this.each(function(){removeResizeListener(this,e)})},!a)var h=function(){var i=e.requestAnimationFrame||e.mozRequestAnimationFrame||e.webkitRequestAnimationFrame||function(i){return e.setTimeout(i,20)};return function(e){return i(e)}}(),d=function(){var i=e.cancelAnimationFrame||e.mozCancelAnimationFrame||e.webkitCancelAnimationFrame||e.clearTimeout;return function(e){return i(e)}}();e.addResizeListener=function(e,t){a?e.attachEvent("onresize",t):(e.__resizeTriggers__||("static"==getComputedStyle(e).position&&(e.style.position="relative"),o(),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=i.createElement("div")).className="resize-triggers",e.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>',e.appendChild(e.__resizeTriggers__),s(e),e.addEventListener("scroll",_,!0)),e.__resizeListeners__.push(t))},e.removeResizeListener=function(e,i){a?e.detachEvent("onresize",i):(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(i),1),e.__resizeListeners__.length||(e.removeEventListener("scroll",_,!0),e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)))}}(t)});;
;
/* module-key = 'com.atlassian.jira.gadgets:jquery', location = 'jira-gadgets-plugin/static/lib/jquery-plugins.js' */
require(["jquery","atlassian/jquery-plugins/jquery.resize-0.5.1"],function(e,r){r(e)});;
;
/* module-key = 'com.atlassian.jira.gadgets:projects-dashboard-item-resources', location = 'jira-gadgets-plugin/static/dashboarditem/projects/Projects.soy.js' */
if("undefined"==typeof JIRA)var JIRA={};"undefined"==typeof JIRA.DashboardItem&&(JIRA.DashboardItem={}),"undefined"==typeof JIRA.DashboardItem.Projects&&(JIRA.DashboardItem.Projects={}),"undefined"==typeof JIRA.DashboardItem.Projects.Templates&&(JIRA.DashboardItem.Projects.Templates={}),JIRA.DashboardItem.Projects.Templates.Avatar=function(e,t){return'<img class="project-avatar" id="'+soy.$$escapeHtml(e.project.name)+'_avatar" src="'+soy.$$escapeHtml(e.contextPath)+"/secure/projectavatar?pid="+soy.$$escapeHtml(e.project.id)+"&avatarId="+soy.$$escapeHtml(e.project.avatarId)+'&size=small" width="16"></img>'},JIRA.DashboardItem.Projects.Templates.ProjectDescriptionWithoutAutoEscaping=function(e,t){return""+(e.project.showDescription?'<dl><dt class="project-property-title">'+"Description"+'</dt><dd class="content-inner" style="max-height: none;">'+e.project.projectDescription+"</dd></dl>":"")},JIRA.DashboardItem.Projects.Templates.OpenIssues=function(e,t){return""+(e.project.showOpen?'<dl><dt class="project-property-title"><span>'+soy.$$escapeHtml("Open Issues")+'<span class="project-property-title-small">('+soy.$$escapeHtml("by priority")+')</span></span></dt><dd class="project-property-value">'+JIRA.DashboardItem.Projects.Templates.OpenIssuesProperty(e)+"</dd></dl>":"")},JIRA.DashboardItem.Projects.Templates.OpenIssuesProperty=function(e,t){var s="";if(e.project.openIssues){s+="<table><tr>";for(var a=e.project.openIssues,o=a.length,r=0;r<o;r++){var l=a[r];s+='<td height="10" width="'+soy.$$escapeHtml(l.width)+'" '+("none"!=l.colour?' bgColor="'+soy.$$escapeHtml(l.colour)+'" ':' class="noStatusColour" ')+'><a class="status-bar" href="'+soy.$$escapeHtml(e.contextPath+l.url)+'" title="'+soy.$$escapeHtml(l.altText)+'" style="width: '+soy.$$escapeHtml(l.width)+'px"></a></td>'}s+="</tr></table>"}else s+="<em>"+soy.$$escapeHtml("No open issues")+"</em>";return s},JIRA.DashboardItem.Projects.Templates.Reports=function(e,t){return'<li class="aui-list"><a href="'+soy.$$escapeHtml(e.contextPath)+"/rest/gadget/1.0/project/reports?projectId="+soy.$$escapeHtml(e.project.id)+'" class="lnk aui-dd-link standard icon-reports reporttype"><span><em>'+soy.$$escapeHtml("Reports")+"</em></span></a><ul></ul></li>"},JIRA.DashboardItem.Projects.Templates.Filters=function(e,t){return'<li class="aui-list"><a href="'+soy.$$escapeHtml(e.contextPath)+"/rest/gadget/1.0/project/filters?projectId="+soy.$$escapeHtml(e.project.id)+'" class="lnk aui-dd-link standard icon-filters filtertype"><span><em>'+soy.$$escapeHtml("Filters")+"</em></span></a><ul></ul></li>"},JIRA.DashboardItem.Projects.Templates.Lead=function(e,t){return'<dl><dt class="project-property-title">'+soy.$$escapeHtml("Lead")+'</dt><dd class="project-property-value"><a href="'+soy.$$escapeHtml(e.contextPath)+"/secure/ViewProfile.jspa?name="+soy.$$escapeHtml(e.project.leadUserName)+'" class="project-lead-link"><span>'+(e.project.leadFullName?soy.$$escapeHtml(e.project.leadFullName):soy.$$escapeHtml(e.project.leadUserName))+"</span></a></dd></dl>"},JIRA.DashboardItem.Projects.Templates.ProjectDetails=function(e,t){return"<div>"+JIRA.DashboardItem.Projects.Templates.Lead(e)+("detailed"==e.viewType?JIRA.DashboardItem.Projects.Templates.OpenIssues(e)+JIRA.DashboardItem.Projects.Templates.ProjectDescriptionWithoutAutoEscaping(e):"")+"</div>"},JIRA.DashboardItem.Projects.Templates.Project=function(e,t){return'<li class="project-item"><ul class="operations-projects">'+JIRA.DashboardItem.Projects.Templates.Reports(e)+JIRA.DashboardItem.Projects.Templates.Filters(e)+'</ul><h3 class="project-title">'+JIRA.DashboardItem.Projects.Templates.Avatar(e)+'<a href="'+soy.$$escapeHtml(e.contextPath)+"/browse/"+soy.$$escapeHtml(e.project.key)+'" class="project-link">'+soy.$$escapeHtml(e.project.name)+"</a><span>("+soy.$$escapeHtml(e.project.key)+")</span></h3>"+("collapsed"!=e.viewType?JIRA.DashboardItem.Projects.Templates.ProjectDetails(e):"")+"</li>"},JIRA.DashboardItem.Projects.Templates.Dropdown=function(e,t){for(var s="<div class='aui-list'><ul "+(e.dropdownType?'class="'+soy.$$escapeHtml(e.dropdownType)+'"':"")+">",a=e.options,o=a.length,r=0;r<o;r++){var l=a[r];s+='<li class="aui-list-item"><a class="aui-list-item-link project-dropdown-link" href="'+soy.$$escapeHtml(e.contextPath+l.key)+'">'+soy.$$escapeHtml(l.title)+"</a></li>"}return s+="</ul></div>"},JIRA.DashboardItem.Projects.Templates.Error=function(e,t){return'<div class="projects-dashboard-item">'+aui.message.error({titleContent:"Oops - an error has occurred",content:"",closeable:"false"})+"</div>"},JIRA.DashboardItem.Projects.Templates.NoProjects=function(e,t){return'<div class="project-no-projects">'+(e.doAnyProjectsExist?e.isAdmin?soy.$$filterNoAutoescape(AJS.format("No projects to display. Do you need to {0}create a project{1}?",'<a class="add-project-trigger">',"</a>")):soy.$$escapeHtml("No projects to display. Ask your Administrator to create a project for you."):soy.$$filterNoAutoescape(AJS.format("No projects exist (yet). Be the first to {0}create a project{1}.",'<a class="add-project-trigger">',"</a>")))+"</div>"},JIRA.DashboardItem.Projects.Templates.Pagination=function(e,t){var s='<div class="aui-group pagination-view count-pagination-adg3"><div class="pagination-results aui-item">'+JIRA.DashboardItem.Projects.Templates.ResultsCount(e.results)+'</div><div class="pagination" data-displayable-total="'+soy.$$escapeHtml(e.totalProjects)+'">',a=7,o=Math.floor((e.totalProjects-1)/e.pageSize),r=Math.floor(e.startIndex/e.pageSize),l=soy.$$escapeHtml(AJS.contextPath())+"/"+soy.$$filterNoAutoescape(e.searchQuery),i=e.startIndex-e.pageSize;s+=(i>=0?'<button href="'+soy.$$escapeHtml(l)+'" data-start-index="'+soy.$$escapeHtml(i)+'" class="previous-page-button aui-icon aui-icon-big icon-previous" title="'+soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",r,o+1))+'"></button>':e.totalProjects>e.pageSize?'<button href="'+soy.$$escapeHtml(l)+'" data-start-index="'+soy.$$escapeHtml(i)+'" class="previous-page-button aui-icon aui-icon-big icon-previous" disabled title="'+soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",r,o+1))+'"></button>':"")+JIRA.DashboardItem.Projects.Templates.NumberLinksLogicBranch({startPage:r-Math.floor(a/2),endPage:r+Math.floor(a/2),lastPage:o,urlFragment:l,currentPage:r+1,maxPagesDisplayed:a,pageSize:e.pageSize,totalProjects:e.totalProjects});var c=Math.min(e.startIndex+e.pageSize,e.totalProjects);return s+=(c<e.totalProjects?'<button href="'+soy.$$escapeHtml(l)+'" data-start-index="'+soy.$$escapeHtml(c)+'" class="next-page-button aui-icon aui-icon-big icon-next" title="'+soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",r+2,o+1))+'"></button>':e.totalProjects>e.pageSize?'<button href="'+soy.$$escapeHtml(l)+'" data-start-index="'+soy.$$escapeHtml(c)+'" class="next-page-button aui-icon aui-icon-big icon-next" disabled title="'+soy.$$escapeHtml(AJS.format("Go to page {0} of {1}",r+2,o+1))+'"></button>':"")+"</div></div>"},JIRA.DashboardItem.Projects.Templates.NumberLinksLogicBranch=function(e,t){return""+(e.lastPage<e.maxPagesDisplayed?JIRA.DashboardItem.Projects.Templates.NumberLinks(soy.$$augmentMap(e,{startPage:0,endPage:e.lastPage})):e.startPage<0?JIRA.DashboardItem.Projects.Templates.NumberLinks(soy.$$augmentMap(e,{startPage:0,endPage:e.endPage-e.startPage})):e.endPage>e.lastPage?JIRA.DashboardItem.Projects.Templates.NumberLinks(soy.$$augmentMap(e,{startPage:e.startPage-(e.endPage-e.lastPage),endPage:e.lastPage})):JIRA.DashboardItem.Projects.Templates.NumberLinks(e))},JIRA.DashboardItem.Projects.Templates.NumberLinks=function(e,t){var s="",a=e.endPage-e.startPage+1;if(a>1)for(var o=Math.round(a),r=0;r<o;r++){var l=6,i=0==r?0:r==l?e.lastPage:r+e.startPage,c=i+1,p=i*e.pageSize,n=Math.min(p+e.pageSize,e.totalProjects),d=""+soy.$$escapeHtml(AJS.format("Projects {0} - {1}",p+1,n));s+=" "+(c==e.currentPage?'<button class="selected-index-adg3" data-page="'+soy.$$escapeHtml(c)+'" data-start-index="'+soy.$$escapeHtml(p)+'" title="'+soy.$$escapeHtml(d)+'">'+soy.$$escapeHtml(c)+"</button>":1==r&&c>2?'<span class="ellipsis">...</span>':5==r&&c<e.lastPage?'<span class="ellipsis">...</span>':'<button class="page-index" href="'+soy.$$escapeHtml(e.urlFragment)+'" data-page="'+soy.$$escapeHtml(c)+'" data-start-index="'+soy.$$escapeHtml(p)+'" title="'+soy.$$escapeHtml(d)+'">'+soy.$$escapeHtml(c)+"</button>")}return s},JIRA.DashboardItem.Projects.Templates.ResultsCount=function(e,t){return""+JIRA.DashboardItem.Projects.Templates.ResultsCountHelper({start:'<span class="results-count-start-adg3">'+soy.$$escapeHtml(e.start)+"</span>",end:'<span class="results-count-end-adg3">'+soy.$$escapeHtml(e.end)+"</span>",total:'<a class="results-count-link-adg3" href="'+soy.$$escapeHtml(AJS.contextPath())+'/projects">'+soy.$$escapeHtml(e.total)+"</a>",hasTotalCountFromServer:e.hasTotalCountFromServer})},JIRA.DashboardItem.Projects.Templates.ResultsCountHelper=function(e,t){return'<span class="results-count-text">'+(e.hasTotalCountFromServer?soy.$$filterNoAutoescape(AJS.format("{0}&ndash;{1} of {2}",e.start,e.end,e.total)):soy.$$filterNoAutoescape(AJS.format("{0}&ndash;{1} of {2}+",e.start,e.end,e.total)))+"</span>"},JIRA.DashboardItem.Projects.Templates.Configuration=function(e,t){return'<div id="config" class="projects-dashboard-item">'+Atlassian.DashboardItem.Common.Templates.config({fields:""+(e.fields.projects&&e.fields.projects.length>0&&e.fields.categories&&e.fields.categories.length>0?JIRA.DashboardItem.Projects.Templates.ProjectsAndCategoriesSelectBox({prefix:e.prefix,content:e.content,id:"projects-and-categories"}):e.fields.projects&&e.fields.projects.length>0?JIRA.DashboardItem.Projects.Templates.ProjectsSelectBox({prefix:e.prefix,id:"projects-and-categories",options:e.fields.projects,value:e.preferences.projectsOrCategories}):"")+JIRA.DashboardItem.Projects.Templates.NumberResults({prefix:e.prefix,id:"maxResults",value:e.preferences.maxResults})+JIRA.DashboardItem.Projects.Templates.ProjectsGadgetView({viewOptions:e.viewOptions,prefix:e.prefix,currentValue:e.preferences.viewType})+JIRA.DashboardItem.Projects.Templates.NumberOfColumnsView({columnCountOptions:e.columnCountOptions,prefix:e.prefix,currentValue:e.preferences.cols})+JIRA.DashboardItem.Projects.Templates.RefreshIntervalSelect({prefix:e.prefix,id:"refresh-interval",options:e.refreshIntervalOptions,value:e.preferences.refresh}),isConfigured:e.preferences.isConfigured})+"</div>"},JIRA.DashboardItem.Projects.Templates.ProjectsSelectBox=function(e,t){var s="",a=e.prefix+e.id;return s+='<div class="field-group '+soy.$$escapeHtml(e.id)+'"><label for="'+soy.$$escapeHtml(a)+'">'+soy.$$escapeHtml("Projects")+"</label>"+JIRA.DashboardItem.Projects.Templates.multiSelectPicker({prefixedId:a,label:"",name:"projectsOrCategories"})+'<div class="error"></div><div class="description">'+soy.$$escapeHtml("Projects or categories to use as the basis for the graph.")+"</div></div>"},JIRA.DashboardItem.Projects.Templates.ProjectsAndCategoriesSelectBox=function(e,t){var s="",a=e.prefix+e.id,o="catOrProj_projectsOrCategories";return s+='<div class="projects-and-categories field-group"><label for="'+soy.$$escapeHtml(a)+'">'+soy.$$escapeHtml("Projects and Categories")+'</label><fieldset class="group"><div class="radio">'+aui.form.input({type:"radio",id:e.prefix+"-projectsOrCategories_proj",name:o,isChecked:!1,value:"projects"})+aui.form.label({forField:"projectsOrCategories_proj",content:""+soy.$$escapeHtml(e.content.projects)})+'</div><div class="radio">'+aui.form.input({type:"radio",id:e.prefix+"-projectsOrCategories_proj_cat",name:o,isChecked:!1,value:"categories"})+aui.form.label({forField:"projectsOrCategories_proj_cat",content:""+soy.$$escapeHtml(e.content.categories)})+"</div></fieldset>"+JIRA.DashboardItem.Projects.Templates.multiSelectPicker({prefixedId:a,label:"",name:"projectsOrCategories"})+'<div class="error"></div><div class="description">'+soy.$$escapeHtml("Projects or categories to use as the basis for the graph.")+"</div></div>"},JIRA.DashboardItem.Projects.Templates.NumberResults=function(e,t){var s="",a=e.prefix+e.id;return s+='<div class="field-group '+soy.$$escapeHtml(e.id)+'"><label for="'+soy.$$escapeHtml(a)+'">'+soy.$$escapeHtml("Number of Results")+'<span class="aui-icon icon-required"> '+soy.$$escapeHtml("required")+'</span></label><input class="text" type="text" id="'+soy.$$escapeHtml(a)+'" name="'+soy.$$escapeHtml(e.id)+'" value="'+soy.$$escapeHtml(e.value)+'"><div class="error"></div><div class="description">'+soy.$$escapeHtml("Number of results to display (maximum of 50).")+"</div></div>"},JIRA.DashboardItem.Projects.Templates.NumberOfColumnsView=function(e,t){var s="";e.prefix+"-number-of-columns";s+='<fieldset class="group"><legend><span>'+soy.$$escapeHtml("Number of Columns:")+"</span></legend>";for(var a=e.columnCountOptions,o=a.length,r=0;r<o;r++){var l=a[r];s+='<div class="radio">'+aui.form.input({type:"radio",id:e.prefix+l.value,name:"cols",isChecked:l.value==e.currentValue,value:l.value})+aui.form.label({forField:e.prefix+l.value,content:""+soy.$$escapeHtml(l.label)})+"</div>"}return s+='<div class="error"></div><div class="description">'+soy.$$escapeHtml("How many columns to display")+"</div></fieldset>"},JIRA.DashboardItem.Projects.Templates.ProjectsGadgetView=function(e,t){var s="";e.prefix+"-project-gadgets-view";s+='<fieldset class="group"><legend><span>'+soy.$$escapeHtml("View:")+"</span></legend>";for(var a=e.viewOptions,o=a.length,r=0;r<o;r++){var l=a[r];s+='<div class="radio">'+aui.form.input({type:"radio",id:e.prefix+l.value,name:"viewType",isChecked:l.value==e.currentValue,value:l.value})+aui.form.label({forField:e.prefix+l.value,content:""+soy.$$filterNoAutoescape(l.label)})+"</div>"}return s+='<div class="error"></div><div class="description">'+soy.$$escapeHtml("The amount of detail to show")+"</div></fieldset>"},JIRA.DashboardItem.Projects.Templates.RefreshIntervalSelect=function(e,t){var s="",a=e.prefix+e.id;return s+='<div class="field-group '+soy.$$escapeHtml(e.id)+'"><label for="'+soy.$$escapeHtml(a)+'">'+soy.$$escapeHtml("Refresh Interval")+"</label>"+JIRA.DashboardItem.Projects.Templates.selectPicker({prefixedId:a,label:"",name:e.prefix+e.id,options:e.options,currentValue:e.value})+'<div class="error"></div><div class="description">'+soy.$$escapeHtml("How often you would like this gadget to update")+"</div></div>"},JIRA.DashboardItem.Projects.Templates.selectPicker=function(e,t){for(var s='<label for="'+soy.$$escapeHtml(e.prefixedId)+'">'+soy.$$escapeHtml(e.label)+'</label><select id="'+soy.$$escapeHtml(e.prefixedId)+'" name="'+soy.$$escapeHtml(e.name)+'" class="select">',a=e.options,o=a.length,r=0;r<o;r++){var l=a[r];s+='<option value="'+soy.$$escapeHtml(l.value)+'" '+(l.value==e.currentValue?' selected="selected"':"")+">"+soy.$$escapeHtml(l.label)+"</option>"}return s+="</select>"},JIRA.DashboardItem.Projects.Templates.multiSelectPicker=function(e,t){return'<label for="'+soy.$$escapeHtml(e.prefixedId)+'">'+soy.$$escapeHtml(e.label)+'</label><select id="'+soy.$$escapeHtml(e.prefixedId)+'" name="'+soy.$$escapeHtml(e.name)+'" class="select multi-select" multiple></select>'},JIRA.DashboardItem.Projects.Templates.multiSelectOptions=function(e,t){for(var s="",a=e.optionsToShow,o=a.length,r=0;r<o;r++){var l=a[r];s+='<option value="'+soy.$$escapeHtml(l.value)+'" '+(e.selectedEntries&&e.selectedEntries.indexOf(l.value)!=-1?' selected="selected"':"")+">"+soy.$$escapeHtml(l.label)+"</option>"}return s};;
;
/* module-key = 'com.atlassian.jira.gadgets:projects-dashboard-item-resources', location = 'jira-gadgets-plugin/static/dashboarditem/projects/Projects.js' */
define("jira-dashboard-items/projects",["jira/util/formatter","wrm/context-path","jquery","underscore","jira-dashboard-items/components/autocomplete/project-filter-autocomplete","jira-dashboard-items/common-functions","internal/browser-metrics","jira-dashboard-items/wrm-gadget-browser-metrics"],function(u,f,h,g,e,j,t,s){"use strict";function r(e,t){this.API=e;this.options=t||{};this.rendered=0;this.prefix=this.API.getGadgetId()+"-";this.startAt=void 0}var m="categories",v="projectsOrCategories",I="catallCategories",A="refresh-interval",b="catOrProj_projectsOrCategories",w="maxResults",y="project-gadget/gadgets/project-gadget.xml";r.prototype._renderView=function(a,i,r){var o=this,c=AJS.$("<div />").addClass("g-project"),l=1;"two-col"===i.cols?l=2:"three-col"===i.cols&&(l=3);function t(r){var a=AJS.$("<ul/>").addClass("category-list"),o=0;function s(e,t,r){window.setTimeout(function(){a.append(n(e,t));r()},0)}s(r[o],o+1>=r.length,function e(){if(r[++o])s(r[o],o+1>=r.length,e);else{c.append(a);var t=0===r.length;d(t);p(t)}})}var n=function(e,t){if(!e.name){e.name="No Categories";e.id="none"}var r=AJS.$("<li/>").addClass("category-item"),a=AJS.$("<a/>").text(e.name).attr("href",f()+"/secure/BrowseProjects.jspa#"+e.id);r.append(AJS.$("<h4/>").append(a.addClass("category-link"))).append(s(e.projects,r,t));return r},s=function(t,r,a){var o=AJS.$("<ul/>").addClass("project-list").addClass(i.cols),s=0;function n(t,r){window.setTimeout(function(){var e=AJS.$(JIRA.DashboardItem.Projects.Templates.Project({project:t,contextPath:f(),viewType:i.viewType}));l&&s%l==0&&e.css("clear","left");o.append(e);r()},0)}n(t[s],function e(){if(t[++s])n(t[s],e);else{(r||c).append(o);d(a);p(a)}})},d=function(e){if(e){var t=g.data.startAt,r=g.data.maxResults,e=g.data.total;c.append(h(JIRA.DashboardItem.Projects.Templates.Pagination({startIndex:t,pageSize:r,totalProjects:e,searchQuery:"#",results:{start:t+1,end:Math.min(t+r,e),total:e,hasTotalCountFromServer:!0}})));c.find(".pagination button").click(function(e){e.preventDefault();o.startAt=h(this).attr("data-start-index");o.render(a,i)})}},p=function(e){e&&a.html(c);if(1!==l){var t=-1;a.find("li.project-item").each(function(){var e=AJS.$(this).height();t<e&&(t=e)});a.find("li.project-item").css("minHeight",t)}a.delegate("a.aui-dd-link","click",function(e){var t,r=AJS.$(this);r.hasClass("reporttype")?t="reporttype":r.hasClass("filtertype")&&(t="filtertype");if(!r.data("dropdown-bound")){r.data("dropdown-bound",!0);e.preventDefault();e.stopPropagation();AJS.Dropdown.create({trigger:this,autoScroll:!1,ajaxOptions:{formatSuccess:function(e){return AJS.$(JIRA.DashboardItem.Projects.Templates.Dropdown({options:e.options,contextPath:f(),dropdownType:t}))}}});r.click()}});if(e){if(1===o.rendered&&void 0===o.startAt){r.report("View");o.rendered+=1}o.API.hideLoadingBar();o.API.resize()}},g={},e=f()+"/rest/gadget/1.0/project/generate?projectsOrCategories="+encodeURIComponent(i.projectsOrCategories)+"&showStats="+("detailed"===i.viewType)+"&"+w+"="+(i[w]||10)+"&startAt="+(o.startAt||0);r.reportCustomMarkStart("fetchData");AJS.$.ajax({method:"GET",url:e,dataType:"json"}).done(function(e){r.reportCustomMarkEnd("fetchData");g.data=e;e=g.data.categories;if(e&&0<e.length){a.off("click",".project-link").on("click",".project-link",function(e){j.sendClickAnalyticsEvent(y,"projecttype")});a.off("click",".project-lead-link").on("click",".project-lead-link",function(e){j.sendClickAnalyticsEvent(y,"projectleadtype")});"detailed"===i.viewType&&a.off("click",".status-bar").on("click",".status-bar",function(e){j.sendClickAnalyticsEvent(y,"openissuesstatusbartype")});a.off("click",".project-dropdown-link").on("click",".project-dropdown-link",function(e){e=a.find(e.target).closest("ul").attr("class")||"unknown";j.sendClickAnalyticsEvent(y,e)});if(1!==e.length||e[0].id||i.projectsOrCategories===I){a.off("click",".category-link").on("click",".category-link",function(e){j.sendClickAnalyticsEvent(y,"categorytype")});t(e)}else s(e[0].projects,void 0,!0)}else{c.append(AJS.$(JIRA.DashboardItem.Projects.Templates.NoProjects({doAnyProjectsExist:g.data.doAnyProjectsExist,isAdmin:g.data.isAdmin})));p(!0);a.find(".add-project-trigger").click(function(e){e.preventDefault();parent.postMessage("createproject","*")})}}).fail(function(e){r.reportCustomMarkEnd("fetchData");a.html(JIRA.DashboardItem.Projects.Templates.Error());o.API.hideLoadingBar();o.API.resize()})};function o(){this.API.hideLoadingBar();this.API.resize()}function T(e){e.html(JIRA.DashboardItem.Projects.Templates.Error())}function n(e,t,r){var a=this;if(r&&(r.projects||r.categories)){var o=[{value:"false",label:"Never"},{value:"15",label:u.format("Every {0} Minutes",15)},{value:"30",label:u.format("Every {0} Minutes",30)},{value:"60",label:u.format("Every {0} Hour",1)},{value:"120",label:u.format("Every {0} Hours",2)}],s=[{label:"Collapsed",value:"collapsed"},{label:"Brief",value:"brief"},{label:"Detailed",value:"detailed"}],n=[{label:"1",value:"single-col"},{label:"2",value:"two-col"},{label:"3",value:"three-col"}];!function(e){e&&e.projects&&e.projects.unshift({label:"All Projects",value:"allprojects"});e&&e.categories&&0<e.categories.length&&e.categories.unshift({label:"All Categories",value:I})}(r);(i=t)&&i.projectsOrCategories&&0<i.projectsOrCategories.length&&(i.projectsOrCategories=i.projectsOrCategories.split("|"));var i={projects:"Projects",categories:"Categories"},i=JIRA.DashboardItem.Projects.Templates.Configuration({refreshIntervalOptions:o,prefix:a.prefix,fields:r,preferences:t,viewOptions:s,columnCountOptions:n,content:i});e.html(i);var c,l,d,i=h("#"+a.prefix+"projects-and-categories");c=r,l=t,d=i,h("input[type=radio][name="+b+"]").on("change",function(e){var t=[],t=e.target.value===m?c.categories:c.projects,t=JIRA.DashboardItem.Projects.Templates.multiSelectOptions({optionsToShow:t,selectedEntries:l.projectsOrCategories});d.html(t)});t&&t[b]||r.projects&&0<r.projects.length&&r.categories&&1<r.categories.length?(t[b]&&t[b].toLowerCase()===m?h("#"+a.prefix+"-projectsOrCategories_proj_cat"):h("#"+a.prefix+"-projectsOrCategories_proj")).trigger("click"):t&&!t[b]&&i.html(function(e,t){for(var r=[],a=0;a<e.length;a++)r.push(new Option(e[a].label,e[a].value,!1,t.projectsOrCategories&&t.projectsOrCategories.includes(e[a].value)));return r}(r.projects,t));var p=h("form",e),t=h(".cancel",p);t&&t.click(g.bind(function(){a.API.closeEdit()},this));p.on("submit",g.bind(function(e){e.preventDefault();var o=h(".buttons > .submit",p);o.attr("disabled",!0);var s=h(e.target),t=function(e,r){var e=e.serializeArray(),a=["viewType",v,A,"cols",w,b],o={projectsOrCategories:[]};g.each(e,function(e){var t=e.name.startsWith(r)?e.name.slice(r.length):e.name;a.includes(t)&&(t===A?o.refresh=e.value:t===v?o[t].push(e.value):t===w&&parseInt(e.value)?o[t]=parseInt(e.value)+"":o[t]=e.value)});return o}(s,a.prefix);t.projectsOrCategories=t.projectsOrCategories.join("|");!function(e){var t={};e[b]&&(t[b]=e[b]);t.projectsOrCategories=e.projectsOrCategories;t.viewType=e.viewType;t.cols=e.cols;t.maxResults=e.maxResults;t.isConfigured=e.isConfigured;t.refresh=e.refresh;return h.ajax({url:"/rest/gadget/1.0/project/validateConfiguration",type:"GET",contentType:"application/json",data:t})}(t).done(function(e){a.startAt=0;a.API.savePreferences(t)}).fail(function(e){if(e&&e.responseText)for(var t=JSON.parse(e.responseText),r=Object.keys(t.errors),a=0;a<r.length;a++)h('[name="'+r[a]+'"]',s).parent().find(h(".error")).text(t.errors[r[a]]).show();o.attr("disabled",!1)})},this))}else T(e)}r.prototype.render=function(e,t){var r=this,a=h(e),o=new s("jira.gadgets.projects",this.API.getGadgetId(),this.API.reportGadgetMetrics);if(0===r.rendered){o.markStart("View");r.rendered+=1}r.API.showLoadingBar();r.API.setTitle("Projects");r.API.initRefresh(t,g.bind(r.render,r,e,t));r._renderView(a,t,o)};r.prototype.renderEdit=function(e,t){var r=g.clone(t),a=this,t=h(e);a.API.showLoadingBar();a.API.setTitle("Projects");e=h.ajax(f()+"/rest/gadget/1.0/projectsAndProjectCategories");h.when(e).done(g.bind(n,a,t,r)).fail(g.partial(T,t,a)).always(g.bind(o,a))};return r});;;try{window.performance.mark('com.atlassian.streams.streams-jira-plugin,com.atlassian.jira.gadgets,com.atlassian.jira.gadgets_batch_file_eval:end');} catch(e){};